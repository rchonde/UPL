{"ast":null,"code":"import { DateWithZone } from './datewithzone';\nimport { iter } from './iter';\nimport { sort } from './dateutil';\nexport function iterSet(iterResult, _rrule, _exrule, _rdate, _exdate, tzid) {\n  var _exdateHash = {};\n  var _accept = iterResult.accept;\n\n  function evalExdate(after, before) {\n    _exrule.forEach(function (rrule) {\n      rrule.between(after, before, true).forEach(function (date) {\n        _exdateHash[Number(date)] = true;\n      });\n    });\n  }\n\n  _exdate.forEach(function (date) {\n    var zonedDate = new DateWithZone(date, tzid).rezonedDate();\n    _exdateHash[Number(zonedDate)] = true;\n  });\n\n  iterResult.accept = function (date) {\n    var dt = Number(date);\n    if (isNaN(dt)) return _accept.call(this, date);\n\n    if (!_exdateHash[dt]) {\n      evalExdate(new Date(dt - 1), new Date(dt + 1));\n\n      if (!_exdateHash[dt]) {\n        _exdateHash[dt] = true;\n        return _accept.call(this, date);\n      }\n    }\n\n    return true;\n  };\n\n  if (iterResult.method === 'between') {\n    evalExdate(iterResult.args.after, iterResult.args.before);\n\n    iterResult.accept = function (date) {\n      var dt = Number(date);\n\n      if (!_exdateHash[dt]) {\n        _exdateHash[dt] = true;\n        return _accept.call(this, date);\n      }\n\n      return true;\n    };\n  }\n\n  for (var i = 0; i < _rdate.length; i++) {\n    var zonedDate = new DateWithZone(_rdate[i], tzid).rezonedDate();\n    if (!iterResult.accept(new Date(zonedDate.getTime()))) break;\n  }\n\n  _rrule.forEach(function (rrule) {\n    iter(iterResult, rrule.options);\n  });\n\n  var res = iterResult._result;\n  sort(res);\n\n  switch (iterResult.method) {\n    case 'all':\n    case 'between':\n      return res;\n\n    case 'before':\n      return res.length && res[res.length - 1] || null;\n\n    case 'after':\n    default:\n      return res.length && res[0] || null;\n  }\n}","map":{"version":3,"names":["DateWithZone","iter","sort","iterSet","iterResult","_rrule","_exrule","_rdate","_exdate","tzid","_exdateHash","_accept","accept","evalExdate","after","before","forEach","rrule","between","date","Number","zonedDate","rezonedDate","dt","isNaN","call","Date","method","args","i","length","getTime","options","res","_result"],"sources":["D:/APPLICATION/UI/UPL/NEW/node_modules/rrule/dist/esm/iterset.js"],"sourcesContent":["import { DateWithZone } from './datewithzone';\nimport { iter } from './iter';\nimport { sort } from './dateutil';\nexport function iterSet(iterResult, _rrule, _exrule, _rdate, _exdate, tzid) {\n    var _exdateHash = {};\n    var _accept = iterResult.accept;\n    function evalExdate(after, before) {\n        _exrule.forEach(function (rrule) {\n            rrule.between(after, before, true).forEach(function (date) {\n                _exdateHash[Number(date)] = true;\n            });\n        });\n    }\n    _exdate.forEach(function (date) {\n        var zonedDate = new DateWithZone(date, tzid).rezonedDate();\n        _exdateHash[Number(zonedDate)] = true;\n    });\n    iterResult.accept = function (date) {\n        var dt = Number(date);\n        if (isNaN(dt))\n            return _accept.call(this, date);\n        if (!_exdateHash[dt]) {\n            evalExdate(new Date(dt - 1), new Date(dt + 1));\n            if (!_exdateHash[dt]) {\n                _exdateHash[dt] = true;\n                return _accept.call(this, date);\n            }\n        }\n        return true;\n    };\n    if (iterResult.method === 'between') {\n        evalExdate(iterResult.args.after, iterResult.args.before);\n        iterResult.accept = function (date) {\n            var dt = Number(date);\n            if (!_exdateHash[dt]) {\n                _exdateHash[dt] = true;\n                return _accept.call(this, date);\n            }\n            return true;\n        };\n    }\n    for (var i = 0; i < _rdate.length; i++) {\n        var zonedDate = new DateWithZone(_rdate[i], tzid).rezonedDate();\n        if (!iterResult.accept(new Date(zonedDate.getTime())))\n            break;\n    }\n    _rrule.forEach(function (rrule) {\n        iter(iterResult, rrule.options);\n    });\n    var res = iterResult._result;\n    sort(res);\n    switch (iterResult.method) {\n        case 'all':\n        case 'between':\n            return res;\n        case 'before':\n            return ((res.length && res[res.length - 1]) || null);\n        case 'after':\n        default:\n            return ((res.length && res[0]) || null);\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}