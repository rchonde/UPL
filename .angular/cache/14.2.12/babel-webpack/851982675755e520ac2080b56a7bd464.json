{"ast":null,"code":"import IterResult from './iterresult';\nimport { clone, cloneDates } from './dateutil';\nimport { isArray } from './helpers';\n\nfunction argsMatch(left, right) {\n  if (Array.isArray(left)) {\n    if (!Array.isArray(right)) return false;\n    if (left.length !== right.length) return false;\n    return left.every(function (date, i) {\n      return date.getTime() === right[i].getTime();\n    });\n  }\n\n  if (left instanceof Date) {\n    return right instanceof Date && left.getTime() === right.getTime();\n  }\n\n  return left === right;\n}\n\nvar Cache =\n/** @class */\nfunction () {\n  function Cache() {\n    this.all = false;\n    this.before = [];\n    this.after = [];\n    this.between = [];\n  }\n  /**\n   * @param {String} what - all/before/after/between\n   * @param {Array,Date} value - an array of dates, one date, or null\n   * @param {Object?} args - _iter arguments\n   */\n\n\n  Cache.prototype._cacheAdd = function (what, value, args) {\n    if (value) {\n      value = value instanceof Date ? clone(value) : cloneDates(value);\n    }\n\n    if (what === 'all') {\n      this.all = value;\n    } else {\n      args._value = value;\n      this[what].push(args);\n    }\n  };\n  /**\n   * @return false - not in the cache\n   * @return null  - cached, but zero occurrences (before/after)\n   * @return Date  - cached (before/after)\n   * @return []    - cached, but zero occurrences (all/between)\n   * @return [Date1, DateN] - cached (all/between)\n   */\n\n\n  Cache.prototype._cacheGet = function (what, args) {\n    var cached = false;\n    var argsKeys = args ? Object.keys(args) : [];\n\n    var findCacheDiff = function (item) {\n      for (var i = 0; i < argsKeys.length; i++) {\n        var key = argsKeys[i];\n\n        if (!argsMatch(args[key], item[key])) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    var cachedObject = this[what];\n\n    if (what === 'all') {\n      cached = this.all;\n    } else if (isArray(cachedObject)) {\n      // Let's see whether we've already called the\n      // 'what' method with the same 'args'\n      for (var i = 0; i < cachedObject.length; i++) {\n        var item = cachedObject[i];\n        if (argsKeys.length && findCacheDiff(item)) continue;\n        cached = item._value;\n        break;\n      }\n    }\n\n    if (!cached && this.all) {\n      // Not in the cache, but we already know all the occurrences,\n      // so we can find the correct dates from the cached ones.\n      var iterResult = new IterResult(what, args);\n\n      for (var i = 0; i < this.all.length; i++) {\n        if (!iterResult.accept(this.all[i])) break;\n      }\n\n      cached = iterResult.getValue();\n\n      this._cacheAdd(what, cached, args);\n    }\n\n    return isArray(cached) ? cloneDates(cached) : cached instanceof Date ? clone(cached) : cached;\n  };\n\n  return Cache;\n}();\n\nexport { Cache };","map":{"version":3,"names":["IterResult","clone","cloneDates","isArray","argsMatch","left","right","Array","length","every","date","i","getTime","Date","Cache","all","before","after","between","prototype","_cacheAdd","what","value","args","_value","push","_cacheGet","cached","argsKeys","Object","keys","findCacheDiff","item","key","cachedObject","iterResult","accept","getValue"],"sources":["D:/APPLICATION/UI/UPL/NEW/node_modules/rrule/dist/esm/cache.js"],"sourcesContent":["import IterResult from './iterresult';\nimport { clone, cloneDates } from './dateutil';\nimport { isArray } from './helpers';\nfunction argsMatch(left, right) {\n    if (Array.isArray(left)) {\n        if (!Array.isArray(right))\n            return false;\n        if (left.length !== right.length)\n            return false;\n        return left.every(function (date, i) { return date.getTime() === right[i].getTime(); });\n    }\n    if (left instanceof Date) {\n        return right instanceof Date && left.getTime() === right.getTime();\n    }\n    return left === right;\n}\nvar Cache = /** @class */ (function () {\n    function Cache() {\n        this.all = false;\n        this.before = [];\n        this.after = [];\n        this.between = [];\n    }\n    /**\n     * @param {String} what - all/before/after/between\n     * @param {Array,Date} value - an array of dates, one date, or null\n     * @param {Object?} args - _iter arguments\n     */\n    Cache.prototype._cacheAdd = function (what, value, args) {\n        if (value) {\n            value = value instanceof Date ? clone(value) : cloneDates(value);\n        }\n        if (what === 'all') {\n            this.all = value;\n        }\n        else {\n            args._value = value;\n            this[what].push(args);\n        }\n    };\n    /**\n     * @return false - not in the cache\n     * @return null  - cached, but zero occurrences (before/after)\n     * @return Date  - cached (before/after)\n     * @return []    - cached, but zero occurrences (all/between)\n     * @return [Date1, DateN] - cached (all/between)\n     */\n    Cache.prototype._cacheGet = function (what, args) {\n        var cached = false;\n        var argsKeys = args ? Object.keys(args) : [];\n        var findCacheDiff = function (item) {\n            for (var i = 0; i < argsKeys.length; i++) {\n                var key = argsKeys[i];\n                if (!argsMatch(args[key], item[key])) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        var cachedObject = this[what];\n        if (what === 'all') {\n            cached = this.all;\n        }\n        else if (isArray(cachedObject)) {\n            // Let's see whether we've already called the\n            // 'what' method with the same 'args'\n            for (var i = 0; i < cachedObject.length; i++) {\n                var item = cachedObject[i];\n                if (argsKeys.length && findCacheDiff(item))\n                    continue;\n                cached = item._value;\n                break;\n            }\n        }\n        if (!cached && this.all) {\n            // Not in the cache, but we already know all the occurrences,\n            // so we can find the correct dates from the cached ones.\n            var iterResult = new IterResult(what, args);\n            for (var i = 0; i < this.all.length; i++) {\n                if (!iterResult.accept(this.all[i]))\n                    break;\n            }\n            cached = iterResult.getValue();\n            this._cacheAdd(what, cached, args);\n        }\n        return isArray(cached)\n            ? cloneDates(cached)\n            : cached instanceof Date\n                ? clone(cached)\n                : cached;\n    };\n    return Cache;\n}());\nexport { Cache };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}