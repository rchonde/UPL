{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/html_editor/ui.html_editor.js)\r\n * Version: 22.2.4\r\n * Build date: Thu Jan 19 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../core/renderer\";\nimport { extend } from \"../../core/utils/extend\";\nimport { isDefined, isFunction } from \"../../core/utils/type\";\nimport { getPublicElement } from \"../../core/element\";\nimport { executeAsync, noop, ensureDefined, deferRender } from \"../../core/utils/common\";\nimport registerComponent from \"../../core/component_registrator\";\nimport { EmptyTemplate } from \"../../core/templates/empty_template\";\nimport Editor from \"../editor/editor\";\nimport Errors from \"../widget/ui.errors\";\nimport Callbacks from \"../../core/utils/callbacks\";\nimport { Deferred } from \"../../core/utils/deferred\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport { addNamespace } from \"../../events/utils/index\";\nimport { Event as dxEvent } from \"../../events/index\";\nimport scrollEvents from \"../../events/gesture/emitter.gesture.scroll\";\nimport { prepareScrollData } from \"../text_box/utils.scroll\";\nimport pointerEvents from \"../../events/pointer\";\nimport devices from \"../../core/devices\";\nimport QuillRegistrator from \"./quill_registrator\";\nimport \"./converters/delta\";\nimport ConverterController from \"./converterController\";\nimport getWordMatcher from \"./matchers/wordLists\";\nimport FormDialog from \"./ui/formDialog\";\nvar HTML_EDITOR_CLASS = \"dx-htmleditor\";\nvar QUILL_CONTAINER_CLASS = \"dx-quill-container\";\nvar QUILL_CLIPBOARD_CLASS = \"ql-clipboard\";\nvar HTML_EDITOR_SUBMIT_ELEMENT_CLASS = \"dx-htmleditor-submit-element\";\nvar HTML_EDITOR_CONTENT_CLASS = \"dx-htmleditor-content\";\nvar MARKDOWN_VALUE_TYPE = \"markdown\";\nvar ANONYMOUS_TEMPLATE_NAME = \"htmlContent\";\nvar isIos = \"ios\" === devices.current().platform;\nvar HtmlEditor = Editor.inherit({\n  _getDefaultOptions: function () {\n    return extend(this.callBase(), {\n      focusStateEnabled: true,\n      valueType: \"html\",\n      placeholder: \"\",\n      toolbar: null,\n      variables: null,\n      mediaResizing: null,\n      tableResizing: null,\n      mentions: null,\n      customizeModules: null,\n      tableContextMenu: null,\n      allowSoftLineBreak: false,\n      formDialogOptions: null,\n      imageUpload: null,\n      stylingMode: \"outlined\"\n    });\n  },\n  _init: function () {\n    this.callBase();\n    this._cleanCallback = Callbacks();\n    this._contentInitializedCallback = Callbacks();\n  },\n  _getAnonymousTemplateName: function () {\n    return ANONYMOUS_TEMPLATE_NAME;\n  },\n  _initTemplates: function () {\n    this._templateManager.addDefaultTemplates({\n      [ANONYMOUS_TEMPLATE_NAME]: new EmptyTemplate()\n    });\n\n    this.callBase();\n  },\n  _focusTarget: function () {\n    return this._getContent();\n  },\n  _getContent: function () {\n    return this.$element().find(\".\".concat(HTML_EDITOR_CONTENT_CLASS));\n  },\n  _focusInHandler: function (_ref) {\n    var {\n      relatedTarget: relatedTarget\n    } = _ref;\n\n    if (this._shouldSkipFocusEvent(relatedTarget)) {\n      return;\n    }\n\n    this._toggleFocusClass(true, this.$element());\n\n    this.callBase.apply(this, arguments);\n  },\n  _focusOutHandler: function (_ref2) {\n    var {\n      relatedTarget: relatedTarget\n    } = _ref2;\n\n    if (this._shouldSkipFocusEvent(relatedTarget)) {\n      return;\n    }\n\n    this._toggleFocusClass(false, this.$element());\n\n    this.callBase.apply(this, arguments);\n  },\n  _shouldSkipFocusEvent: function (relatedTarget) {\n    return $(relatedTarget).hasClass(QUILL_CLIPBOARD_CLASS);\n  },\n  _initMarkup: function () {\n    this._$htmlContainer = $(\"<div>\").addClass(QUILL_CONTAINER_CLASS);\n    this.$element().attr(\"role\", \"application\").addClass(HTML_EDITOR_CLASS).wrapInner(this._$htmlContainer);\n\n    this._renderStylingMode();\n\n    var template = this._getTemplate(ANONYMOUS_TEMPLATE_NAME);\n\n    this._$templateResult = template && template.render({\n      container: getPublicElement(this._$htmlContainer),\n      noModel: true,\n      transclude: true\n    });\n\n    this._renderSubmitElement();\n\n    this.callBase();\n\n    this._updateContainerMarkup();\n  },\n  _renderSubmitElement: function () {\n    this._$submitElement = $(\"<textarea>\").addClass(HTML_EDITOR_SUBMIT_ELEMENT_CLASS).attr(\"hidden\", true).appendTo(this.$element());\n\n    this._setSubmitValue(this.option(\"value\"));\n  },\n  _setSubmitValue: function (value) {\n    this._getSubmitElement().val(value);\n  },\n  _getSubmitElement: function () {\n    return this._$submitElement;\n  },\n  _removeXSSVulnerableHtml: function (value) {\n    var $frame = $(\"<iframe>\").css(\"display\", \"none\").attr({\n      id: \"xss-frame\",\n      sandbox: \"allow-same-origin\"\n    }).appendTo(\"body\");\n    var frame = $frame.get(0);\n    var frameWindow = frame.contentWindow;\n    var frameDocument = frameWindow.document;\n    var frameDocumentBody = frameDocument.body;\n    frameDocumentBody.innerHTML = value;\n\n    var removeInlineHandlers = element => {\n      if (element.attributes) {\n        for (var i = 0; i < element.attributes.length; i++) {\n          var name = element.attributes[i].name;\n\n          if (name.startsWith(\"on\")) {\n            element.removeAttribute(name);\n          }\n        }\n      }\n\n      if (element.childNodes) {\n        for (var _i = 0; _i < element.childNodes.length; _i++) {\n          removeInlineHandlers(element.childNodes[_i]);\n        }\n      }\n    };\n\n    removeInlineHandlers(frameDocumentBody);\n    $(frameDocumentBody).find(\"script\").remove();\n    var sanitizedHtml = frameDocumentBody.innerHTML;\n    $frame.remove();\n    return sanitizedHtml;\n  },\n  _updateContainerMarkup: function () {\n    var markup = this.option(\"value\");\n\n    if (this._isMarkdownValue()) {\n      this._prepareMarkdownConverter();\n\n      markup = this._markdownConverter.toHtml(markup);\n    }\n\n    if (markup) {\n      var sanitizedMarkup = this._removeXSSVulnerableHtml(markup);\n\n      this._$htmlContainer.html(sanitizedMarkup);\n    }\n  },\n  _prepareMarkdownConverter: function () {\n    var MarkdownConverter = ConverterController.getConverter(\"markdown\");\n\n    if (MarkdownConverter) {\n      this._markdownConverter = new MarkdownConverter();\n    } else {\n      throw Errors.Error(\"E1051\", \"markdown\");\n    }\n  },\n  _render: function () {\n    this._prepareConverters();\n\n    this.callBase();\n  },\n  _prepareQuillRegistrator: function () {\n    if (!this._quillRegistrator) {\n      this._quillRegistrator = new QuillRegistrator();\n    }\n  },\n  _getRegistrator: function () {\n    this._prepareQuillRegistrator();\n\n    return this._quillRegistrator;\n  },\n  _prepareConverters: function () {\n    if (!this._deltaConverter) {\n      var DeltaConverter = ConverterController.getConverter(\"delta\");\n\n      if (DeltaConverter) {\n        this._deltaConverter = new DeltaConverter();\n      }\n    }\n\n    if (this.option(\"valueType\") === MARKDOWN_VALUE_TYPE && !this._markdownConverter) {\n      this._prepareMarkdownConverter();\n    }\n  },\n  _renderContentImpl: function () {\n    this._contentRenderedDeferred = new Deferred();\n\n    var renderContentPromise = this._contentRenderedDeferred.promise();\n\n    this.callBase();\n\n    this._renderHtmlEditor();\n\n    this._renderFormDialog();\n\n    this._addKeyPressHandler();\n\n    return renderContentPromise;\n  },\n  _pointerMoveHandler: function (e) {\n    if (isIos) {\n      e.stopPropagation();\n    }\n  },\n  _attachFocusEvents: function () {\n    deferRender(this.callBase.bind(this));\n  },\n  _addKeyPressHandler: function () {\n    var keyDownEvent = addNamespace(\"keydown\", \"\".concat(this.NAME, \"TextChange\"));\n    eventsEngine.on(this._$htmlContainer, keyDownEvent, this._keyDownHandler.bind(this));\n  },\n  _keyDownHandler: function (e) {\n    this._saveValueChangeEvent(e);\n  },\n  _renderHtmlEditor: function () {\n    var customizeModules = this.option(\"customizeModules\");\n\n    var modulesConfig = this._getModulesConfig();\n\n    if (isFunction(customizeModules)) {\n      customizeModules(modulesConfig);\n    }\n\n    this._quillInstance = this._getRegistrator().createEditor(this._$htmlContainer[0], {\n      placeholder: this.option(\"placeholder\"),\n      readOnly: this.option(\"readOnly\") || this.option(\"disabled\"),\n      modules: modulesConfig,\n      theme: \"basic\"\n    });\n\n    this._deltaConverter.setQuillInstance(this._quillInstance);\n\n    this._textChangeHandlerWithContext = this._textChangeHandler.bind(this);\n\n    this._quillInstance.on(\"text-change\", this._textChangeHandlerWithContext);\n\n    this._renderScrollHandler();\n\n    if (this._hasTranscludedContent()) {\n      this._updateContentTask = executeAsync(() => {\n        this._applyTranscludedContent();\n      });\n    } else {\n      this._finalizeContentRendering();\n    }\n  },\n  _renderScrollHandler: function () {\n    var $scrollContainer = this._getContent();\n\n    var initScrollData = prepareScrollData($scrollContainer);\n    eventsEngine.on($scrollContainer, addNamespace(scrollEvents.init, this.NAME), initScrollData, noop);\n    eventsEngine.on($scrollContainer, addNamespace(pointerEvents.move, this.NAME), this._pointerMoveHandler.bind(this));\n  },\n  _applyTranscludedContent: function () {\n    var valueOption = this.option(\"value\");\n\n    if (!isDefined(valueOption)) {\n      var html = this._deltaConverter.toHtml();\n\n      var newDelta = this._quillInstance.clipboard.convert({\n        html: html\n      });\n\n      if (newDelta.ops.length) {\n        this._quillInstance.setContents(newDelta);\n\n        return;\n      }\n    }\n\n    this._finalizeContentRendering();\n  },\n  _hasTranscludedContent: function () {\n    return this._$templateResult && this._$templateResult.length;\n  },\n  _getModulesConfig: function () {\n    var quill = this._getRegistrator().getQuill();\n\n    var wordListMatcher = getWordMatcher(quill);\n    var modulesConfig = extend({}, {\n      table: true,\n      toolbar: this._getModuleConfigByOption(\"toolbar\"),\n      variables: this._getModuleConfigByOption(\"variables\"),\n      resizing: this._getModuleConfigByOption(\"mediaResizing\"),\n      tableResizing: this._getModuleConfigByOption(\"tableResizing\"),\n      tableContextMenu: this._getModuleConfigByOption(\"tableContextMenu\"),\n      imageUpload: this._getModuleConfigByOption(\"imageUpload\"),\n      imageCursor: this._getBaseModuleConfig(),\n      mentions: this._getModuleConfigByOption(\"mentions\"),\n      uploader: {\n        onDrop: e => this._saveValueChangeEvent(dxEvent(e)),\n        imageBlot: \"extendedImage\"\n      },\n      keyboard: {\n        onKeydown: e => this._saveValueChangeEvent(dxEvent(e))\n      },\n      clipboard: {\n        onPaste: e => this._saveValueChangeEvent(dxEvent(e)),\n        onCut: e => this._saveValueChangeEvent(dxEvent(e)),\n        matchers: [[\"p.MsoListParagraphCxSpFirst\", wordListMatcher], [\"p.MsoListParagraphCxSpMiddle\", wordListMatcher], [\"p.MsoListParagraphCxSpLast\", wordListMatcher]]\n      },\n      multiline: Boolean(this.option(\"allowSoftLineBreak\"))\n    }, this._getCustomModules());\n    return modulesConfig;\n  },\n  _getModuleConfigByOption: function (userOptionName) {\n    var optionValue = this.option(userOptionName);\n    var config = {};\n\n    if (!isDefined(optionValue)) {\n      return;\n    }\n\n    if (Array.isArray(optionValue)) {\n      config[userOptionName] = optionValue;\n    } else {\n      config = optionValue;\n    }\n\n    return extend(this._getBaseModuleConfig(), config);\n  },\n  _getBaseModuleConfig: function () {\n    return {\n      editorInstance: this\n    };\n  },\n  _getCustomModules: function () {\n    var modules = {};\n\n    var moduleNames = this._getRegistrator().getRegisteredModuleNames();\n\n    moduleNames.forEach(modulePath => {\n      modules[modulePath] = this._getBaseModuleConfig();\n    });\n    return modules;\n  },\n  _textChangeHandler: function (newDelta, oldDelta, source) {\n    var htmlMarkup = this._deltaConverter.toHtml();\n\n    var convertedValue = this._isMarkdownValue() ? this._updateValueByType(MARKDOWN_VALUE_TYPE, htmlMarkup) : htmlMarkup;\n    var currentValue = this.option(\"value\");\n\n    if (currentValue !== convertedValue && !this._isNullValueConverted(currentValue, convertedValue)) {\n      this._isEditorUpdating = true;\n      this.option(\"value\", convertedValue);\n    }\n\n    this._finalizeContentRendering();\n  },\n  _isNullValueConverted: function (currentValue, convertedValue) {\n    return null === currentValue && \"\" === convertedValue;\n  },\n  _finalizeContentRendering: function () {\n    if (this._contentRenderedDeferred) {\n      this.clearHistory();\n\n      this._contentInitializedCallback.fire();\n\n      this._contentRenderedDeferred.resolve();\n\n      this._contentRenderedDeferred = void 0;\n    }\n  },\n  _updateValueByType: function (valueType, value) {\n    var converter = this._markdownConverter;\n\n    if (!isDefined(converter)) {\n      return;\n    }\n\n    var currentValue = ensureDefined(value, this.option(\"value\"));\n    return valueType === MARKDOWN_VALUE_TYPE ? converter.toMarkdown(currentValue) : converter.toHtml(currentValue);\n  },\n  _isMarkdownValue: function () {\n    return this.option(\"valueType\") === MARKDOWN_VALUE_TYPE;\n  },\n  _resetEnabledState: function () {\n    if (this._quillInstance) {\n      var isEnabled = !(this.option(\"readOnly\") || this.option(\"disabled\"));\n\n      this._quillInstance.enable(isEnabled);\n    }\n  },\n  _renderFormDialog: function () {\n    var userOptions = extend(true, {\n      width: \"auto\",\n      height: \"auto\",\n      hideOnOutsideClick: true\n    }, this.option(\"formDialogOptions\"));\n    this._formDialog = new FormDialog(this, userOptions);\n  },\n  _getStylingModePrefix: function () {\n    return \"dx-htmleditor-\";\n  },\n  _getQuillContainer: function () {\n    return this._$htmlContainer;\n  },\n\n  _prepareModuleOptions(args) {\n    var _args$fullName;\n\n    var optionData = null === (_args$fullName = args.fullName) || void 0 === _args$fullName ? void 0 : _args$fullName.split(\".\");\n    var value = args.value;\n    var optionName = optionData.length >= 2 ? optionData[1] : args.name;\n\n    if (3 === optionData.length) {\n      value = {\n        [optionData[2]]: value\n      };\n    }\n\n    return [optionName, value];\n  },\n\n  _moduleOptionChanged: function (moduleName, args) {\n    var _this$_quillInstance;\n\n    var moduleInstance = null === (_this$_quillInstance = this._quillInstance) || void 0 === _this$_quillInstance ? void 0 : _this$_quillInstance.getModule(moduleName);\n    var shouldPassOptionsToModule = Boolean(moduleInstance);\n\n    if (shouldPassOptionsToModule) {\n      moduleInstance.option(...this._prepareModuleOptions(args));\n    } else {\n      this._invalidate();\n    }\n  },\n  _optionChanged: function (args) {\n    switch (args.name) {\n      case \"value\":\n        if (this._quillInstance) {\n          if (this._isEditorUpdating) {\n            this._isEditorUpdating = false;\n          } else {\n            var updatedValue = this._isMarkdownValue() ? this._updateValueByType(\"HTML\", args.value) : args.value;\n\n            this._updateHtmlContent(updatedValue);\n          }\n        } else {\n          this._$htmlContainer.html(args.value);\n        }\n\n        this._setSubmitValue(args.value);\n\n        this.callBase(args);\n        break;\n\n      case \"placeholder\":\n      case \"variables\":\n      case \"toolbar\":\n      case \"mentions\":\n      case \"customizeModules\":\n      case \"allowSoftLineBreak\":\n        this._invalidate();\n\n        break;\n\n      case \"tableResizing\":\n        this._moduleOptionChanged(\"tableResizing\", args);\n\n        break;\n\n      case \"valueType\":\n        this._prepareConverters();\n\n        var newValue = this._updateValueByType(args.value);\n\n        if (\"html\" === args.value && this._quillInstance) {\n          this._updateHtmlContent(newValue);\n        } else {\n          this.option(\"value\", newValue);\n        }\n\n        break;\n\n      case \"stylingMode\":\n        this._renderStylingMode();\n\n        break;\n\n      case \"readOnly\":\n      case \"disabled\":\n        this.callBase(args);\n\n        this._resetEnabledState();\n\n        break;\n\n      case \"formDialogOptions\":\n        this._renderFormDialog();\n\n        break;\n\n      case \"tableContextMenu\":\n        this._moduleOptionChanged(\"tableContextMenu\", args);\n\n        break;\n\n      case \"mediaResizing\":\n        if (!args.previousValue || !args.value) {\n          this._invalidate();\n        } else {\n          this._quillInstance.getModule(\"resizing\").option(args.name, args.value);\n        }\n\n        break;\n\n      case \"width\":\n        this.callBase(args);\n\n        this._repaintToolbar();\n\n        break;\n\n      case \"imageUpload\":\n        this._moduleOptionChanged(\"imageUpload\", args);\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _repaintToolbar: function () {\n    var toolbar = this._quillInstance.getModule(\"toolbar\");\n\n    toolbar && toolbar.repaint();\n  },\n  _updateHtmlContent: function (html) {\n    var newDelta = this._quillInstance.clipboard.convert({\n      html: html\n    });\n\n    this._quillInstance.setContents(newDelta);\n  },\n  _clean: function () {\n    if (this._quillInstance) {\n      eventsEngine.off(this._getContent(), \".\".concat(this.NAME));\n\n      this._quillInstance.off(\"text-change\", this._textChangeHandlerWithContext);\n\n      this._cleanCallback.fire();\n    }\n\n    this._abortUpdateContentTask();\n\n    this._cleanCallback.empty();\n\n    this._contentInitializedCallback.empty();\n\n    this.callBase();\n  },\n  _abortUpdateContentTask: function () {\n    if (this._updateContentTask) {\n      this._updateContentTask.abort();\n\n      this._updateContentTask = void 0;\n    }\n  },\n\n  _applyQuillMethod(methodName, args) {\n    if (this._quillInstance) {\n      return this._quillInstance[methodName].apply(this._quillInstance, args);\n    }\n  },\n\n  _applyQuillHistoryMethod(methodName) {\n    if (this._quillInstance && this._quillInstance.history) {\n      this._quillInstance.history[methodName]();\n    }\n  },\n\n  addCleanCallback(callback) {\n    this._cleanCallback.add(callback);\n  },\n\n  addContentInitializedCallback(callback) {\n    this._contentInitializedCallback.add(callback);\n  },\n\n  register: function (components) {\n    this._getRegistrator().registerModules(components);\n\n    if (this._quillInstance) {\n      this.repaint();\n    }\n  },\n  get: function (modulePath) {\n    return this._getRegistrator().getQuill().import(modulePath);\n  },\n  getModule: function (moduleName) {\n    return this._applyQuillMethod(\"getModule\", arguments);\n  },\n  getQuillInstance: function () {\n    return this._quillInstance;\n  },\n  getSelection: function (focus) {\n    return this._applyQuillMethod(\"getSelection\", arguments);\n  },\n  setSelection: function (index, length) {\n    this._applyQuillMethod(\"setSelection\", arguments);\n  },\n  getText: function (index, length) {\n    return this._applyQuillMethod(\"getText\", arguments);\n  },\n  format: function (formatName, formatValue) {\n    this._applyQuillMethod(\"format\", arguments);\n  },\n  formatText: function (index, length, formatName, formatValue) {\n    this._applyQuillMethod(\"formatText\", arguments);\n  },\n  formatLine: function (index, length, formatName, formatValue) {\n    this._applyQuillMethod(\"formatLine\", arguments);\n  },\n  getFormat: function (index, length) {\n    return this._applyQuillMethod(\"getFormat\", arguments);\n  },\n  removeFormat: function (index, length) {\n    return this._applyQuillMethod(\"removeFormat\", arguments);\n  },\n  clearHistory: function () {\n    this._applyQuillHistoryMethod(\"clear\");\n  },\n  undo: function () {\n    this._applyQuillHistoryMethod(\"undo\");\n  },\n  redo: function () {\n    this._applyQuillHistoryMethod(\"redo\");\n  },\n  getLength: function () {\n    return this._applyQuillMethod(\"getLength\");\n  },\n  getBounds: function (index, length) {\n    return this._applyQuillMethod(\"getBounds\", arguments);\n  },\n  delete: function (index, length) {\n    this._applyQuillMethod(\"deleteText\", arguments);\n  },\n  insertText: function (index, text, formats) {\n    this._applyQuillMethod(\"insertText\", arguments);\n  },\n  insertEmbed: function (index, type, config) {\n    this._applyQuillMethod(\"insertEmbed\", arguments);\n  },\n  showFormDialog: function (formConfig) {\n    return this._formDialog.show(formConfig);\n  },\n  formDialogOption: function (optionName, optionValue) {\n    return this._formDialog.popupOption.apply(this._formDialog, arguments);\n  },\n  focus: function () {\n    this.callBase();\n\n    this._applyQuillMethod(\"focus\");\n  },\n  blur: function () {\n    this._applyQuillMethod(\"blur\");\n  }\n});\nregisterComponent(\"dxHtmlEditor\", HtmlEditor);\nexport default HtmlEditor;","map":{"version":3,"names":["$","extend","isDefined","isFunction","getPublicElement","executeAsync","noop","ensureDefined","deferRender","registerComponent","EmptyTemplate","Editor","Errors","Callbacks","Deferred","eventsEngine","addNamespace","Event","dxEvent","scrollEvents","prepareScrollData","pointerEvents","devices","QuillRegistrator","ConverterController","getWordMatcher","FormDialog","HTML_EDITOR_CLASS","QUILL_CONTAINER_CLASS","QUILL_CLIPBOARD_CLASS","HTML_EDITOR_SUBMIT_ELEMENT_CLASS","HTML_EDITOR_CONTENT_CLASS","MARKDOWN_VALUE_TYPE","ANONYMOUS_TEMPLATE_NAME","isIos","current","platform","HtmlEditor","inherit","_getDefaultOptions","callBase","focusStateEnabled","valueType","placeholder","toolbar","variables","mediaResizing","tableResizing","mentions","customizeModules","tableContextMenu","allowSoftLineBreak","formDialogOptions","imageUpload","stylingMode","_init","_cleanCallback","_contentInitializedCallback","_getAnonymousTemplateName","_initTemplates","_templateManager","addDefaultTemplates","_focusTarget","_getContent","$element","find","concat","_focusInHandler","_ref","relatedTarget","_shouldSkipFocusEvent","_toggleFocusClass","apply","arguments","_focusOutHandler","_ref2","hasClass","_initMarkup","_$htmlContainer","addClass","attr","wrapInner","_renderStylingMode","template","_getTemplate","_$templateResult","render","container","noModel","transclude","_renderSubmitElement","_updateContainerMarkup","_$submitElement","appendTo","_setSubmitValue","option","value","_getSubmitElement","val","_removeXSSVulnerableHtml","$frame","css","id","sandbox","frame","get","frameWindow","contentWindow","frameDocument","document","frameDocumentBody","body","innerHTML","removeInlineHandlers","element","attributes","i","length","name","startsWith","removeAttribute","childNodes","_i","remove","sanitizedHtml","markup","_isMarkdownValue","_prepareMarkdownConverter","_markdownConverter","toHtml","sanitizedMarkup","html","MarkdownConverter","getConverter","Error","_render","_prepareConverters","_prepareQuillRegistrator","_quillRegistrator","_getRegistrator","_deltaConverter","DeltaConverter","_renderContentImpl","_contentRenderedDeferred","renderContentPromise","promise","_renderHtmlEditor","_renderFormDialog","_addKeyPressHandler","_pointerMoveHandler","e","stopPropagation","_attachFocusEvents","bind","keyDownEvent","NAME","on","_keyDownHandler","_saveValueChangeEvent","modulesConfig","_getModulesConfig","_quillInstance","createEditor","readOnly","modules","theme","setQuillInstance","_textChangeHandlerWithContext","_textChangeHandler","_renderScrollHandler","_hasTranscludedContent","_updateContentTask","_applyTranscludedContent","_finalizeContentRendering","$scrollContainer","initScrollData","init","move","valueOption","newDelta","clipboard","convert","ops","setContents","quill","getQuill","wordListMatcher","table","_getModuleConfigByOption","resizing","imageCursor","_getBaseModuleConfig","uploader","onDrop","imageBlot","keyboard","onKeydown","onPaste","onCut","matchers","multiline","Boolean","_getCustomModules","userOptionName","optionValue","config","Array","isArray","editorInstance","moduleNames","getRegisteredModuleNames","forEach","modulePath","oldDelta","source","htmlMarkup","convertedValue","_updateValueByType","currentValue","_isNullValueConverted","_isEditorUpdating","clearHistory","fire","resolve","converter","toMarkdown","_resetEnabledState","isEnabled","enable","userOptions","width","height","hideOnOutsideClick","_formDialog","_getStylingModePrefix","_getQuillContainer","_prepareModuleOptions","args","_args$fullName","optionData","fullName","split","optionName","_moduleOptionChanged","moduleName","_this$_quillInstance","moduleInstance","getModule","shouldPassOptionsToModule","_invalidate","_optionChanged","updatedValue","_updateHtmlContent","newValue","previousValue","_repaintToolbar","repaint","_clean","off","_abortUpdateContentTask","empty","abort","_applyQuillMethod","methodName","_applyQuillHistoryMethod","history","addCleanCallback","callback","add","addContentInitializedCallback","register","components","registerModules","import","getQuillInstance","getSelection","focus","setSelection","index","getText","format","formatName","formatValue","formatText","formatLine","getFormat","removeFormat","undo","redo","getLength","getBounds","delete","insertText","text","formats","insertEmbed","type","showFormDialog","formConfig","show","formDialogOption","popupOption","blur"],"sources":["D:/APPLICATION/UI/UPL/NEW/node_modules/devextreme/esm/ui/html_editor/ui.html_editor.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/html_editor/ui.html_editor.js)\r\n * Version: 22.2.4\r\n * Build date: Thu Jan 19 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../../core/renderer\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    isDefined,\r\n    isFunction\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    getPublicElement\r\n} from \"../../core/element\";\r\nimport {\r\n    executeAsync,\r\n    noop,\r\n    ensureDefined,\r\n    deferRender\r\n} from \"../../core/utils/common\";\r\nimport registerComponent from \"../../core/component_registrator\";\r\nimport {\r\n    EmptyTemplate\r\n} from \"../../core/templates/empty_template\";\r\nimport Editor from \"../editor/editor\";\r\nimport Errors from \"../widget/ui.errors\";\r\nimport Callbacks from \"../../core/utils/callbacks\";\r\nimport {\r\n    Deferred\r\n} from \"../../core/utils/deferred\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport {\r\n    addNamespace\r\n} from \"../../events/utils/index\";\r\nimport {\r\n    Event as dxEvent\r\n} from \"../../events/index\";\r\nimport scrollEvents from \"../../events/gesture/emitter.gesture.scroll\";\r\nimport {\r\n    prepareScrollData\r\n} from \"../text_box/utils.scroll\";\r\nimport pointerEvents from \"../../events/pointer\";\r\nimport devices from \"../../core/devices\";\r\nimport QuillRegistrator from \"./quill_registrator\";\r\nimport \"./converters/delta\";\r\nimport ConverterController from \"./converterController\";\r\nimport getWordMatcher from \"./matchers/wordLists\";\r\nimport FormDialog from \"./ui/formDialog\";\r\nvar HTML_EDITOR_CLASS = \"dx-htmleditor\";\r\nvar QUILL_CONTAINER_CLASS = \"dx-quill-container\";\r\nvar QUILL_CLIPBOARD_CLASS = \"ql-clipboard\";\r\nvar HTML_EDITOR_SUBMIT_ELEMENT_CLASS = \"dx-htmleditor-submit-element\";\r\nvar HTML_EDITOR_CONTENT_CLASS = \"dx-htmleditor-content\";\r\nvar MARKDOWN_VALUE_TYPE = \"markdown\";\r\nvar ANONYMOUS_TEMPLATE_NAME = \"htmlContent\";\r\nvar isIos = \"ios\" === devices.current().platform;\r\nvar HtmlEditor = Editor.inherit({\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            focusStateEnabled: true,\r\n            valueType: \"html\",\r\n            placeholder: \"\",\r\n            toolbar: null,\r\n            variables: null,\r\n            mediaResizing: null,\r\n            tableResizing: null,\r\n            mentions: null,\r\n            customizeModules: null,\r\n            tableContextMenu: null,\r\n            allowSoftLineBreak: false,\r\n            formDialogOptions: null,\r\n            imageUpload: null,\r\n            stylingMode: \"outlined\"\r\n        })\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._cleanCallback = Callbacks();\r\n        this._contentInitializedCallback = Callbacks()\r\n    },\r\n    _getAnonymousTemplateName: function() {\r\n        return ANONYMOUS_TEMPLATE_NAME\r\n    },\r\n    _initTemplates: function() {\r\n        this._templateManager.addDefaultTemplates({\r\n            [ANONYMOUS_TEMPLATE_NAME]: new EmptyTemplate\r\n        });\r\n        this.callBase()\r\n    },\r\n    _focusTarget: function() {\r\n        return this._getContent()\r\n    },\r\n    _getContent: function() {\r\n        return this.$element().find(\".\".concat(HTML_EDITOR_CONTENT_CLASS))\r\n    },\r\n    _focusInHandler: function(_ref) {\r\n        var {\r\n            relatedTarget: relatedTarget\r\n        } = _ref;\r\n        if (this._shouldSkipFocusEvent(relatedTarget)) {\r\n            return\r\n        }\r\n        this._toggleFocusClass(true, this.$element());\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _focusOutHandler: function(_ref2) {\r\n        var {\r\n            relatedTarget: relatedTarget\r\n        } = _ref2;\r\n        if (this._shouldSkipFocusEvent(relatedTarget)) {\r\n            return\r\n        }\r\n        this._toggleFocusClass(false, this.$element());\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _shouldSkipFocusEvent: function(relatedTarget) {\r\n        return $(relatedTarget).hasClass(QUILL_CLIPBOARD_CLASS)\r\n    },\r\n    _initMarkup: function() {\r\n        this._$htmlContainer = $(\"<div>\").addClass(QUILL_CONTAINER_CLASS);\r\n        this.$element().attr(\"role\", \"application\").addClass(HTML_EDITOR_CLASS).wrapInner(this._$htmlContainer);\r\n        this._renderStylingMode();\r\n        var template = this._getTemplate(ANONYMOUS_TEMPLATE_NAME);\r\n        this._$templateResult = template && template.render({\r\n            container: getPublicElement(this._$htmlContainer),\r\n            noModel: true,\r\n            transclude: true\r\n        });\r\n        this._renderSubmitElement();\r\n        this.callBase();\r\n        this._updateContainerMarkup()\r\n    },\r\n    _renderSubmitElement: function() {\r\n        this._$submitElement = $(\"<textarea>\").addClass(HTML_EDITOR_SUBMIT_ELEMENT_CLASS).attr(\"hidden\", true).appendTo(this.$element());\r\n        this._setSubmitValue(this.option(\"value\"))\r\n    },\r\n    _setSubmitValue: function(value) {\r\n        this._getSubmitElement().val(value)\r\n    },\r\n    _getSubmitElement: function() {\r\n        return this._$submitElement\r\n    },\r\n    _removeXSSVulnerableHtml: function(value) {\r\n        var $frame = $(\"<iframe>\").css(\"display\", \"none\").attr({\r\n            id: \"xss-frame\",\r\n            sandbox: \"allow-same-origin\"\r\n        }).appendTo(\"body\");\r\n        var frame = $frame.get(0);\r\n        var frameWindow = frame.contentWindow;\r\n        var frameDocument = frameWindow.document;\r\n        var frameDocumentBody = frameDocument.body;\r\n        frameDocumentBody.innerHTML = value;\r\n        var removeInlineHandlers = element => {\r\n            if (element.attributes) {\r\n                for (var i = 0; i < element.attributes.length; i++) {\r\n                    var name = element.attributes[i].name;\r\n                    if (name.startsWith(\"on\")) {\r\n                        element.removeAttribute(name)\r\n                    }\r\n                }\r\n            }\r\n            if (element.childNodes) {\r\n                for (var _i = 0; _i < element.childNodes.length; _i++) {\r\n                    removeInlineHandlers(element.childNodes[_i])\r\n                }\r\n            }\r\n        };\r\n        removeInlineHandlers(frameDocumentBody);\r\n        $(frameDocumentBody).find(\"script\").remove();\r\n        var sanitizedHtml = frameDocumentBody.innerHTML;\r\n        $frame.remove();\r\n        return sanitizedHtml\r\n    },\r\n    _updateContainerMarkup: function() {\r\n        var markup = this.option(\"value\");\r\n        if (this._isMarkdownValue()) {\r\n            this._prepareMarkdownConverter();\r\n            markup = this._markdownConverter.toHtml(markup)\r\n        }\r\n        if (markup) {\r\n            var sanitizedMarkup = this._removeXSSVulnerableHtml(markup);\r\n            this._$htmlContainer.html(sanitizedMarkup)\r\n        }\r\n    },\r\n    _prepareMarkdownConverter: function() {\r\n        var MarkdownConverter = ConverterController.getConverter(\"markdown\");\r\n        if (MarkdownConverter) {\r\n            this._markdownConverter = new MarkdownConverter\r\n        } else {\r\n            throw Errors.Error(\"E1051\", \"markdown\")\r\n        }\r\n    },\r\n    _render: function() {\r\n        this._prepareConverters();\r\n        this.callBase()\r\n    },\r\n    _prepareQuillRegistrator: function() {\r\n        if (!this._quillRegistrator) {\r\n            this._quillRegistrator = new QuillRegistrator\r\n        }\r\n    },\r\n    _getRegistrator: function() {\r\n        this._prepareQuillRegistrator();\r\n        return this._quillRegistrator\r\n    },\r\n    _prepareConverters: function() {\r\n        if (!this._deltaConverter) {\r\n            var DeltaConverter = ConverterController.getConverter(\"delta\");\r\n            if (DeltaConverter) {\r\n                this._deltaConverter = new DeltaConverter\r\n            }\r\n        }\r\n        if (this.option(\"valueType\") === MARKDOWN_VALUE_TYPE && !this._markdownConverter) {\r\n            this._prepareMarkdownConverter()\r\n        }\r\n    },\r\n    _renderContentImpl: function() {\r\n        this._contentRenderedDeferred = new Deferred;\r\n        var renderContentPromise = this._contentRenderedDeferred.promise();\r\n        this.callBase();\r\n        this._renderHtmlEditor();\r\n        this._renderFormDialog();\r\n        this._addKeyPressHandler();\r\n        return renderContentPromise\r\n    },\r\n    _pointerMoveHandler: function(e) {\r\n        if (isIos) {\r\n            e.stopPropagation()\r\n        }\r\n    },\r\n    _attachFocusEvents: function() {\r\n        deferRender(this.callBase.bind(this))\r\n    },\r\n    _addKeyPressHandler: function() {\r\n        var keyDownEvent = addNamespace(\"keydown\", \"\".concat(this.NAME, \"TextChange\"));\r\n        eventsEngine.on(this._$htmlContainer, keyDownEvent, this._keyDownHandler.bind(this))\r\n    },\r\n    _keyDownHandler: function(e) {\r\n        this._saveValueChangeEvent(e)\r\n    },\r\n    _renderHtmlEditor: function() {\r\n        var customizeModules = this.option(\"customizeModules\");\r\n        var modulesConfig = this._getModulesConfig();\r\n        if (isFunction(customizeModules)) {\r\n            customizeModules(modulesConfig)\r\n        }\r\n        this._quillInstance = this._getRegistrator().createEditor(this._$htmlContainer[0], {\r\n            placeholder: this.option(\"placeholder\"),\r\n            readOnly: this.option(\"readOnly\") || this.option(\"disabled\"),\r\n            modules: modulesConfig,\r\n            theme: \"basic\"\r\n        });\r\n        this._deltaConverter.setQuillInstance(this._quillInstance);\r\n        this._textChangeHandlerWithContext = this._textChangeHandler.bind(this);\r\n        this._quillInstance.on(\"text-change\", this._textChangeHandlerWithContext);\r\n        this._renderScrollHandler();\r\n        if (this._hasTranscludedContent()) {\r\n            this._updateContentTask = executeAsync(() => {\r\n                this._applyTranscludedContent()\r\n            })\r\n        } else {\r\n            this._finalizeContentRendering()\r\n        }\r\n    },\r\n    _renderScrollHandler: function() {\r\n        var $scrollContainer = this._getContent();\r\n        var initScrollData = prepareScrollData($scrollContainer);\r\n        eventsEngine.on($scrollContainer, addNamespace(scrollEvents.init, this.NAME), initScrollData, noop);\r\n        eventsEngine.on($scrollContainer, addNamespace(pointerEvents.move, this.NAME), this._pointerMoveHandler.bind(this))\r\n    },\r\n    _applyTranscludedContent: function() {\r\n        var valueOption = this.option(\"value\");\r\n        if (!isDefined(valueOption)) {\r\n            var html = this._deltaConverter.toHtml();\r\n            var newDelta = this._quillInstance.clipboard.convert({\r\n                html: html\r\n            });\r\n            if (newDelta.ops.length) {\r\n                this._quillInstance.setContents(newDelta);\r\n                return\r\n            }\r\n        }\r\n        this._finalizeContentRendering()\r\n    },\r\n    _hasTranscludedContent: function() {\r\n        return this._$templateResult && this._$templateResult.length\r\n    },\r\n    _getModulesConfig: function() {\r\n        var quill = this._getRegistrator().getQuill();\r\n        var wordListMatcher = getWordMatcher(quill);\r\n        var modulesConfig = extend({}, {\r\n            table: true,\r\n            toolbar: this._getModuleConfigByOption(\"toolbar\"),\r\n            variables: this._getModuleConfigByOption(\"variables\"),\r\n            resizing: this._getModuleConfigByOption(\"mediaResizing\"),\r\n            tableResizing: this._getModuleConfigByOption(\"tableResizing\"),\r\n            tableContextMenu: this._getModuleConfigByOption(\"tableContextMenu\"),\r\n            imageUpload: this._getModuleConfigByOption(\"imageUpload\"),\r\n            imageCursor: this._getBaseModuleConfig(),\r\n            mentions: this._getModuleConfigByOption(\"mentions\"),\r\n            uploader: {\r\n                onDrop: e => this._saveValueChangeEvent(dxEvent(e)),\r\n                imageBlot: \"extendedImage\"\r\n            },\r\n            keyboard: {\r\n                onKeydown: e => this._saveValueChangeEvent(dxEvent(e))\r\n            },\r\n            clipboard: {\r\n                onPaste: e => this._saveValueChangeEvent(dxEvent(e)),\r\n                onCut: e => this._saveValueChangeEvent(dxEvent(e)),\r\n                matchers: [\r\n                    [\"p.MsoListParagraphCxSpFirst\", wordListMatcher],\r\n                    [\"p.MsoListParagraphCxSpMiddle\", wordListMatcher],\r\n                    [\"p.MsoListParagraphCxSpLast\", wordListMatcher]\r\n                ]\r\n            },\r\n            multiline: Boolean(this.option(\"allowSoftLineBreak\"))\r\n        }, this._getCustomModules());\r\n        return modulesConfig\r\n    },\r\n    _getModuleConfigByOption: function(userOptionName) {\r\n        var optionValue = this.option(userOptionName);\r\n        var config = {};\r\n        if (!isDefined(optionValue)) {\r\n            return\r\n        }\r\n        if (Array.isArray(optionValue)) {\r\n            config[userOptionName] = optionValue\r\n        } else {\r\n            config = optionValue\r\n        }\r\n        return extend(this._getBaseModuleConfig(), config)\r\n    },\r\n    _getBaseModuleConfig: function() {\r\n        return {\r\n            editorInstance: this\r\n        }\r\n    },\r\n    _getCustomModules: function() {\r\n        var modules = {};\r\n        var moduleNames = this._getRegistrator().getRegisteredModuleNames();\r\n        moduleNames.forEach(modulePath => {\r\n            modules[modulePath] = this._getBaseModuleConfig()\r\n        });\r\n        return modules\r\n    },\r\n    _textChangeHandler: function(newDelta, oldDelta, source) {\r\n        var htmlMarkup = this._deltaConverter.toHtml();\r\n        var convertedValue = this._isMarkdownValue() ? this._updateValueByType(MARKDOWN_VALUE_TYPE, htmlMarkup) : htmlMarkup;\r\n        var currentValue = this.option(\"value\");\r\n        if (currentValue !== convertedValue && !this._isNullValueConverted(currentValue, convertedValue)) {\r\n            this._isEditorUpdating = true;\r\n            this.option(\"value\", convertedValue)\r\n        }\r\n        this._finalizeContentRendering()\r\n    },\r\n    _isNullValueConverted: function(currentValue, convertedValue) {\r\n        return null === currentValue && \"\" === convertedValue\r\n    },\r\n    _finalizeContentRendering: function() {\r\n        if (this._contentRenderedDeferred) {\r\n            this.clearHistory();\r\n            this._contentInitializedCallback.fire();\r\n            this._contentRenderedDeferred.resolve();\r\n            this._contentRenderedDeferred = void 0\r\n        }\r\n    },\r\n    _updateValueByType: function(valueType, value) {\r\n        var converter = this._markdownConverter;\r\n        if (!isDefined(converter)) {\r\n            return\r\n        }\r\n        var currentValue = ensureDefined(value, this.option(\"value\"));\r\n        return valueType === MARKDOWN_VALUE_TYPE ? converter.toMarkdown(currentValue) : converter.toHtml(currentValue)\r\n    },\r\n    _isMarkdownValue: function() {\r\n        return this.option(\"valueType\") === MARKDOWN_VALUE_TYPE\r\n    },\r\n    _resetEnabledState: function() {\r\n        if (this._quillInstance) {\r\n            var isEnabled = !(this.option(\"readOnly\") || this.option(\"disabled\"));\r\n            this._quillInstance.enable(isEnabled)\r\n        }\r\n    },\r\n    _renderFormDialog: function() {\r\n        var userOptions = extend(true, {\r\n            width: \"auto\",\r\n            height: \"auto\",\r\n            hideOnOutsideClick: true\r\n        }, this.option(\"formDialogOptions\"));\r\n        this._formDialog = new FormDialog(this, userOptions)\r\n    },\r\n    _getStylingModePrefix: function() {\r\n        return \"dx-htmleditor-\"\r\n    },\r\n    _getQuillContainer: function() {\r\n        return this._$htmlContainer\r\n    },\r\n    _prepareModuleOptions(args) {\r\n        var _args$fullName;\r\n        var optionData = null === (_args$fullName = args.fullName) || void 0 === _args$fullName ? void 0 : _args$fullName.split(\".\");\r\n        var value = args.value;\r\n        var optionName = optionData.length >= 2 ? optionData[1] : args.name;\r\n        if (3 === optionData.length) {\r\n            value = {\r\n                [optionData[2]]: value\r\n            }\r\n        }\r\n        return [optionName, value]\r\n    },\r\n    _moduleOptionChanged: function(moduleName, args) {\r\n        var _this$_quillInstance;\r\n        var moduleInstance = null === (_this$_quillInstance = this._quillInstance) || void 0 === _this$_quillInstance ? void 0 : _this$_quillInstance.getModule(moduleName);\r\n        var shouldPassOptionsToModule = Boolean(moduleInstance);\r\n        if (shouldPassOptionsToModule) {\r\n            moduleInstance.option(...this._prepareModuleOptions(args))\r\n        } else {\r\n            this._invalidate()\r\n        }\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"value\":\r\n                if (this._quillInstance) {\r\n                    if (this._isEditorUpdating) {\r\n                        this._isEditorUpdating = false\r\n                    } else {\r\n                        var updatedValue = this._isMarkdownValue() ? this._updateValueByType(\"HTML\", args.value) : args.value;\r\n                        this._updateHtmlContent(updatedValue)\r\n                    }\r\n                } else {\r\n                    this._$htmlContainer.html(args.value)\r\n                }\r\n                this._setSubmitValue(args.value);\r\n                this.callBase(args);\r\n                break;\r\n            case \"placeholder\":\r\n            case \"variables\":\r\n            case \"toolbar\":\r\n            case \"mentions\":\r\n            case \"customizeModules\":\r\n            case \"allowSoftLineBreak\":\r\n                this._invalidate();\r\n                break;\r\n            case \"tableResizing\":\r\n                this._moduleOptionChanged(\"tableResizing\", args);\r\n                break;\r\n            case \"valueType\":\r\n                this._prepareConverters();\r\n                var newValue = this._updateValueByType(args.value);\r\n                if (\"html\" === args.value && this._quillInstance) {\r\n                    this._updateHtmlContent(newValue)\r\n                } else {\r\n                    this.option(\"value\", newValue)\r\n                }\r\n                break;\r\n            case \"stylingMode\":\r\n                this._renderStylingMode();\r\n                break;\r\n            case \"readOnly\":\r\n            case \"disabled\":\r\n                this.callBase(args);\r\n                this._resetEnabledState();\r\n                break;\r\n            case \"formDialogOptions\":\r\n                this._renderFormDialog();\r\n                break;\r\n            case \"tableContextMenu\":\r\n                this._moduleOptionChanged(\"tableContextMenu\", args);\r\n                break;\r\n            case \"mediaResizing\":\r\n                if (!args.previousValue || !args.value) {\r\n                    this._invalidate()\r\n                } else {\r\n                    this._quillInstance.getModule(\"resizing\").option(args.name, args.value)\r\n                }\r\n                break;\r\n            case \"width\":\r\n                this.callBase(args);\r\n                this._repaintToolbar();\r\n                break;\r\n            case \"imageUpload\":\r\n                this._moduleOptionChanged(\"imageUpload\", args);\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _repaintToolbar: function() {\r\n        var toolbar = this._quillInstance.getModule(\"toolbar\");\r\n        toolbar && toolbar.repaint()\r\n    },\r\n    _updateHtmlContent: function(html) {\r\n        var newDelta = this._quillInstance.clipboard.convert({\r\n            html: html\r\n        });\r\n        this._quillInstance.setContents(newDelta)\r\n    },\r\n    _clean: function() {\r\n        if (this._quillInstance) {\r\n            eventsEngine.off(this._getContent(), \".\".concat(this.NAME));\r\n            this._quillInstance.off(\"text-change\", this._textChangeHandlerWithContext);\r\n            this._cleanCallback.fire()\r\n        }\r\n        this._abortUpdateContentTask();\r\n        this._cleanCallback.empty();\r\n        this._contentInitializedCallback.empty();\r\n        this.callBase()\r\n    },\r\n    _abortUpdateContentTask: function() {\r\n        if (this._updateContentTask) {\r\n            this._updateContentTask.abort();\r\n            this._updateContentTask = void 0\r\n        }\r\n    },\r\n    _applyQuillMethod(methodName, args) {\r\n        if (this._quillInstance) {\r\n            return this._quillInstance[methodName].apply(this._quillInstance, args)\r\n        }\r\n    },\r\n    _applyQuillHistoryMethod(methodName) {\r\n        if (this._quillInstance && this._quillInstance.history) {\r\n            this._quillInstance.history[methodName]()\r\n        }\r\n    },\r\n    addCleanCallback(callback) {\r\n        this._cleanCallback.add(callback)\r\n    },\r\n    addContentInitializedCallback(callback) {\r\n        this._contentInitializedCallback.add(callback)\r\n    },\r\n    register: function(components) {\r\n        this._getRegistrator().registerModules(components);\r\n        if (this._quillInstance) {\r\n            this.repaint()\r\n        }\r\n    },\r\n    get: function(modulePath) {\r\n        return this._getRegistrator().getQuill().import(modulePath)\r\n    },\r\n    getModule: function(moduleName) {\r\n        return this._applyQuillMethod(\"getModule\", arguments)\r\n    },\r\n    getQuillInstance: function() {\r\n        return this._quillInstance\r\n    },\r\n    getSelection: function(focus) {\r\n        return this._applyQuillMethod(\"getSelection\", arguments)\r\n    },\r\n    setSelection: function(index, length) {\r\n        this._applyQuillMethod(\"setSelection\", arguments)\r\n    },\r\n    getText: function(index, length) {\r\n        return this._applyQuillMethod(\"getText\", arguments)\r\n    },\r\n    format: function(formatName, formatValue) {\r\n        this._applyQuillMethod(\"format\", arguments)\r\n    },\r\n    formatText: function(index, length, formatName, formatValue) {\r\n        this._applyQuillMethod(\"formatText\", arguments)\r\n    },\r\n    formatLine: function(index, length, formatName, formatValue) {\r\n        this._applyQuillMethod(\"formatLine\", arguments)\r\n    },\r\n    getFormat: function(index, length) {\r\n        return this._applyQuillMethod(\"getFormat\", arguments)\r\n    },\r\n    removeFormat: function(index, length) {\r\n        return this._applyQuillMethod(\"removeFormat\", arguments)\r\n    },\r\n    clearHistory: function() {\r\n        this._applyQuillHistoryMethod(\"clear\")\r\n    },\r\n    undo: function() {\r\n        this._applyQuillHistoryMethod(\"undo\")\r\n    },\r\n    redo: function() {\r\n        this._applyQuillHistoryMethod(\"redo\")\r\n    },\r\n    getLength: function() {\r\n        return this._applyQuillMethod(\"getLength\")\r\n    },\r\n    getBounds: function(index, length) {\r\n        return this._applyQuillMethod(\"getBounds\", arguments)\r\n    },\r\n    delete: function(index, length) {\r\n        this._applyQuillMethod(\"deleteText\", arguments)\r\n    },\r\n    insertText: function(index, text, formats) {\r\n        this._applyQuillMethod(\"insertText\", arguments)\r\n    },\r\n    insertEmbed: function(index, type, config) {\r\n        this._applyQuillMethod(\"insertEmbed\", arguments)\r\n    },\r\n    showFormDialog: function(formConfig) {\r\n        return this._formDialog.show(formConfig)\r\n    },\r\n    formDialogOption: function(optionName, optionValue) {\r\n        return this._formDialog.popupOption.apply(this._formDialog, arguments)\r\n    },\r\n    focus: function() {\r\n        this.callBase();\r\n        this._applyQuillMethod(\"focus\")\r\n    },\r\n    blur: function() {\r\n        this._applyQuillMethod(\"blur\")\r\n    }\r\n});\r\nregisterComponent(\"dxHtmlEditor\", HtmlEditor);\r\nexport default HtmlEditor;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}