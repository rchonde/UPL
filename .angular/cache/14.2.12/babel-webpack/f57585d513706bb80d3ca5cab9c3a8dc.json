{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/grid_core/ui.grid_core.editing_form_based.js)\r\n * Version: 22.2.4\r\n * Build date: Thu Jan 19 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../core/renderer\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport Guid from \"../../core/guid\";\nimport { isDefined, isString } from \"../../core/utils/type\";\nimport { each } from \"../../core/utils/iterator\";\nimport { extend } from \"../../core/utils/extend\";\nimport Button from \"../button\";\nimport devices from \"../../core/devices\";\nimport Form from \"../form\";\nimport { Deferred } from \"../../core/utils/deferred\";\nimport { equalByValue } from \"../../core/utils/common\";\nimport { isElementInDom } from \"../../core/utils/dom\";\nimport Scrollable from \"../scroll_view/ui.scrollable\";\nimport Popup from \"../popup/ui.popup\";\nimport { EDIT_MODE_FORM, EDIT_MODE_POPUP, FOCUSABLE_ELEMENT_SELECTOR, EDITING_EDITROWKEY_OPTION_NAME, EDITING_POPUP_OPTION_NAME, DATA_EDIT_DATA_INSERT_TYPE, EDITING_FORM_OPTION_NAME } from \"./ui.grid_core.editing_constants\";\nvar isRenovatedScrollable = !!Scrollable.IS_RENOVATED_WIDGET;\nvar EDIT_FORM_ITEM_CLASS = \"edit-form-item\";\nvar EDIT_POPUP_CLASS = \"edit-popup\";\nvar EDIT_POPUP_FORM_CLASS = \"edit-popup-form\";\nvar FOCUSABLE_ELEMENT_CLASS = isRenovatedScrollable ? \"dx-scrollable\" : \"dx-scrollable-container\";\nvar BUTTON_CLASS = \"dx-button\";\nvar FORM_BUTTONS_CONTAINER_CLASS = \"form-buttons-container\";\n\nvar getEditorType = item => {\n  var _column$formItem;\n\n  var column = item.column;\n  return item.isCustomEditorType ? item.editorType : null === (_column$formItem = column.formItem) || void 0 === _column$formItem ? void 0 : _column$formItem.editorType;\n};\n\nvar forEachFormItems = (items, callBack) => {\n  items.forEach(item => {\n    if (item.items || item.tabs) {\n      forEachFormItems(item.items || item.tabs, callBack);\n    } else {\n      callBack(item);\n    }\n  });\n};\n\nexport var editingFormBasedModule = {\n  extenders: {\n    controllers: {\n      editing: {\n        init: function () {\n          this._editForm = null;\n          this._updateEditFormDeferred = null;\n          this.callBase.apply(this, arguments);\n        },\n        isFormOrPopupEditMode: function () {\n          return this.isPopupEditMode() || this.isFormEditMode();\n        },\n        isPopupEditMode: function () {\n          var editMode = this.option(\"editing.mode\");\n          return editMode === EDIT_MODE_POPUP;\n        },\n        isFormEditMode: function () {\n          var editMode = this.option(\"editing.mode\");\n          return editMode === EDIT_MODE_FORM;\n        },\n        getFirstEditableColumnIndex: function () {\n          var firstFormItem = this._firstFormItem;\n\n          if (this.isFormEditMode() && firstFormItem) {\n            var editRowKey = this.option(EDITING_EDITROWKEY_OPTION_NAME);\n\n            var editRowIndex = this._dataController.getRowIndexByKey(editRowKey);\n\n            var $editFormElements = this._rowsView.getCellElements(editRowIndex);\n\n            return this._rowsView._getEditFormEditorVisibleIndex($editFormElements, firstFormItem.column);\n          }\n\n          return this.callBase.apply(this, arguments);\n        },\n        getEditFormRowIndex: function () {\n          return this.isFormOrPopupEditMode() ? this._getVisibleEditRowIndex() : this.callBase.apply(this, arguments);\n        },\n        _isEditColumnVisible: function () {\n          var result = this.callBase.apply(this, arguments);\n          var editingOptions = this.option(\"editing\");\n          return this.isFormOrPopupEditMode() ? editingOptions.allowUpdating || result : result;\n        },\n        _handleDataChanged: function (args) {\n          if (this.isPopupEditMode()) {\n            var _args$items, _args$changeTypes;\n\n            var editRowKey = this.option(\"editing.editRowKey\");\n            var hasEditRow = null === args || void 0 === args ? void 0 : null === (_args$items = args.items) || void 0 === _args$items ? void 0 : _args$items.some(item => equalByValue(item.key, editRowKey));\n            var onlyInsertChanges = (null === (_args$changeTypes = args.changeTypes) || void 0 === _args$changeTypes ? void 0 : _args$changeTypes.length) && args.changeTypes.every(item => \"insert\" === item);\n\n            if ((\"refresh\" === args.changeType || hasEditRow && args.isOptionChanged) && !onlyInsertChanges) {\n              this._repaintEditPopup();\n            }\n          }\n\n          this.callBase.apply(this, arguments);\n        },\n        getPopupContent: function () {\n          var _this$_editPopup;\n\n          var popupVisible = null === (_this$_editPopup = this._editPopup) || void 0 === _this$_editPopup ? void 0 : _this$_editPopup.option(\"visible\");\n\n          if (this.isPopupEditMode() && popupVisible) {\n            return this._$popupContent;\n          }\n        },\n        _showAddedRow: function (rowIndex) {\n          if (this.isPopupEditMode()) {\n            this._showEditPopup(rowIndex);\n          } else {\n            this.callBase.apply(this, arguments);\n          }\n        },\n        _cancelEditDataCore: function () {\n          this.callBase.apply(this, arguments);\n\n          if (this.isPopupEditMode()) {\n            this._hideEditPopup();\n          }\n        },\n        _updateEditRowCore: function (row, skipCurrentRow, isCustomSetCellValue) {\n          var editForm = this._editForm;\n\n          if (this.isPopupEditMode()) {\n            if (this.option(\"repaintChangesOnly\")) {\n              var _row$update;\n\n              null === (_row$update = row.update) || void 0 === _row$update ? void 0 : _row$update.call(row, row);\n\n              this._rowsView.renderDelayedTemplates();\n            } else if (editForm) {\n              this._updateEditFormDeferred = new Deferred().done(() => editForm.repaint());\n\n              if (!this._updateLockCount) {\n                this._updateEditFormDeferred.resolve();\n              }\n            }\n          } else {\n            this.callBase.apply(this, arguments);\n          }\n        },\n        _showEditPopup: function (rowIndex, repaintForm) {\n          var isMobileDevice = \"desktop\" !== devices.current().deviceType;\n          var popupOptions = extend({\n            showTitle: false,\n            fullScreen: isMobileDevice,\n            copyRootClassesToWrapper: true,\n            _ignoreCopyRootClassesToWrapperDeprecation: true,\n            toolbarItems: [{\n              toolbar: \"bottom\",\n              location: \"after\",\n              widget: \"dxButton\",\n              options: this._getSaveButtonConfig()\n            }, {\n              toolbar: \"bottom\",\n              location: \"after\",\n              widget: \"dxButton\",\n              options: this._getCancelButtonConfig()\n            }],\n            contentTemplate: this._getPopupEditFormTemplate(rowIndex)\n          }, this.option(EDITING_POPUP_OPTION_NAME));\n\n          if (!this._editPopup) {\n            var $popupContainer = $(\"<div>\").appendTo(this.component.$element()).addClass(this.addWidgetPrefix(EDIT_POPUP_CLASS));\n            this._editPopup = this._createComponent($popupContainer, Popup, {\n              copyRootClassesToWrapper: true,\n              _ignoreCopyRootClassesToWrapperDeprecation: true\n            });\n\n            this._editPopup.on(\"hiding\", this._getEditPopupHiddenHandler());\n\n            this._editPopup.on(\"shown\", e => {\n              eventsEngine.trigger(e.component.$content().find(FOCUSABLE_ELEMENT_SELECTOR).not(\".\".concat(FOCUSABLE_ELEMENT_CLASS)).first(), \"focus\");\n\n              if (repaintForm) {\n                var _this$_editForm;\n\n                null === (_this$_editForm = this._editForm) || void 0 === _this$_editForm ? void 0 : _this$_editForm.repaint();\n              }\n            });\n          }\n\n          this._editPopup.option(popupOptions);\n\n          this._editPopup.show();\n\n          this.callBase.apply(this, arguments);\n        },\n        _getPopupEditFormTemplate: function (rowIndex) {\n          var row = this.component.getVisibleRows()[rowIndex];\n          var templateOptions = {\n            row: row,\n            values: row.values,\n            rowType: row.rowType,\n            key: row.key,\n            rowIndex: rowIndex\n          };\n\n          this._rowsView._addWatchMethod(templateOptions, row);\n\n          return container => {\n            var formTemplate = this.getEditFormTemplate();\n\n            var scrollable = this._createComponent($(\"<div>\").appendTo(container), Scrollable);\n\n            this._$popupContent = $(scrollable.content());\n            formTemplate(this._$popupContent, templateOptions, {\n              isPopupForm: true\n            });\n\n            this._rowsView.renderDelayedTemplates();\n          };\n        },\n        _repaintEditPopup: function () {\n          var rowIndex = this._getVisibleEditRowIndex();\n\n          if (rowIndex >= 0) {\n            var _this$_editPopup2, _this$_editPopup3;\n\n            var defaultAnimation = null === (_this$_editPopup2 = this._editPopup) || void 0 === _this$_editPopup2 ? void 0 : _this$_editPopup2.option(\"animation\");\n            null === (_this$_editPopup3 = this._editPopup) || void 0 === _this$_editPopup3 ? void 0 : _this$_editPopup3.option(\"animation\", null);\n\n            this._showEditPopup(rowIndex, true);\n\n            if (void 0 !== defaultAnimation) {\n              this._editPopup.option(\"animation\", defaultAnimation);\n            }\n          }\n        },\n        _hideEditPopup: function () {\n          var _this$_editPopup4;\n\n          null === (_this$_editPopup4 = this._editPopup) || void 0 === _this$_editPopup4 ? void 0 : _this$_editPopup4.option(\"visible\", false);\n        },\n        optionChanged: function (args) {\n          if (\"editing\" === args.name && this.isFormOrPopupEditMode()) {\n            var fullName = args.fullName;\n\n            if (0 === fullName.indexOf(EDITING_FORM_OPTION_NAME)) {\n              this._handleFormOptionChange(args);\n\n              args.handled = true;\n            } else if (0 === fullName.indexOf(EDITING_POPUP_OPTION_NAME)) {\n              this._handlePopupOptionChange(args);\n\n              args.handled = true;\n            }\n          }\n\n          this.callBase.apply(this, arguments);\n        },\n        _handleFormOptionChange: function (args) {\n          var _this$_editPopup5;\n\n          if (this.isFormEditMode()) {\n            var editRowIndex = this._getVisibleEditRowIndex();\n\n            if (editRowIndex >= 0) {\n              this._dataController.updateItems({\n                changeType: \"update\",\n                rowIndices: [editRowIndex]\n              });\n            }\n          } else if (null !== (_this$_editPopup5 = this._editPopup) && void 0 !== _this$_editPopup5 && _this$_editPopup5.option(\"visible\") && 0 === args.fullName.indexOf(EDITING_FORM_OPTION_NAME)) {\n            this._repaintEditPopup();\n          }\n        },\n        _handlePopupOptionChange: function (args) {\n          var editPopup = this._editPopup;\n\n          if (editPopup) {\n            var popupOptionName = args.fullName.slice(EDITING_POPUP_OPTION_NAME.length + 1);\n\n            if (popupOptionName) {\n              editPopup.option(popupOptionName, args.value);\n            } else {\n              editPopup.option(args.value);\n            }\n          }\n        },\n        renderFormEditTemplate: function (detailCellOptions, item, formTemplateOptions, container, isReadOnly) {\n          var that = this;\n          var $container = $(container);\n          var column = item.column;\n          var editorType = getEditorType(item);\n          var rowData = null === detailCellOptions || void 0 === detailCellOptions ? void 0 : detailCellOptions.row.data;\n          var form = formTemplateOptions.component;\n          var {\n            label: label,\n            labelMark: labelMark,\n            labelMode: labelMode\n          } = formTemplateOptions.editorOptions || {};\n          var cellOptions = extend({}, detailCellOptions, {\n            data: rowData,\n            cellElement: null,\n            isOnForm: true,\n            item: item,\n            id: form.getItemID(item.name || item.dataField),\n            column: extend({}, column, {\n              editorType: editorType,\n              editorOptions: extend({\n                label: label,\n                labelMark: labelMark,\n                labelMode: labelMode\n              }, column.editorOptions, item.editorOptions)\n            }),\n            columnIndex: column.index,\n            setValue: !isReadOnly && column.allowEditing && function (value, text) {\n              that.updateFieldValue(cellOptions, value, text);\n            }\n          });\n          cellOptions.value = column.calculateCellValue(rowData);\n\n          var template = this._getFormEditItemTemplate.bind(this)(cellOptions, column);\n\n          this._rowsView.renderTemplate($container, template, cellOptions, !!isElementInDom($container)).done(() => {\n            this._rowsView._updateCell($container, cellOptions);\n          });\n\n          return cellOptions;\n        },\n        getFormEditorTemplate: function (cellOptions, item) {\n          var column = this.component.columnOption(item.dataField);\n          return (options, container) => {\n            var _cellOptions$row$watc, _cellOptions$row;\n\n            var $container = $(container);\n            null === (_cellOptions$row$watc = (_cellOptions$row = cellOptions.row).watch) || void 0 === _cellOptions$row$watc ? void 0 : _cellOptions$row$watc.call(_cellOptions$row, function () {\n              return column.selector(cellOptions.row.data);\n            }, () => {\n              var _validator;\n\n              var $editorElement = $container.find(\".dx-widget\").first();\n              var validator = $editorElement.data(\"dxValidator\");\n              var validatorOptions = null === (_validator = validator) || void 0 === _validator ? void 0 : _validator.option();\n              $container.contents().remove();\n              cellOptions = this.renderFormEditTemplate.bind(this)(cellOptions, item, options, $container);\n              $editorElement = $container.find(\".dx-widget\").first();\n              validator = $editorElement.data(\"dxValidator\");\n\n              if (validatorOptions && !validator) {\n                $editorElement.dxValidator({\n                  validationRules: validatorOptions.validationRules,\n                  validationGroup: validatorOptions.validationGroup,\n                  dataGetter: validatorOptions.dataGetter\n                });\n              }\n            });\n            cellOptions = this.renderFormEditTemplate.bind(this)(cellOptions, item, options, $container);\n          };\n        },\n        getEditFormOptions: function (detailOptions) {\n          var _this$_getValidationG;\n\n          var editFormOptions = null === (_this$_getValidationG = this._getValidationGroupsInForm) || void 0 === _this$_getValidationG ? void 0 : _this$_getValidationG.call(this, detailOptions);\n          var userCustomizeItem = this.option(\"editing.form.customizeItem\");\n          var editFormItemClass = this.addWidgetPrefix(EDIT_FORM_ITEM_CLASS);\n          var items = this.option(\"editing.form.items\");\n          var isCustomEditorType = {};\n\n          if (!items) {\n            var columns = this.getController(\"columns\").getColumns();\n            items = [];\n            each(columns, function (_, column) {\n              if (!column.isBand && !column.type) {\n                items.push({\n                  column: column,\n                  name: column.name,\n                  dataField: column.dataField\n                });\n              }\n            });\n          } else {\n            forEachFormItems(items, item => {\n              var itemId = (null === item || void 0 === item ? void 0 : item.name) || (null === item || void 0 === item ? void 0 : item.dataField);\n\n              if (itemId) {\n                isCustomEditorType[itemId] = !!item.editorType;\n              }\n            });\n          }\n\n          return extend({}, editFormOptions, {\n            items: items,\n            formID: \"dx-\" + new Guid(),\n            customizeItem: item => {\n              var column;\n              var itemId = item.name || item.dataField;\n\n              if (item.column || itemId) {\n                column = item.column || this._columnsController.columnOption(item.name ? \"name:\" + item.name : \"dataField:\" + item.dataField);\n              }\n\n              if (column) {\n                item.label = item.label || {};\n                item.label.text = item.label.text || column.caption;\n\n                if (\"boolean\" === column.dataType && void 0 === item.label.visible) {\n                  var labelMode = this.option(\"editing.form.labelMode\");\n\n                  if (\"floating\" === labelMode || \"static\" === labelMode) {\n                    item.label.visible = true;\n                  }\n                }\n\n                item.template = item.template || this.getFormEditorTemplate(detailOptions, item);\n                item.column = column;\n                item.isCustomEditorType = isCustomEditorType[itemId];\n\n                if (column.formItem) {\n                  extend(item, column.formItem);\n                }\n\n                if (void 0 === item.isRequired && column.validationRules) {\n                  item.isRequired = column.validationRules.some(function (rule) {\n                    return \"required\" === rule.type;\n                  });\n                  item.validationRules = [];\n                }\n\n                var itemVisible = isDefined(item.visible) ? item.visible : true;\n\n                if (!this._firstFormItem && itemVisible) {\n                  this._firstFormItem = item;\n                }\n              }\n\n              null === userCustomizeItem || void 0 === userCustomizeItem ? void 0 : userCustomizeItem.call(this, item);\n              item.cssClass = isString(item.cssClass) ? item.cssClass + \" \" + editFormItemClass : editFormItemClass;\n            }\n          });\n        },\n        getEditFormTemplate: function () {\n          return ($container, detailOptions, options) => {\n            var editFormOptions = this.option(EDITING_FORM_OPTION_NAME);\n            var baseEditFormOptions = this.getEditFormOptions(detailOptions);\n            var $formContainer = $(\"<div>\").appendTo($container);\n            var isPopupForm = null === options || void 0 === options ? void 0 : options.isPopupForm;\n            this._firstFormItem = void 0;\n\n            if (isPopupForm) {\n              $formContainer.addClass(this.addWidgetPrefix(EDIT_POPUP_FORM_CLASS));\n            }\n\n            this._editForm = this._createComponent($formContainer, Form, extend({}, editFormOptions, baseEditFormOptions));\n\n            if (!isPopupForm) {\n              var $buttonsContainer = $(\"<div>\").addClass(this.addWidgetPrefix(FORM_BUTTONS_CONTAINER_CLASS)).appendTo($container);\n\n              this._createComponent($(\"<div>\").appendTo($buttonsContainer), Button, this._getSaveButtonConfig());\n\n              this._createComponent($(\"<div>\").appendTo($buttonsContainer), Button, this._getCancelButtonConfig());\n            }\n\n            this._editForm.on(\"contentReady\", () => {\n              var _this$_editPopup6;\n\n              this._rowsView.renderDelayedTemplates();\n\n              null === (_this$_editPopup6 = this._editPopup) || void 0 === _this$_editPopup6 ? void 0 : _this$_editPopup6.repaint();\n            });\n          };\n        },\n        getEditForm: function () {\n          return this._editForm;\n        },\n        _endUpdateCore: function () {\n          var _this$_updateEditForm;\n\n          null === (_this$_updateEditForm = this._updateEditFormDeferred) || void 0 === _this$_updateEditForm ? void 0 : _this$_updateEditForm.resolve();\n        },\n        _beforeEndSaving: function () {\n          this.callBase.apply(this, arguments);\n\n          if (this.isPopupEditMode()) {\n            var _this$_editPopup7;\n\n            null === (_this$_editPopup7 = this._editPopup) || void 0 === _this$_editPopup7 ? void 0 : _this$_editPopup7.hide();\n          }\n        },\n        _processDataItemCore: function (item, _ref) {\n          var {\n            type: type\n          } = _ref;\n\n          if (this.isPopupEditMode() && type === DATA_EDIT_DATA_INSERT_TYPE) {\n            item.visible = false;\n          }\n\n          this.callBase.apply(this, arguments);\n        },\n        _editRowFromOptionChangedCore: function (rowIndices, rowIndex) {\n          var isPopupEditMode = this.isPopupEditMode();\n          this.callBase(rowIndices, rowIndex, isPopupEditMode);\n\n          if (isPopupEditMode) {\n            this._showEditPopup(rowIndex);\n          }\n        }\n      },\n      data: {\n        _updateEditItem: function (item) {\n          if (this._editingController.isFormEditMode()) {\n            item.rowType = \"detail\";\n          }\n        },\n        _getChangedColumnIndices: function (oldItem, newItem, visibleRowIndex, isLiveUpdate) {\n          if (false === isLiveUpdate && newItem.isEditing && this._editingController.isFormEditMode()) {\n            return;\n          }\n\n          return this.callBase.apply(this, arguments);\n        }\n      }\n    },\n    views: {\n      rowsView: {\n        _renderCellContent: function ($cell, options) {\n          if (\"data\" === options.rowType && this._editingController.isPopupEditMode() && false === options.row.visible) {\n            return;\n          }\n\n          this.callBase.apply(this, arguments);\n        },\n        getCellElements: function (rowIndex) {\n          var $cellElements = this.callBase(rowIndex);\n          var editingController = this._editingController;\n          var editForm = editingController.getEditForm();\n          var editFormRowIndex = editingController.getEditFormRowIndex();\n\n          if (editFormRowIndex === rowIndex && $cellElements && editForm) {\n            return editForm.$element().find(\".\" + this.addWidgetPrefix(EDIT_FORM_ITEM_CLASS) + \", .\" + BUTTON_CLASS);\n          }\n\n          return $cellElements;\n        },\n        _getVisibleColumnIndex: function ($cells, rowIndex, columnIdentifier) {\n          var editFormRowIndex = this._editingController.getEditFormRowIndex();\n\n          if (editFormRowIndex === rowIndex && isString(columnIdentifier)) {\n            var column = this._columnsController.columnOption(columnIdentifier);\n\n            return this._getEditFormEditorVisibleIndex($cells, column);\n          }\n\n          return this.callBase.apply(this, arguments);\n        },\n        _getEditFormEditorVisibleIndex: function ($cells, column) {\n          var visibleIndex = -1;\n          each($cells, function (index, cellElement) {\n            var item = $(cellElement).find(\".dx-field-item-content\").data(\"dx-form-item\");\n\n            if (null !== item && void 0 !== item && item.column && column && item.column.index === column.index) {\n              visibleIndex = index;\n              return false;\n            }\n          });\n          return visibleIndex;\n        },\n        _isFormItem: function (parameters) {\n          var isDetailRow = \"detail\" === parameters.rowType || \"detailAdaptive\" === parameters.rowType;\n\n          var isPopupEditing = \"data\" === parameters.rowType && this._editingController.isPopupEditMode();\n\n          return (isDetailRow || isPopupEditing) && parameters.item;\n        },\n        _updateCell: function ($cell, parameters) {\n          if (this._isFormItem(parameters)) {\n            this._formItemPrepared(parameters, $cell);\n          } else {\n            this.callBase($cell, parameters);\n          }\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["$","eventsEngine","Guid","isDefined","isString","each","extend","Button","devices","Form","Deferred","equalByValue","isElementInDom","Scrollable","Popup","EDIT_MODE_FORM","EDIT_MODE_POPUP","FOCUSABLE_ELEMENT_SELECTOR","EDITING_EDITROWKEY_OPTION_NAME","EDITING_POPUP_OPTION_NAME","DATA_EDIT_DATA_INSERT_TYPE","EDITING_FORM_OPTION_NAME","isRenovatedScrollable","IS_RENOVATED_WIDGET","EDIT_FORM_ITEM_CLASS","EDIT_POPUP_CLASS","EDIT_POPUP_FORM_CLASS","FOCUSABLE_ELEMENT_CLASS","BUTTON_CLASS","FORM_BUTTONS_CONTAINER_CLASS","getEditorType","item","_column$formItem","column","isCustomEditorType","editorType","formItem","forEachFormItems","items","callBack","forEach","tabs","editingFormBasedModule","extenders","controllers","editing","init","_editForm","_updateEditFormDeferred","callBase","apply","arguments","isFormOrPopupEditMode","isPopupEditMode","isFormEditMode","editMode","option","getFirstEditableColumnIndex","firstFormItem","_firstFormItem","editRowKey","editRowIndex","_dataController","getRowIndexByKey","$editFormElements","_rowsView","getCellElements","_getEditFormEditorVisibleIndex","getEditFormRowIndex","_getVisibleEditRowIndex","_isEditColumnVisible","result","editingOptions","allowUpdating","_handleDataChanged","args","_args$items","_args$changeTypes","hasEditRow","some","key","onlyInsertChanges","changeTypes","length","every","changeType","isOptionChanged","_repaintEditPopup","getPopupContent","_this$_editPopup","popupVisible","_editPopup","_$popupContent","_showAddedRow","rowIndex","_showEditPopup","_cancelEditDataCore","_hideEditPopup","_updateEditRowCore","row","skipCurrentRow","isCustomSetCellValue","editForm","_row$update","update","call","renderDelayedTemplates","done","repaint","_updateLockCount","resolve","repaintForm","isMobileDevice","current","deviceType","popupOptions","showTitle","fullScreen","copyRootClassesToWrapper","_ignoreCopyRootClassesToWrapperDeprecation","toolbarItems","toolbar","location","widget","options","_getSaveButtonConfig","_getCancelButtonConfig","contentTemplate","_getPopupEditFormTemplate","$popupContainer","appendTo","component","$element","addClass","addWidgetPrefix","_createComponent","on","_getEditPopupHiddenHandler","e","trigger","$content","find","not","concat","first","_this$_editForm","show","getVisibleRows","templateOptions","values","rowType","_addWatchMethod","container","formTemplate","getEditFormTemplate","scrollable","content","isPopupForm","_this$_editPopup2","_this$_editPopup3","defaultAnimation","_this$_editPopup4","optionChanged","name","fullName","indexOf","_handleFormOptionChange","handled","_handlePopupOptionChange","_this$_editPopup5","updateItems","rowIndices","editPopup","popupOptionName","slice","value","renderFormEditTemplate","detailCellOptions","formTemplateOptions","isReadOnly","that","$container","rowData","data","form","label","labelMark","labelMode","editorOptions","cellOptions","cellElement","isOnForm","id","getItemID","dataField","columnIndex","index","setValue","allowEditing","text","updateFieldValue","calculateCellValue","template","_getFormEditItemTemplate","bind","renderTemplate","_updateCell","getFormEditorTemplate","columnOption","_cellOptions$row$watc","_cellOptions$row","watch","selector","_validator","$editorElement","validator","validatorOptions","contents","remove","dxValidator","validationRules","validationGroup","dataGetter","getEditFormOptions","detailOptions","_this$_getValidationG","editFormOptions","_getValidationGroupsInForm","userCustomizeItem","editFormItemClass","columns","getController","getColumns","_","isBand","type","push","itemId","formID","customizeItem","_columnsController","caption","dataType","visible","isRequired","rule","itemVisible","cssClass","baseEditFormOptions","$formContainer","$buttonsContainer","_this$_editPopup6","getEditForm","_endUpdateCore","_this$_updateEditForm","_beforeEndSaving","_this$_editPopup7","hide","_processDataItemCore","_ref","_editRowFromOptionChangedCore","_updateEditItem","_editingController","_getChangedColumnIndices","oldItem","newItem","visibleRowIndex","isLiveUpdate","isEditing","views","rowsView","_renderCellContent","$cell","$cellElements","editingController","editFormRowIndex","_getVisibleColumnIndex","$cells","columnIdentifier","visibleIndex","_isFormItem","parameters","isDetailRow","isPopupEditing","_formItemPrepared"],"sources":["D:/APPLICATION/UI/UPL/NEW/node_modules/devextreme/esm/ui/grid_core/ui.grid_core.editing_form_based.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/grid_core/ui.grid_core.editing_form_based.js)\r\n * Version: 22.2.4\r\n * Build date: Thu Jan 19 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../../core/renderer\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport Guid from \"../../core/guid\";\r\nimport {\r\n    isDefined,\r\n    isString\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    each\r\n} from \"../../core/utils/iterator\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport Button from \"../button\";\r\nimport devices from \"../../core/devices\";\r\nimport Form from \"../form\";\r\nimport {\r\n    Deferred\r\n} from \"../../core/utils/deferred\";\r\nimport {\r\n    equalByValue\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    isElementInDom\r\n} from \"../../core/utils/dom\";\r\nimport Scrollable from \"../scroll_view/ui.scrollable\";\r\nimport Popup from \"../popup/ui.popup\";\r\nimport {\r\n    EDIT_MODE_FORM,\r\n    EDIT_MODE_POPUP,\r\n    FOCUSABLE_ELEMENT_SELECTOR,\r\n    EDITING_EDITROWKEY_OPTION_NAME,\r\n    EDITING_POPUP_OPTION_NAME,\r\n    DATA_EDIT_DATA_INSERT_TYPE,\r\n    EDITING_FORM_OPTION_NAME\r\n} from \"./ui.grid_core.editing_constants\";\r\nvar isRenovatedScrollable = !!Scrollable.IS_RENOVATED_WIDGET;\r\nvar EDIT_FORM_ITEM_CLASS = \"edit-form-item\";\r\nvar EDIT_POPUP_CLASS = \"edit-popup\";\r\nvar EDIT_POPUP_FORM_CLASS = \"edit-popup-form\";\r\nvar FOCUSABLE_ELEMENT_CLASS = isRenovatedScrollable ? \"dx-scrollable\" : \"dx-scrollable-container\";\r\nvar BUTTON_CLASS = \"dx-button\";\r\nvar FORM_BUTTONS_CONTAINER_CLASS = \"form-buttons-container\";\r\nvar getEditorType = item => {\r\n    var _column$formItem;\r\n    var column = item.column;\r\n    return item.isCustomEditorType ? item.editorType : null === (_column$formItem = column.formItem) || void 0 === _column$formItem ? void 0 : _column$formItem.editorType\r\n};\r\nvar forEachFormItems = (items, callBack) => {\r\n    items.forEach(item => {\r\n        if (item.items || item.tabs) {\r\n            forEachFormItems(item.items || item.tabs, callBack)\r\n        } else {\r\n            callBack(item)\r\n        }\r\n    })\r\n};\r\nexport var editingFormBasedModule = {\r\n    extenders: {\r\n        controllers: {\r\n            editing: {\r\n                init: function() {\r\n                    this._editForm = null;\r\n                    this._updateEditFormDeferred = null;\r\n                    this.callBase.apply(this, arguments)\r\n                },\r\n                isFormOrPopupEditMode: function() {\r\n                    return this.isPopupEditMode() || this.isFormEditMode()\r\n                },\r\n                isPopupEditMode: function() {\r\n                    var editMode = this.option(\"editing.mode\");\r\n                    return editMode === EDIT_MODE_POPUP\r\n                },\r\n                isFormEditMode: function() {\r\n                    var editMode = this.option(\"editing.mode\");\r\n                    return editMode === EDIT_MODE_FORM\r\n                },\r\n                getFirstEditableColumnIndex: function() {\r\n                    var firstFormItem = this._firstFormItem;\r\n                    if (this.isFormEditMode() && firstFormItem) {\r\n                        var editRowKey = this.option(EDITING_EDITROWKEY_OPTION_NAME);\r\n                        var editRowIndex = this._dataController.getRowIndexByKey(editRowKey);\r\n                        var $editFormElements = this._rowsView.getCellElements(editRowIndex);\r\n                        return this._rowsView._getEditFormEditorVisibleIndex($editFormElements, firstFormItem.column)\r\n                    }\r\n                    return this.callBase.apply(this, arguments)\r\n                },\r\n                getEditFormRowIndex: function() {\r\n                    return this.isFormOrPopupEditMode() ? this._getVisibleEditRowIndex() : this.callBase.apply(this, arguments)\r\n                },\r\n                _isEditColumnVisible: function() {\r\n                    var result = this.callBase.apply(this, arguments);\r\n                    var editingOptions = this.option(\"editing\");\r\n                    return this.isFormOrPopupEditMode() ? editingOptions.allowUpdating || result : result\r\n                },\r\n                _handleDataChanged: function(args) {\r\n                    if (this.isPopupEditMode()) {\r\n                        var _args$items, _args$changeTypes;\r\n                        var editRowKey = this.option(\"editing.editRowKey\");\r\n                        var hasEditRow = null === args || void 0 === args ? void 0 : null === (_args$items = args.items) || void 0 === _args$items ? void 0 : _args$items.some(item => equalByValue(item.key, editRowKey));\r\n                        var onlyInsertChanges = (null === (_args$changeTypes = args.changeTypes) || void 0 === _args$changeTypes ? void 0 : _args$changeTypes.length) && args.changeTypes.every(item => \"insert\" === item);\r\n                        if ((\"refresh\" === args.changeType || hasEditRow && args.isOptionChanged) && !onlyInsertChanges) {\r\n                            this._repaintEditPopup()\r\n                        }\r\n                    }\r\n                    this.callBase.apply(this, arguments)\r\n                },\r\n                getPopupContent: function() {\r\n                    var _this$_editPopup;\r\n                    var popupVisible = null === (_this$_editPopup = this._editPopup) || void 0 === _this$_editPopup ? void 0 : _this$_editPopup.option(\"visible\");\r\n                    if (this.isPopupEditMode() && popupVisible) {\r\n                        return this._$popupContent\r\n                    }\r\n                },\r\n                _showAddedRow: function(rowIndex) {\r\n                    if (this.isPopupEditMode()) {\r\n                        this._showEditPopup(rowIndex)\r\n                    } else {\r\n                        this.callBase.apply(this, arguments)\r\n                    }\r\n                },\r\n                _cancelEditDataCore: function() {\r\n                    this.callBase.apply(this, arguments);\r\n                    if (this.isPopupEditMode()) {\r\n                        this._hideEditPopup()\r\n                    }\r\n                },\r\n                _updateEditRowCore: function(row, skipCurrentRow, isCustomSetCellValue) {\r\n                    var editForm = this._editForm;\r\n                    if (this.isPopupEditMode()) {\r\n                        if (this.option(\"repaintChangesOnly\")) {\r\n                            var _row$update;\r\n                            null === (_row$update = row.update) || void 0 === _row$update ? void 0 : _row$update.call(row, row);\r\n                            this._rowsView.renderDelayedTemplates()\r\n                        } else if (editForm) {\r\n                            this._updateEditFormDeferred = (new Deferred).done(() => editForm.repaint());\r\n                            if (!this._updateLockCount) {\r\n                                this._updateEditFormDeferred.resolve()\r\n                            }\r\n                        }\r\n                    } else {\r\n                        this.callBase.apply(this, arguments)\r\n                    }\r\n                },\r\n                _showEditPopup: function(rowIndex, repaintForm) {\r\n                    var isMobileDevice = \"desktop\" !== devices.current().deviceType;\r\n                    var popupOptions = extend({\r\n                        showTitle: false,\r\n                        fullScreen: isMobileDevice,\r\n                        copyRootClassesToWrapper: true,\r\n                        _ignoreCopyRootClassesToWrapperDeprecation: true,\r\n                        toolbarItems: [{\r\n                            toolbar: \"bottom\",\r\n                            location: \"after\",\r\n                            widget: \"dxButton\",\r\n                            options: this._getSaveButtonConfig()\r\n                        }, {\r\n                            toolbar: \"bottom\",\r\n                            location: \"after\",\r\n                            widget: \"dxButton\",\r\n                            options: this._getCancelButtonConfig()\r\n                        }],\r\n                        contentTemplate: this._getPopupEditFormTemplate(rowIndex)\r\n                    }, this.option(EDITING_POPUP_OPTION_NAME));\r\n                    if (!this._editPopup) {\r\n                        var $popupContainer = $(\"<div>\").appendTo(this.component.$element()).addClass(this.addWidgetPrefix(EDIT_POPUP_CLASS));\r\n                        this._editPopup = this._createComponent($popupContainer, Popup, {\r\n                            copyRootClassesToWrapper: true,\r\n                            _ignoreCopyRootClassesToWrapperDeprecation: true\r\n                        });\r\n                        this._editPopup.on(\"hiding\", this._getEditPopupHiddenHandler());\r\n                        this._editPopup.on(\"shown\", e => {\r\n                            eventsEngine.trigger(e.component.$content().find(FOCUSABLE_ELEMENT_SELECTOR).not(\".\".concat(FOCUSABLE_ELEMENT_CLASS)).first(), \"focus\");\r\n                            if (repaintForm) {\r\n                                var _this$_editForm;\r\n                                null === (_this$_editForm = this._editForm) || void 0 === _this$_editForm ? void 0 : _this$_editForm.repaint()\r\n                            }\r\n                        })\r\n                    }\r\n                    this._editPopup.option(popupOptions);\r\n                    this._editPopup.show();\r\n                    this.callBase.apply(this, arguments)\r\n                },\r\n                _getPopupEditFormTemplate: function(rowIndex) {\r\n                    var row = this.component.getVisibleRows()[rowIndex];\r\n                    var templateOptions = {\r\n                        row: row,\r\n                        values: row.values,\r\n                        rowType: row.rowType,\r\n                        key: row.key,\r\n                        rowIndex: rowIndex\r\n                    };\r\n                    this._rowsView._addWatchMethod(templateOptions, row);\r\n                    return container => {\r\n                        var formTemplate = this.getEditFormTemplate();\r\n                        var scrollable = this._createComponent($(\"<div>\").appendTo(container), Scrollable);\r\n                        this._$popupContent = $(scrollable.content());\r\n                        formTemplate(this._$popupContent, templateOptions, {\r\n                            isPopupForm: true\r\n                        });\r\n                        this._rowsView.renderDelayedTemplates()\r\n                    }\r\n                },\r\n                _repaintEditPopup: function() {\r\n                    var rowIndex = this._getVisibleEditRowIndex();\r\n                    if (rowIndex >= 0) {\r\n                        var _this$_editPopup2, _this$_editPopup3;\r\n                        var defaultAnimation = null === (_this$_editPopup2 = this._editPopup) || void 0 === _this$_editPopup2 ? void 0 : _this$_editPopup2.option(\"animation\");\r\n                        null === (_this$_editPopup3 = this._editPopup) || void 0 === _this$_editPopup3 ? void 0 : _this$_editPopup3.option(\"animation\", null);\r\n                        this._showEditPopup(rowIndex, true);\r\n                        if (void 0 !== defaultAnimation) {\r\n                            this._editPopup.option(\"animation\", defaultAnimation)\r\n                        }\r\n                    }\r\n                },\r\n                _hideEditPopup: function() {\r\n                    var _this$_editPopup4;\r\n                    null === (_this$_editPopup4 = this._editPopup) || void 0 === _this$_editPopup4 ? void 0 : _this$_editPopup4.option(\"visible\", false)\r\n                },\r\n                optionChanged: function(args) {\r\n                    if (\"editing\" === args.name && this.isFormOrPopupEditMode()) {\r\n                        var fullName = args.fullName;\r\n                        if (0 === fullName.indexOf(EDITING_FORM_OPTION_NAME)) {\r\n                            this._handleFormOptionChange(args);\r\n                            args.handled = true\r\n                        } else if (0 === fullName.indexOf(EDITING_POPUP_OPTION_NAME)) {\r\n                            this._handlePopupOptionChange(args);\r\n                            args.handled = true\r\n                        }\r\n                    }\r\n                    this.callBase.apply(this, arguments)\r\n                },\r\n                _handleFormOptionChange: function(args) {\r\n                    var _this$_editPopup5;\r\n                    if (this.isFormEditMode()) {\r\n                        var editRowIndex = this._getVisibleEditRowIndex();\r\n                        if (editRowIndex >= 0) {\r\n                            this._dataController.updateItems({\r\n                                changeType: \"update\",\r\n                                rowIndices: [editRowIndex]\r\n                            })\r\n                        }\r\n                    } else if (null !== (_this$_editPopup5 = this._editPopup) && void 0 !== _this$_editPopup5 && _this$_editPopup5.option(\"visible\") && 0 === args.fullName.indexOf(EDITING_FORM_OPTION_NAME)) {\r\n                        this._repaintEditPopup()\r\n                    }\r\n                },\r\n                _handlePopupOptionChange: function(args) {\r\n                    var editPopup = this._editPopup;\r\n                    if (editPopup) {\r\n                        var popupOptionName = args.fullName.slice(EDITING_POPUP_OPTION_NAME.length + 1);\r\n                        if (popupOptionName) {\r\n                            editPopup.option(popupOptionName, args.value)\r\n                        } else {\r\n                            editPopup.option(args.value)\r\n                        }\r\n                    }\r\n                },\r\n                renderFormEditTemplate: function(detailCellOptions, item, formTemplateOptions, container, isReadOnly) {\r\n                    var that = this;\r\n                    var $container = $(container);\r\n                    var column = item.column;\r\n                    var editorType = getEditorType(item);\r\n                    var rowData = null === detailCellOptions || void 0 === detailCellOptions ? void 0 : detailCellOptions.row.data;\r\n                    var form = formTemplateOptions.component;\r\n                    var {\r\n                        label: label,\r\n                        labelMark: labelMark,\r\n                        labelMode: labelMode\r\n                    } = formTemplateOptions.editorOptions || {};\r\n                    var cellOptions = extend({}, detailCellOptions, {\r\n                        data: rowData,\r\n                        cellElement: null,\r\n                        isOnForm: true,\r\n                        item: item,\r\n                        id: form.getItemID(item.name || item.dataField),\r\n                        column: extend({}, column, {\r\n                            editorType: editorType,\r\n                            editorOptions: extend({\r\n                                label: label,\r\n                                labelMark: labelMark,\r\n                                labelMode: labelMode\r\n                            }, column.editorOptions, item.editorOptions)\r\n                        }),\r\n                        columnIndex: column.index,\r\n                        setValue: !isReadOnly && column.allowEditing && function(value, text) {\r\n                            that.updateFieldValue(cellOptions, value, text)\r\n                        }\r\n                    });\r\n                    cellOptions.value = column.calculateCellValue(rowData);\r\n                    var template = this._getFormEditItemTemplate.bind(this)(cellOptions, column);\r\n                    this._rowsView.renderTemplate($container, template, cellOptions, !!isElementInDom($container)).done(() => {\r\n                        this._rowsView._updateCell($container, cellOptions)\r\n                    });\r\n                    return cellOptions\r\n                },\r\n                getFormEditorTemplate: function(cellOptions, item) {\r\n                    var column = this.component.columnOption(item.dataField);\r\n                    return (options, container) => {\r\n                        var _cellOptions$row$watc, _cellOptions$row;\r\n                        var $container = $(container);\r\n                        null === (_cellOptions$row$watc = (_cellOptions$row = cellOptions.row).watch) || void 0 === _cellOptions$row$watc ? void 0 : _cellOptions$row$watc.call(_cellOptions$row, (function() {\r\n                            return column.selector(cellOptions.row.data)\r\n                        }), () => {\r\n                            var _validator;\r\n                            var $editorElement = $container.find(\".dx-widget\").first();\r\n                            var validator = $editorElement.data(\"dxValidator\");\r\n                            var validatorOptions = null === (_validator = validator) || void 0 === _validator ? void 0 : _validator.option();\r\n                            $container.contents().remove();\r\n                            cellOptions = this.renderFormEditTemplate.bind(this)(cellOptions, item, options, $container);\r\n                            $editorElement = $container.find(\".dx-widget\").first();\r\n                            validator = $editorElement.data(\"dxValidator\");\r\n                            if (validatorOptions && !validator) {\r\n                                $editorElement.dxValidator({\r\n                                    validationRules: validatorOptions.validationRules,\r\n                                    validationGroup: validatorOptions.validationGroup,\r\n                                    dataGetter: validatorOptions.dataGetter\r\n                                })\r\n                            }\r\n                        });\r\n                        cellOptions = this.renderFormEditTemplate.bind(this)(cellOptions, item, options, $container)\r\n                    }\r\n                },\r\n                getEditFormOptions: function(detailOptions) {\r\n                    var _this$_getValidationG;\r\n                    var editFormOptions = null === (_this$_getValidationG = this._getValidationGroupsInForm) || void 0 === _this$_getValidationG ? void 0 : _this$_getValidationG.call(this, detailOptions);\r\n                    var userCustomizeItem = this.option(\"editing.form.customizeItem\");\r\n                    var editFormItemClass = this.addWidgetPrefix(EDIT_FORM_ITEM_CLASS);\r\n                    var items = this.option(\"editing.form.items\");\r\n                    var isCustomEditorType = {};\r\n                    if (!items) {\r\n                        var columns = this.getController(\"columns\").getColumns();\r\n                        items = [];\r\n                        each(columns, (function(_, column) {\r\n                            if (!column.isBand && !column.type) {\r\n                                items.push({\r\n                                    column: column,\r\n                                    name: column.name,\r\n                                    dataField: column.dataField\r\n                                })\r\n                            }\r\n                        }))\r\n                    } else {\r\n                        forEachFormItems(items, item => {\r\n                            var itemId = (null === item || void 0 === item ? void 0 : item.name) || (null === item || void 0 === item ? void 0 : item.dataField);\r\n                            if (itemId) {\r\n                                isCustomEditorType[itemId] = !!item.editorType\r\n                            }\r\n                        })\r\n                    }\r\n                    return extend({}, editFormOptions, {\r\n                        items: items,\r\n                        formID: \"dx-\" + new Guid,\r\n                        customizeItem: item => {\r\n                            var column;\r\n                            var itemId = item.name || item.dataField;\r\n                            if (item.column || itemId) {\r\n                                column = item.column || this._columnsController.columnOption(item.name ? \"name:\" + item.name : \"dataField:\" + item.dataField)\r\n                            }\r\n                            if (column) {\r\n                                item.label = item.label || {};\r\n                                item.label.text = item.label.text || column.caption;\r\n                                if (\"boolean\" === column.dataType && void 0 === item.label.visible) {\r\n                                    var labelMode = this.option(\"editing.form.labelMode\");\r\n                                    if (\"floating\" === labelMode || \"static\" === labelMode) {\r\n                                        item.label.visible = true\r\n                                    }\r\n                                }\r\n                                item.template = item.template || this.getFormEditorTemplate(detailOptions, item);\r\n                                item.column = column;\r\n                                item.isCustomEditorType = isCustomEditorType[itemId];\r\n                                if (column.formItem) {\r\n                                    extend(item, column.formItem)\r\n                                }\r\n                                if (void 0 === item.isRequired && column.validationRules) {\r\n                                    item.isRequired = column.validationRules.some((function(rule) {\r\n                                        return \"required\" === rule.type\r\n                                    }));\r\n                                    item.validationRules = []\r\n                                }\r\n                                var itemVisible = isDefined(item.visible) ? item.visible : true;\r\n                                if (!this._firstFormItem && itemVisible) {\r\n                                    this._firstFormItem = item\r\n                                }\r\n                            }\r\n                            null === userCustomizeItem || void 0 === userCustomizeItem ? void 0 : userCustomizeItem.call(this, item);\r\n                            item.cssClass = isString(item.cssClass) ? item.cssClass + \" \" + editFormItemClass : editFormItemClass\r\n                        }\r\n                    })\r\n                },\r\n                getEditFormTemplate: function() {\r\n                    return ($container, detailOptions, options) => {\r\n                        var editFormOptions = this.option(EDITING_FORM_OPTION_NAME);\r\n                        var baseEditFormOptions = this.getEditFormOptions(detailOptions);\r\n                        var $formContainer = $(\"<div>\").appendTo($container);\r\n                        var isPopupForm = null === options || void 0 === options ? void 0 : options.isPopupForm;\r\n                        this._firstFormItem = void 0;\r\n                        if (isPopupForm) {\r\n                            $formContainer.addClass(this.addWidgetPrefix(EDIT_POPUP_FORM_CLASS))\r\n                        }\r\n                        this._editForm = this._createComponent($formContainer, Form, extend({}, editFormOptions, baseEditFormOptions));\r\n                        if (!isPopupForm) {\r\n                            var $buttonsContainer = $(\"<div>\").addClass(this.addWidgetPrefix(FORM_BUTTONS_CONTAINER_CLASS)).appendTo($container);\r\n                            this._createComponent($(\"<div>\").appendTo($buttonsContainer), Button, this._getSaveButtonConfig());\r\n                            this._createComponent($(\"<div>\").appendTo($buttonsContainer), Button, this._getCancelButtonConfig())\r\n                        }\r\n                        this._editForm.on(\"contentReady\", () => {\r\n                            var _this$_editPopup6;\r\n                            this._rowsView.renderDelayedTemplates();\r\n                            null === (_this$_editPopup6 = this._editPopup) || void 0 === _this$_editPopup6 ? void 0 : _this$_editPopup6.repaint()\r\n                        })\r\n                    }\r\n                },\r\n                getEditForm: function() {\r\n                    return this._editForm\r\n                },\r\n                _endUpdateCore: function() {\r\n                    var _this$_updateEditForm;\r\n                    null === (_this$_updateEditForm = this._updateEditFormDeferred) || void 0 === _this$_updateEditForm ? void 0 : _this$_updateEditForm.resolve()\r\n                },\r\n                _beforeEndSaving: function() {\r\n                    this.callBase.apply(this, arguments);\r\n                    if (this.isPopupEditMode()) {\r\n                        var _this$_editPopup7;\r\n                        null === (_this$_editPopup7 = this._editPopup) || void 0 === _this$_editPopup7 ? void 0 : _this$_editPopup7.hide()\r\n                    }\r\n                },\r\n                _processDataItemCore: function(item, _ref) {\r\n                    var {\r\n                        type: type\r\n                    } = _ref;\r\n                    if (this.isPopupEditMode() && type === DATA_EDIT_DATA_INSERT_TYPE) {\r\n                        item.visible = false\r\n                    }\r\n                    this.callBase.apply(this, arguments)\r\n                },\r\n                _editRowFromOptionChangedCore: function(rowIndices, rowIndex) {\r\n                    var isPopupEditMode = this.isPopupEditMode();\r\n                    this.callBase(rowIndices, rowIndex, isPopupEditMode);\r\n                    if (isPopupEditMode) {\r\n                        this._showEditPopup(rowIndex)\r\n                    }\r\n                }\r\n            },\r\n            data: {\r\n                _updateEditItem: function(item) {\r\n                    if (this._editingController.isFormEditMode()) {\r\n                        item.rowType = \"detail\"\r\n                    }\r\n                },\r\n                _getChangedColumnIndices: function(oldItem, newItem, visibleRowIndex, isLiveUpdate) {\r\n                    if (false === isLiveUpdate && newItem.isEditing && this._editingController.isFormEditMode()) {\r\n                        return\r\n                    }\r\n                    return this.callBase.apply(this, arguments)\r\n                }\r\n            }\r\n        },\r\n        views: {\r\n            rowsView: {\r\n                _renderCellContent: function($cell, options) {\r\n                    if (\"data\" === options.rowType && this._editingController.isPopupEditMode() && false === options.row.visible) {\r\n                        return\r\n                    }\r\n                    this.callBase.apply(this, arguments)\r\n                },\r\n                getCellElements: function(rowIndex) {\r\n                    var $cellElements = this.callBase(rowIndex);\r\n                    var editingController = this._editingController;\r\n                    var editForm = editingController.getEditForm();\r\n                    var editFormRowIndex = editingController.getEditFormRowIndex();\r\n                    if (editFormRowIndex === rowIndex && $cellElements && editForm) {\r\n                        return editForm.$element().find(\".\" + this.addWidgetPrefix(EDIT_FORM_ITEM_CLASS) + \", .\" + BUTTON_CLASS)\r\n                    }\r\n                    return $cellElements\r\n                },\r\n                _getVisibleColumnIndex: function($cells, rowIndex, columnIdentifier) {\r\n                    var editFormRowIndex = this._editingController.getEditFormRowIndex();\r\n                    if (editFormRowIndex === rowIndex && isString(columnIdentifier)) {\r\n                        var column = this._columnsController.columnOption(columnIdentifier);\r\n                        return this._getEditFormEditorVisibleIndex($cells, column)\r\n                    }\r\n                    return this.callBase.apply(this, arguments)\r\n                },\r\n                _getEditFormEditorVisibleIndex: function($cells, column) {\r\n                    var visibleIndex = -1;\r\n                    each($cells, (function(index, cellElement) {\r\n                        var item = $(cellElement).find(\".dx-field-item-content\").data(\"dx-form-item\");\r\n                        if (null !== item && void 0 !== item && item.column && column && item.column.index === column.index) {\r\n                            visibleIndex = index;\r\n                            return false\r\n                        }\r\n                    }));\r\n                    return visibleIndex\r\n                },\r\n                _isFormItem: function(parameters) {\r\n                    var isDetailRow = \"detail\" === parameters.rowType || \"detailAdaptive\" === parameters.rowType;\r\n                    var isPopupEditing = \"data\" === parameters.rowType && this._editingController.isPopupEditMode();\r\n                    return (isDetailRow || isPopupEditing) && parameters.item\r\n                },\r\n                _updateCell: function($cell, parameters) {\r\n                    if (this._isFormItem(parameters)) {\r\n                        this._formItemPrepared(parameters, $cell)\r\n                    } else {\r\n                        this.callBase($cell, parameters)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}