{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/scheduler/appointments/dataProvider/appointmentDataSource.js)\r\n * Version: 22.2.4\r\n * Build date: Thu Jan 19 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { Deferred } from \"../../../../core/utils/deferred\";\nvar STORE_EVENTS = {\n  updating: \"updating\",\n  push: \"push\"\n};\nexport class AppointmentDataSource {\n  constructor(dataSource) {\n    this.setDataSource(dataSource);\n    this._updatedAppointmentKeys = [];\n  }\n\n  get keyName() {\n    var store = this._dataSource.store();\n\n    return store.key();\n  }\n\n  _getStoreKey(target) {\n    var store = this._dataSource.store();\n\n    return store.keyOf(target);\n  }\n\n  setDataSource(dataSource) {\n    this._dataSource = dataSource;\n    this.cleanState();\n\n    this._initStoreChangeHandlers();\n  }\n\n  _initStoreChangeHandlers() {\n    var dataSource = this._dataSource;\n    var store = null === dataSource || void 0 === dataSource ? void 0 : dataSource.store();\n\n    if (store) {\n      store.on(STORE_EVENTS.updating, key => {\n        var keyName = store.key();\n\n        if (keyName) {\n          this._updatedAppointmentKeys.push({\n            key: keyName,\n            value: key\n          });\n        } else {\n          this._updatedAppointment = key;\n        }\n      });\n      store.on(STORE_EVENTS.push, pushItems => {\n        var items = dataSource.items();\n        var keyName = store.key();\n        pushItems.forEach(pushItem => {\n          var itemExists = 0 !== items.filter(item => item[keyName] === pushItem.key).length;\n\n          if (itemExists) {\n            this._updatedAppointmentKeys.push({\n              key: keyName,\n              value: pushItem.key\n            });\n          } else {\n            var {\n              data: data\n            } = pushItem;\n            data && items.push(data);\n          }\n        });\n        dataSource.load();\n      });\n    }\n  }\n\n  getUpdatedAppointment() {\n    return this._updatedAppointment;\n  }\n\n  getUpdatedAppointmentKeys() {\n    return this._updatedAppointmentKeys;\n  }\n\n  cleanState() {\n    this._updatedAppointment = null;\n    this._updatedAppointmentKeys = [];\n  }\n\n  add(rawAppointment) {\n    return this._dataSource.store().insert(rawAppointment).done(() => this._dataSource.load());\n  }\n\n  update(target, data) {\n    var key = this._getStoreKey(target);\n\n    var d = new Deferred();\n\n    this._dataSource.store().update(key, data).done(result => this._dataSource.load().done(() => d.resolve(result)).fail(d.reject)).fail(d.reject);\n\n    return d.promise();\n  }\n\n  remove(rawAppointment) {\n    var key = this._getStoreKey(rawAppointment);\n\n    return this._dataSource.store().remove(key).done(() => this._dataSource.load());\n  }\n\n  destroy() {\n    var _this$_dataSource;\n\n    var store = null === (_this$_dataSource = this._dataSource) || void 0 === _this$_dataSource ? void 0 : _this$_dataSource.store();\n\n    if (store) {\n      store.off(STORE_EVENTS.updating);\n      store.off(STORE_EVENTS.push);\n    }\n  }\n\n}","map":{"version":3,"names":["Deferred","STORE_EVENTS","updating","push","AppointmentDataSource","constructor","dataSource","setDataSource","_updatedAppointmentKeys","keyName","store","_dataSource","key","_getStoreKey","target","keyOf","cleanState","_initStoreChangeHandlers","on","value","_updatedAppointment","pushItems","items","forEach","pushItem","itemExists","filter","item","length","data","load","getUpdatedAppointment","getUpdatedAppointmentKeys","add","rawAppointment","insert","done","update","d","result","resolve","fail","reject","promise","remove","destroy","_this$_dataSource","off"],"sources":["D:/APPLICATION/UI/UPL/NEW/node_modules/devextreme/esm/ui/scheduler/appointments/dataProvider/appointmentDataSource.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/scheduler/appointments/dataProvider/appointmentDataSource.js)\r\n * Version: 22.2.4\r\n * Build date: Thu Jan 19 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    Deferred\r\n} from \"../../../../core/utils/deferred\";\r\nvar STORE_EVENTS = {\r\n    updating: \"updating\",\r\n    push: \"push\"\r\n};\r\nexport class AppointmentDataSource {\r\n    constructor(dataSource) {\r\n        this.setDataSource(dataSource);\r\n        this._updatedAppointmentKeys = []\r\n    }\r\n    get keyName() {\r\n        var store = this._dataSource.store();\r\n        return store.key()\r\n    }\r\n    _getStoreKey(target) {\r\n        var store = this._dataSource.store();\r\n        return store.keyOf(target)\r\n    }\r\n    setDataSource(dataSource) {\r\n        this._dataSource = dataSource;\r\n        this.cleanState();\r\n        this._initStoreChangeHandlers()\r\n    }\r\n    _initStoreChangeHandlers() {\r\n        var dataSource = this._dataSource;\r\n        var store = null === dataSource || void 0 === dataSource ? void 0 : dataSource.store();\r\n        if (store) {\r\n            store.on(STORE_EVENTS.updating, key => {\r\n                var keyName = store.key();\r\n                if (keyName) {\r\n                    this._updatedAppointmentKeys.push({\r\n                        key: keyName,\r\n                        value: key\r\n                    })\r\n                } else {\r\n                    this._updatedAppointment = key\r\n                }\r\n            });\r\n            store.on(STORE_EVENTS.push, pushItems => {\r\n                var items = dataSource.items();\r\n                var keyName = store.key();\r\n                pushItems.forEach(pushItem => {\r\n                    var itemExists = 0 !== items.filter(item => item[keyName] === pushItem.key).length;\r\n                    if (itemExists) {\r\n                        this._updatedAppointmentKeys.push({\r\n                            key: keyName,\r\n                            value: pushItem.key\r\n                        })\r\n                    } else {\r\n                        var {\r\n                            data: data\r\n                        } = pushItem;\r\n                        data && items.push(data)\r\n                    }\r\n                });\r\n                dataSource.load()\r\n            })\r\n        }\r\n    }\r\n    getUpdatedAppointment() {\r\n        return this._updatedAppointment\r\n    }\r\n    getUpdatedAppointmentKeys() {\r\n        return this._updatedAppointmentKeys\r\n    }\r\n    cleanState() {\r\n        this._updatedAppointment = null;\r\n        this._updatedAppointmentKeys = []\r\n    }\r\n    add(rawAppointment) {\r\n        return this._dataSource.store().insert(rawAppointment).done(() => this._dataSource.load())\r\n    }\r\n    update(target, data) {\r\n        var key = this._getStoreKey(target);\r\n        var d = new Deferred;\r\n        this._dataSource.store().update(key, data).done(result => this._dataSource.load().done(() => d.resolve(result)).fail(d.reject)).fail(d.reject);\r\n        return d.promise()\r\n    }\r\n    remove(rawAppointment) {\r\n        var key = this._getStoreKey(rawAppointment);\r\n        return this._dataSource.store().remove(key).done(() => this._dataSource.load())\r\n    }\r\n    destroy() {\r\n        var _this$_dataSource;\r\n        var store = null === (_this$_dataSource = this._dataSource) || void 0 === _this$_dataSource ? void 0 : _this$_dataSource.store();\r\n        if (store) {\r\n            store.off(STORE_EVENTS.updating);\r\n            store.off(STORE_EVENTS.push)\r\n        }\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}