{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/grid_core/ui.grid_core.keyboard_navigation.js)\r\n * Version: 22.2.4\r\n * Build date: Thu Jan 19 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { getOuterHeight, getHeight, getWidth, getOuterWidth } from \"../../core/utils/size\";\nimport $ from \"../../core/renderer\";\nimport domAdapter from \"../../core/dom_adapter\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport core from \"./ui.grid_core.modules\";\nimport gridCoreUtils from \"./ui.grid_core.utils\";\nimport { isDefined, isEmptyObject } from \"../../core/utils/type\";\nimport { focused } from \"../widget/selectors\";\nimport { addNamespace, createEvent, isCommandKeyPressed } from \"../../events/utils/index\";\nimport pointerEvents from \"../../events/pointer\";\nimport { name as clickEventName } from \"../../events/click\";\nimport { noop } from \"../../core/utils/common\";\nimport * as accessibility from \"../shared/accessibility\";\nimport browser from \"../../core/utils/browser\";\nimport { keyboard } from \"../../events/short\";\nimport devices from \"../../core/devices\";\nvar ROWS_VIEW_CLASS = \"rowsview\";\nvar EDIT_FORM_CLASS = \"edit-form\";\nvar GROUP_FOOTER_CLASS = \"group-footer\";\nvar ROW_CLASS = \"dx-row\";\nvar DATA_ROW_CLASS = \"dx-data-row\";\nvar GROUP_ROW_CLASS = \"dx-group-row\";\nvar HEADER_ROW_CLASS = \"dx-header-row\";\nvar EDIT_FORM_ITEM_CLASS = \"edit-form-item\";\nvar MASTER_DETAIL_ROW_CLASS = \"dx-master-detail-row\";\nvar FREESPACE_ROW_CLASS = \"dx-freespace-row\";\nvar VIRTUAL_ROW_CLASS = \"dx-virtual-row\";\nvar MASTER_DETAIL_CELL_CLASS = \"dx-master-detail-cell\";\nvar EDITOR_CELL_CLASS = \"dx-editor-cell\";\nvar DROPDOWN_EDITOR_OVERLAY_CLASS = \"dx-dropdowneditor-overlay\";\nvar COMMAND_EXPAND_CLASS = \"dx-command-expand\";\nvar COMMAND_SELECT_CLASS = \"dx-command-select\";\nvar COMMAND_EDIT_CLASS = \"dx-command-edit\";\nvar COMMAND_CELL_SELECTOR = \"[class^=dx-command]\";\nvar CELL_FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\nvar DATEBOX_WIDGET_NAME = \"dxDateBox\";\nvar FOCUS_STATE_CLASS = \"dx-state-focused\";\nvar WIDGET_CLASS = \"dx-widget\";\nvar REVERT_BUTTON_CLASS = \"dx-revert-button\";\nvar FAST_EDITING_DELETE_KEY = \"delete\";\nvar INTERACTIVE_ELEMENTS_SELECTOR = \"input:not([type='hidden']), textarea, a, select, button, [tabindex], .dx-checkbox\";\nvar NON_FOCUSABLE_ELEMENTS_SELECTOR = \"\".concat(INTERACTIVE_ELEMENTS_SELECTOR, \", .dx-dropdowneditor-icon\");\nvar EDIT_MODE_ROW = \"row\";\nvar EDIT_MODE_FORM = \"form\";\nvar EDIT_MODE_BATCH = \"batch\";\nvar EDIT_MODE_CELL = \"cell\";\nvar FOCUS_TYPE_ROW = \"row\";\nvar FOCUS_TYPE_CELL = \"cell\";\nvar COLUMN_HEADERS_VIEW = \"columnHeadersView\";\nvar FUNCTIONAL_KEYS = [\"shift\", \"control\", \"alt\"];\n\nfunction isGroupRow($row) {\n  return $row && $row.hasClass(GROUP_ROW_CLASS);\n}\n\nfunction isDetailRow($row) {\n  return $row && $row.hasClass(MASTER_DETAIL_ROW_CLASS);\n}\n\nfunction isDataRow($row) {\n  return $row && !isGroupRow($row) && !isDetailRow($row);\n}\n\nfunction isNotFocusedRow($row) {\n  return !$row || $row.hasClass(FREESPACE_ROW_CLASS) || $row.hasClass(VIRTUAL_ROW_CLASS);\n}\n\nfunction isEditorCell(that, $cell) {\n  return !that._isRowEditMode() && $cell && !$cell.hasClass(COMMAND_SELECT_CLASS) && $cell.hasClass(EDITOR_CELL_CLASS);\n}\n\nfunction isElementDefined($element) {\n  return isDefined($element) && $element.length > 0;\n}\n\nfunction isMobile() {\n  return \"desktop\" !== devices.current().deviceType;\n}\n\nfunction isCellInHeaderRow($cell) {\n  return !!$cell.parent(\".\".concat(HEADER_ROW_CLASS)).length;\n}\n\nfunction isFixedColumnIndexOffsetRequired(that, column) {\n  var rtlEnabled = that.option(\"rtlEnabled\");\n  var result = false;\n\n  if (rtlEnabled) {\n    result = !(\"right\" === column.fixedPosition || isDefined(column.command) && !isDefined(column.fixedPosition));\n  } else {\n    result = !(!isDefined(column.fixedPosition) || \"left\" === column.fixedPosition);\n  }\n\n  return result;\n}\n\nfunction shouldPreventScroll(that) {\n  var keyboardController = that.getController(\"keyboardNavigation\");\n  return keyboardController._isVirtualScrolling() ? that.option(\"focusedRowIndex\") === keyboardController.getRowIndex() : false;\n}\n\nvar keyboardNavigationMembers = {\n  init: function () {\n    this._dataController = this.getController(\"data\");\n    this._selectionController = this.getController(\"selection\");\n    this._editingController = this.getController(\"editing\");\n    this._headerPanel = this.getView(\"headerPanel\");\n    this._columnsController = this.getController(\"columns\");\n    this._editorFactory = this.getController(\"editorFactory\");\n\n    if (this.isKeyboardEnabled()) {\n      accessibility.subscribeVisibilityChange();\n      this._updateFocusTimeout = null;\n      this._fastEditingStarted = false;\n      this._focusedCellPosition = {};\n      this._canceledCellPosition = null;\n\n      this._editorFactory.focused.add($element => {\n        this.setupFocusedView();\n\n        if (this._isNeedScroll) {\n          if ($element.is(\":visible\") && this._focusedView && this._focusedView.getScrollable) {\n            this._focusedView._scrollToElement($element);\n\n            this._isNeedScroll = false;\n          }\n        }\n      });\n\n      this._initViewHandlers();\n\n      this._initDocumentHandlers();\n\n      this.createAction(\"onKeyDown\");\n    }\n  },\n  _initViewHandlers: function () {\n    var rowsView = this.getView(\"rowsView\");\n\n    var rowsViewFocusHandler = event => {\n      var $element = $(event.target);\n      var isRelatedTargetInRowsView = $(event.relatedTarget).closest(rowsView.element()).length;\n      var isLink = $element.is(\"a\");\n\n      if (event.relatedTarget && isLink && !isRelatedTargetInRowsView && this._isEventInCurrentGrid(event)) {\n        var $focusedCell = this._getFocusedCell();\n\n        $focusedCell = !isElementDefined($focusedCell) ? rowsView.getCellElements(0).filter(\"[tabindex]\").eq(0) : $focusedCell;\n\n        if (!$element.closest($focusedCell).length) {\n          event.preventDefault();\n          eventsEngine.trigger($focusedCell, \"focus\");\n        }\n      }\n    };\n\n    rowsView.renderCompleted.add(e => {\n      var $rowsView = rowsView.element();\n      var isFullUpdate = !e || \"refresh\" === e.changeType;\n      var isFocusedViewCorrect = this._focusedView && this._focusedView.name === rowsView.name;\n      var needUpdateFocus = false;\n      var isAppend = e && (\"append\" === e.changeType || \"prepend\" === e.changeType);\n      var root = $(domAdapter.getRootNode($rowsView.get && $rowsView.get(0)));\n      var $focusedElement = root.find(\":focus\");\n      var isFocusedElementCorrect = !$focusedElement.length || $focusedElement.closest($rowsView).length;\n      eventsEngine.off($rowsView, \"focusin\", rowsViewFocusHandler);\n      eventsEngine.on($rowsView, \"focusin\", rowsViewFocusHandler);\n\n      this._initPointerEventHandler();\n\n      this._initKeyDownHandler();\n\n      this._setRowsViewAttributes();\n\n      if (isFocusedViewCorrect && isFocusedElementCorrect) {\n        needUpdateFocus = this._isNeedFocus ? !isAppend : this._isHiddenFocus && isFullUpdate && !(null !== e && void 0 !== e && e.virtualColumnsScrolling);\n        needUpdateFocus && this._updateFocus(true);\n      }\n    });\n  },\n  _initDocumentHandlers: function () {\n    var document = domAdapter.getDocument();\n    this._documentClickHandler = this.createAction(e => {\n      var $target = $(e.event.target);\n      var isCurrentRowsViewClick = this._isEventInCurrentGrid(e.event) && $target.closest(\".\".concat(this.addWidgetPrefix(ROWS_VIEW_CLASS))).length;\n      var isEditorOverlay = $target.closest(\".\".concat(DROPDOWN_EDITOR_OVERLAY_CLASS)).length;\n      var columnsResizerController = this.getController(\"columnsResizer\");\n      var isColumnResizing = !!columnsResizerController && columnsResizerController.isResizing();\n\n      if (!isCurrentRowsViewClick && !isEditorOverlay && !isColumnResizing) {\n        var targetInsideFocusedView = this._focusedView ? $target.parents().filter(this._focusedView.element()).length > 0 : false;\n        !targetInsideFocusedView && this._resetFocusedCell(true);\n\n        this._resetFocusedView();\n      }\n    });\n    eventsEngine.on(document, addNamespace(pointerEvents.down, \"dxDataGridKeyboardNavigation\"), this._documentClickHandler);\n  },\n  _setRowsViewAttributes: function () {\n    var $rowsView = this._getRowsViewElement();\n\n    var isGridEmpty = !this._dataController.getVisibleRows().length;\n\n    if (isGridEmpty) {\n      this._applyTabIndexToElement($rowsView);\n    }\n  },\n  _initPointerEventHandler: function () {\n    var pointerEventName = !isMobile() ? pointerEvents.down : clickEventName;\n    var clickSelector = \".\".concat(ROW_CLASS, \" > td, .\").concat(ROW_CLASS);\n\n    var $rowsView = this._getRowsViewElement();\n\n    if (!isDefined(this._pointerEventAction)) {\n      this._pointerEventAction = this.createAction(this._pointerEventHandler);\n    }\n\n    eventsEngine.off($rowsView, addNamespace(pointerEventName, \"dxDataGridKeyboardNavigation\"), this._pointerEventAction);\n    eventsEngine.on($rowsView, addNamespace(pointerEventName, \"dxDataGridKeyboardNavigation\"), clickSelector, this._pointerEventAction);\n  },\n  _initKeyDownHandler: function () {\n    var $rowsView = this._getRowsViewElement();\n\n    keyboard.off(this._keyDownListener);\n    this._keyDownListener = keyboard.on($rowsView, null, e => this._keyDownHandler(e));\n  },\n  dispose: function () {\n    this.callBase();\n\n    this._resetFocusedView();\n\n    keyboard.off(this._keyDownListener);\n    eventsEngine.off(domAdapter.getDocument(), addNamespace(pointerEvents.down, \"dxDataGridKeyboardNavigation\"), this._documentClickHandler);\n    clearTimeout(this._updateFocusTimeout);\n    accessibility.unsubscribeVisibilityChange();\n  },\n  optionChanged: function (args) {\n    switch (args.name) {\n      case \"keyboardNavigation\":\n      case \"useLegacyKeyboardNavigation\":\n        args.handled = true;\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  isRowFocusType: function () {\n    return this.focusType === FOCUS_TYPE_ROW;\n  },\n  isCellFocusType: function () {\n    return this.focusType === FOCUS_TYPE_CELL;\n  },\n  setRowFocusType: function () {\n    if (this.option(\"focusedRowEnabled\")) {\n      this.focusType = FOCUS_TYPE_ROW;\n    }\n  },\n  setCellFocusType: function () {\n    this.focusType = FOCUS_TYPE_CELL;\n  },\n  _keyDownHandler: function (e) {\n    var _this$_editingControl;\n\n    var needStopPropagation = true;\n    this._isNeedFocus = true;\n    this._isNeedScroll = true;\n\n    var isHandled = this._processOnKeyDown(e);\n\n    var isEditing = null === (_this$_editingControl = this._editingController) || void 0 === _this$_editingControl ? void 0 : _this$_editingControl.isEditing();\n    var originalEvent = e.originalEvent;\n\n    if (originalEvent.isDefaultPrevented()) {\n      this._isNeedFocus = false;\n      this._isNeedScroll = false;\n      return;\n    }\n\n    FUNCTIONAL_KEYS.indexOf(e.keyName) < 0 && this._updateFocusedCellPositionByTarget(originalEvent.target);\n\n    if (!isHandled) {\n      switch (e.keyName) {\n        case \"leftArrow\":\n        case \"rightArrow\":\n          this._leftRightKeysHandler(e, isEditing);\n\n          isHandled = true;\n          break;\n\n        case \"upArrow\":\n        case \"downArrow\":\n          if (e.ctrl) {\n            accessibility.selectView(\"rowsView\", this, originalEvent);\n          } else {\n            this._upDownKeysHandler(e, isEditing);\n          }\n\n          isHandled = true;\n          break;\n\n        case \"pageUp\":\n        case \"pageDown\":\n          this._pageUpDownKeyHandler(e);\n\n          isHandled = true;\n          break;\n\n        case \"space\":\n          isHandled = this._spaceKeyHandler(e, isEditing);\n          break;\n\n        case \"A\":\n          if (isCommandKeyPressed(e.originalEvent)) {\n            this._ctrlAKeyHandler(e, isEditing);\n\n            isHandled = true;\n          } else {\n            isHandled = this._beginFastEditing(e.originalEvent);\n          }\n\n          break;\n\n        case \"tab\":\n          this._tabKeyHandler(e, isEditing);\n\n          isHandled = true;\n          break;\n\n        case \"enter\":\n          this._enterKeyHandler(e, isEditing);\n\n          isHandled = true;\n          break;\n\n        case \"escape\":\n          this._escapeKeyHandler(e, isEditing);\n\n          isHandled = true;\n          break;\n\n        case \"F\":\n          if (isCommandKeyPressed(e.originalEvent)) {\n            this._ctrlFKeyHandler(e);\n\n            isHandled = true;\n          } else {\n            isHandled = this._beginFastEditing(e.originalEvent);\n          }\n\n          break;\n\n        case \"F2\":\n          this._f2KeyHandler();\n\n          isHandled = true;\n          break;\n\n        case \"del\":\n        case \"backspace\":\n          if (this._isFastEditingAllowed() && !this._isFastEditingStarted()) {\n            isHandled = this._beginFastEditing(originalEvent, true);\n          }\n\n      }\n\n      if (!isHandled && !this._beginFastEditing(originalEvent)) {\n        this._isNeedFocus = false;\n        this._isNeedScroll = false;\n        needStopPropagation = false;\n      }\n\n      if (needStopPropagation) {\n        originalEvent.stopPropagation();\n      }\n    }\n  },\n  _processOnKeyDown: function (eventArgs) {\n    var originalEvent = eventArgs.originalEvent;\n    var args = {\n      handled: false,\n      event: originalEvent\n    };\n    this.executeAction(\"onKeyDown\", args);\n    eventArgs.ctrl = originalEvent.ctrlKey;\n    eventArgs.alt = originalEvent.altKey;\n    eventArgs.shift = originalEvent.shiftKey;\n    return !!args.handled;\n  },\n  _closeEditCell: function () {\n    setTimeout(() => {\n      this._editingController.closeEditCell();\n    });\n  },\n  _leftRightKeysHandler: function (eventArgs, isEditing) {\n    var rowIndex = this.getVisibleRowIndex();\n    var $event = eventArgs.originalEvent;\n\n    var $row = this._focusedView && this._focusedView.getRow(rowIndex);\n\n    var directionCode = this._getDirectionCodeByKey(eventArgs.keyName);\n\n    var isEditingNavigationMode = this._isFastEditingStarted();\n\n    var allowNavigate = (!isEditing || isEditingNavigationMode) && isDataRow($row);\n\n    if (allowNavigate) {\n      this.setCellFocusType();\n      isEditingNavigationMode && this._closeEditCell();\n\n      if (this._isVirtualColumnRender()) {\n        this._processVirtualHorizontalPosition(directionCode);\n      }\n\n      var $cell = this._getNextCell(directionCode);\n\n      if (isElementDefined($cell)) {\n        this._arrowKeysHandlerFocusCell($event, $cell, directionCode);\n      }\n\n      $event && $event.preventDefault();\n    }\n  },\n  _upDownKeysHandler: function (eventArgs, isEditing) {\n    var _this$_editingControl2, _this$_editingControl3;\n\n    var visibleRowIndex = this.getVisibleRowIndex();\n\n    var $row = this._focusedView && this._focusedView.getRow(visibleRowIndex);\n\n    var $event = eventArgs.originalEvent;\n    var isUpArrow = \"upArrow\" === eventArgs.keyName;\n\n    var dataSource = this._dataController.dataSource();\n\n    var isRowEditingInCurrentRow = null === (_this$_editingControl2 = this._editingController) || void 0 === _this$_editingControl2 ? void 0 : null === (_this$_editingControl3 = _this$_editingControl2.isEditRowByIndex) || void 0 === _this$_editingControl3 ? void 0 : _this$_editingControl3.call(_this$_editingControl2, visibleRowIndex);\n\n    var isEditingNavigationMode = this._isFastEditingStarted();\n\n    var allowNavigate = (!isRowEditingInCurrentRow || !isEditing || isEditingNavigationMode) && $row && !isDetailRow($row);\n\n    if (allowNavigate) {\n      isEditingNavigationMode && this._closeEditCell();\n\n      if (!this._navigateNextCell($event, eventArgs.keyName)) {\n        if (this._isVirtualRowRender() && isUpArrow && dataSource && !dataSource.isLoading()) {\n          var rowHeight = getOuterHeight($row);\n          var rowIndex = this._focusedCellPosition.rowIndex - 1;\n\n          this._scrollBy(0, -rowHeight, rowIndex, $event);\n        }\n      }\n\n      $event && $event.preventDefault();\n    }\n  },\n  _pageUpDownKeyHandler: function (eventArgs) {\n    var pageIndex = this._dataController.pageIndex();\n\n    var pageCount = this._dataController.pageCount();\n\n    var pagingEnabled = this.option(\"paging.enabled\");\n    var isPageUp = \"pageUp\" === eventArgs.keyName;\n    var pageStep = isPageUp ? -1 : 1;\n    var scrollable = this.getView(\"rowsView\").getScrollable();\n\n    if (pagingEnabled && !this._isVirtualScrolling()) {\n      if ((isPageUp ? pageIndex > 0 : pageIndex < pageCount - 1) && !this._isVirtualScrolling()) {\n        this._dataController.pageIndex(pageIndex + pageStep);\n\n        eventArgs.originalEvent.preventDefault();\n      }\n    } else if (scrollable && getHeight(scrollable.container()) < getHeight(scrollable.$content())) {\n      this._scrollBy(0, getHeight(scrollable.container()) * pageStep);\n\n      eventArgs.originalEvent.preventDefault();\n    }\n  },\n  _spaceKeyHandler: function (eventArgs, isEditing) {\n    var rowIndex = this.getVisibleRowIndex();\n    var $target = $(eventArgs.originalEvent && eventArgs.originalEvent.target);\n\n    if (this.option(\"selection\") && \"none\" !== this.option(\"selection\").mode && !isEditing) {\n      var isFocusedRowElement = \"row\" === this._getElementType($target) && this.isRowFocusType() && isDataRow($target);\n      var isFocusedSelectionCell = $target.hasClass(COMMAND_SELECT_CLASS);\n\n      if (isFocusedSelectionCell && \"onClick\" === this.option(\"selection.showCheckBoxesMode\")) {\n        this._selectionController.startSelectionWithCheckboxes();\n      }\n\n      if (isFocusedRowElement || $target.parent().hasClass(DATA_ROW_CLASS) || $target.hasClass(this.addWidgetPrefix(ROWS_VIEW_CLASS))) {\n        this._selectionController.changeItemSelection(rowIndex, {\n          shift: eventArgs.shift,\n          control: eventArgs.ctrl\n        });\n\n        eventArgs.originalEvent.preventDefault();\n        return true;\n      }\n\n      return false;\n    } else {\n      return this._beginFastEditing(eventArgs.originalEvent);\n    }\n  },\n  _ctrlAKeyHandler: function (eventArgs, isEditing) {\n    if (!isEditing && !eventArgs.alt && \"multiple\" === this.option(\"selection.mode\") && this.option(\"selection.allowSelectAll\")) {\n      this._selectionController.selectAll();\n\n      eventArgs.originalEvent.preventDefault();\n    }\n  },\n  _tabKeyHandler: function (eventArgs, isEditing) {\n    var editingOptions = this.option(\"editing\");\n    var direction = eventArgs.shift ? \"previous\" : \"next\";\n    var isCellPositionDefined = isDefined(this._focusedCellPosition) && !isEmptyObject(this._focusedCellPosition);\n\n    var isOriginalHandlerRequired = !isCellPositionDefined || !eventArgs.shift && this._isLastValidCell(this._focusedCellPosition) || eventArgs.shift && this._isFirstValidCell(this._focusedCellPosition);\n\n    var eventTarget = eventArgs.originalEvent.target;\n\n    var focusedViewElement = this._focusedView && this._focusedView.element();\n\n    if (this._handleTabKeyOnMasterDetailCell(eventTarget, direction)) {\n      return;\n    }\n\n    $(focusedViewElement).addClass(FOCUS_STATE_CLASS);\n\n    if (editingOptions && eventTarget && !isOriginalHandlerRequired) {\n      if ($(eventTarget).hasClass(this.addWidgetPrefix(ROWS_VIEW_CLASS))) {\n        this._resetFocusedCell();\n      }\n\n      if (this._isVirtualColumnRender()) {\n        this._processVirtualHorizontalPosition(direction);\n      }\n\n      if (isEditing) {\n        if (!this._editingCellTabHandler(eventArgs, direction)) {\n          return;\n        }\n      } else if (this._targetCellTabHandler(eventArgs, direction)) {\n        isOriginalHandlerRequired = true;\n      }\n    }\n\n    if (isOriginalHandlerRequired) {\n      this._editorFactory.loseFocus();\n\n      if (this._editingController.isEditing() && !this._isRowEditMode()) {\n        this._resetFocusedCell(true);\n\n        this._resetFocusedView();\n\n        this._closeEditCell();\n      }\n    } else {\n      eventArgs.originalEvent.preventDefault();\n    }\n  },\n  _getMaxHorizontalOffset: function () {\n    var scrollable = this.component.getScrollable();\n    var rowsView = this.getView(\"rowsView\");\n    var offset = scrollable ? scrollable.scrollWidth() - getWidth(rowsView.element()) : 0;\n    return offset;\n  },\n  _isColumnRendered: function (columnIndex) {\n    var allVisibleColumns = this._columnsController.getVisibleColumns(null, true);\n\n    var renderedVisibleColumns = this._columnsController.getVisibleColumns();\n\n    var column = allVisibleColumns[columnIndex];\n    var result = false;\n\n    if (column) {\n      result = renderedVisibleColumns.indexOf(column) >= 0;\n    }\n\n    return result;\n  },\n  _isFixedColumn: function (columnIndex) {\n    var allVisibleColumns = this._columnsController.getVisibleColumns(null, true);\n\n    var column = allVisibleColumns[columnIndex];\n    return !!column && !!column.fixed;\n  },\n  _isColumnVirtual: function (columnIndex) {\n    var localColumnIndex = columnIndex - this._columnsController.getColumnIndexOffset();\n\n    var visibleColumns = this._columnsController.getVisibleColumns();\n\n    var column = visibleColumns[localColumnIndex];\n    return !!column && \"virtual\" === column.command;\n  },\n  _processVirtualHorizontalPosition: function (direction) {\n    var scrollable = this.component.getScrollable();\n    var columnIndex = this.getColumnIndex();\n    var nextColumnIndex;\n    var horizontalScrollPosition = 0;\n    var needToScroll = false;\n\n    switch (direction) {\n      case \"next\":\n      case \"nextInRow\":\n        var columnsCount = this._getVisibleColumnCount();\n\n        nextColumnIndex = columnIndex + 1;\n        horizontalScrollPosition = this.option(\"rtlEnabled\") ? this._getMaxHorizontalOffset() : 0;\n\n        if (\"next\" === direction) {\n          needToScroll = columnsCount === nextColumnIndex || this._isFixedColumn(columnIndex) && !this._isColumnRendered(nextColumnIndex);\n        } else {\n          needToScroll = columnsCount > nextColumnIndex && this._isFixedColumn(columnIndex) && !this._isColumnRendered(nextColumnIndex);\n        }\n\n        break;\n\n      case \"previous\":\n      case \"previousInRow\":\n        nextColumnIndex = columnIndex - 1;\n        horizontalScrollPosition = this.option(\"rtlEnabled\") ? 0 : this._getMaxHorizontalOffset();\n\n        if (\"previous\" === direction) {\n          var columnIndexOffset = this._columnsController.getColumnIndexOffset();\n\n          var leftEdgePosition = nextColumnIndex < 0 && 0 === columnIndexOffset;\n          needToScroll = leftEdgePosition || this._isFixedColumn(columnIndex) && !this._isColumnRendered(nextColumnIndex);\n        } else {\n          needToScroll = nextColumnIndex >= 0 && this._isFixedColumn(columnIndex) && !this._isColumnRendered(nextColumnIndex);\n        }\n\n    }\n\n    if (needToScroll) {\n      scrollable.scrollTo({\n        left: horizontalScrollPosition\n      });\n    } else if (isDefined(nextColumnIndex) && isDefined(direction) && this._isColumnVirtual(nextColumnIndex)) {\n      horizontalScrollPosition = this._getHorizontalScrollPositionOffset(direction);\n      0 !== horizontalScrollPosition && scrollable.scrollBy({\n        left: horizontalScrollPosition,\n        top: 0\n      });\n    }\n  },\n  _getHorizontalScrollPositionOffset: function (direction) {\n    var positionOffset = 0;\n\n    var $currentCell = this._getCell(this._focusedCellPosition);\n\n    var currentCellWidth = $currentCell && getOuterWidth($currentCell);\n\n    if (currentCellWidth > 0) {\n      var rtlMultiplier = this.option(\"rtlEnabled\") ? -1 : 1;\n      positionOffset = \"nextInRow\" === direction || \"next\" === direction ? currentCellWidth * rtlMultiplier : currentCellWidth * rtlMultiplier * -1;\n    }\n\n    return positionOffset;\n  },\n  _editingCellTabHandler: function (eventArgs, direction) {\n    var eventTarget = eventArgs.originalEvent.target;\n\n    var $cell = this._getCellElementFromTarget(eventTarget);\n\n    var isEditingAllowed;\n    var $event = eventArgs.originalEvent;\n\n    var elementType = this._getElementType(eventTarget);\n\n    if ($cell.is(COMMAND_CELL_SELECTOR)) {\n      return !this._targetCellTabHandler(eventArgs, direction);\n    }\n\n    this._updateFocusedCellPosition($cell);\n\n    var nextCellInfo = this._getNextCellByTabKey($event, direction, elementType);\n\n    $cell = nextCellInfo.$cell;\n\n    if (!$cell || this._handleTabKeyOnMasterDetailCell($cell, direction)) {\n      return false;\n    }\n\n    var columnsController = this._columnsController;\n    var cellIndex = this.getView(\"rowsView\").getCellIndex($cell);\n    var columnIndex = cellIndex + columnsController.getColumnIndexOffset();\n    var column = columnsController.getVisibleColumns(null, true)[columnIndex];\n    var $row = $cell.parent();\n\n    var rowIndex = this._getRowIndex($row);\n\n    var row = this._dataController.items()[rowIndex];\n\n    var editingController = this._editingController;\n\n    if (column && column.allowEditing) {\n      var _isDataRow = !row || \"data\" === row.rowType;\n\n      isEditingAllowed = editingController.allowUpdating({\n        row: row\n      }) ? _isDataRow : row && row.isNewRow;\n    }\n\n    if (!isEditingAllowed) {\n      this._closeEditCell();\n    }\n\n    if (this._focusCell($cell, !nextCellInfo.isHighlighted)) {\n      if (!this._isRowEditMode() && isEditingAllowed) {\n        this._editFocusedCell();\n      } else {\n        this._focusInteractiveElement($cell, eventArgs.shift);\n      }\n    }\n\n    return true;\n  },\n  _targetCellTabHandler: function (eventArgs, direction) {\n    var $event = eventArgs.originalEvent;\n    var eventTarget = $event.target;\n\n    var $cell = this._getCellElementFromTarget(eventTarget);\n\n    var $lastInteractiveElement = this._getInteractiveElement($cell, !eventArgs.shift);\n\n    var isOriginalHandlerRequired = false;\n    var elementType;\n\n    if (!isEditorCell(this, $cell) && $lastInteractiveElement.length && eventTarget !== $lastInteractiveElement.get(0)) {\n      isOriginalHandlerRequired = true;\n    } else {\n      if (void 0 === this._focusedCellPosition.rowIndex && $(eventTarget).hasClass(ROW_CLASS)) {\n        this._updateFocusedCellPosition($cell);\n      }\n\n      elementType = this._getElementType(eventTarget);\n\n      if (this.isRowFocusType()) {\n        this.setCellFocusType();\n\n        if (\"row\" === elementType && isDataRow($(eventTarget))) {\n          eventTarget = this.getFirstValidCellInRow($(eventTarget));\n          elementType = this._getElementType(eventTarget);\n        }\n      }\n\n      var nextCellInfo = this._getNextCellByTabKey($event, direction, elementType);\n\n      $cell = nextCellInfo.$cell;\n\n      if (!$cell) {\n        return false;\n      }\n\n      $cell = this._checkNewLineTransition($event, $cell);\n\n      if (!$cell) {\n        return false;\n      }\n\n      this._focusCell($cell, !nextCellInfo.isHighlighted);\n\n      if (!isEditorCell(this, $cell)) {\n        this._focusInteractiveElement($cell, eventArgs.shift);\n      }\n    }\n\n    return isOriginalHandlerRequired;\n  },\n  _getNextCellByTabKey: function ($event, direction, elementType) {\n    var $cell = this._getNextCell(direction, elementType);\n\n    var args = $cell && this._fireFocusedCellChanging($event, $cell, true);\n\n    if (!args || args.cancel) {\n      return {};\n    }\n\n    if (args.$newCellElement) {\n      $cell = args.$newCellElement;\n    }\n\n    return {\n      $cell: $cell,\n      isHighlighted: args.isHighlighted\n    };\n  },\n  _checkNewLineTransition: function ($event, $cell) {\n    var rowIndex = this.getVisibleRowIndex();\n    var $row = $cell.parent();\n\n    if (rowIndex !== this._getRowIndex($row)) {\n      var cellPosition = this._getCellPosition($cell);\n\n      var args = this._fireFocusedRowChanging($event, $row);\n\n      if (args.cancel) {\n        return;\n      }\n\n      if (args.rowIndexChanged) {\n        this.setFocusedColumnIndex(cellPosition.columnIndex);\n        $cell = this._getFocusedCell();\n      }\n    }\n\n    return $cell;\n  },\n  _enterKeyHandler: function (eventArgs, isEditing) {\n    var $cell = this._getFocusedCell();\n\n    var rowIndex = this.getVisibleRowIndex();\n\n    var $row = this._focusedView && this._focusedView.getRow(rowIndex);\n\n    if (this.option(\"grouping.allowCollapsing\") && isGroupRow($row) || this.option(\"masterDetail.enabled\") && $cell && $cell.hasClass(COMMAND_EXPAND_CLASS)) {\n      var key = this._dataController.getKeyByRowIndex(rowIndex);\n\n      var item = this._dataController.items()[rowIndex];\n\n      if (void 0 !== key && item && item.data && !item.data.isContinuation) {\n        this._dataController.changeRowExpand(key);\n      }\n    } else {\n      this._processEnterKeyForDataCell(eventArgs, isEditing);\n    }\n  },\n  _processEnterKeyForDataCell: function (eventArgs, isEditing) {\n    var direction = this._getEnterKeyDirection(eventArgs);\n\n    var allowEditingOnEnterKey = this._allowEditingOnEnterKey();\n\n    if (isEditing || !allowEditingOnEnterKey && direction) {\n      this._handleEnterKeyEditingCell(eventArgs.originalEvent);\n\n      if (\"next\" === direction || \"previous\" === direction) {\n        this._targetCellTabHandler(eventArgs, direction);\n      } else if (\"upArrow\" === direction || \"downArrow\" === direction) {\n        this._navigateNextCell(eventArgs.originalEvent, direction);\n      }\n    } else if (allowEditingOnEnterKey) {\n      this._startEditing(eventArgs);\n    }\n  },\n  _getEnterKeyDirection: function (eventArgs) {\n    var enterKeyDirection = this.option(\"keyboardNavigation.enterKeyDirection\");\n    var isShift = eventArgs.shift;\n\n    if (\"column\" === enterKeyDirection) {\n      return isShift ? \"upArrow\" : \"downArrow\";\n    }\n\n    if (\"row\" === enterKeyDirection) {\n      return isShift ? \"previous\" : \"next\";\n    }\n  },\n  _handleEnterKeyEditingCell: function (event) {\n    var target = event.target;\n\n    var $cell = this._getCellElementFromTarget(target);\n\n    var isRowEditMode = this._isRowEditMode();\n\n    this._updateFocusedCellPosition($cell);\n\n    if (isRowEditMode) {\n      this._focusEditFormCell($cell);\n\n      setTimeout(this._editingController.saveEditData.bind(this._editingController));\n    } else {\n      eventsEngine.trigger($(target), \"change\");\n\n      this._closeEditCell();\n\n      event.preventDefault();\n    }\n  },\n  _escapeKeyHandler: function (eventArgs, isEditing) {\n    var $cell = this._getCellElementFromTarget(eventArgs.originalEvent.target);\n\n    if (isEditing) {\n      this._updateFocusedCellPosition($cell);\n\n      if (!this._isRowEditMode()) {\n        if (\"cell\" === this._editingController.getEditMode()) {\n          this._editingController.cancelEditData();\n        } else {\n          this._closeEditCell();\n        }\n      } else {\n        this._focusEditFormCell($cell);\n\n        this._editingController.cancelEditData();\n\n        if (0 === this._dataController.items().length) {\n          this._resetFocusedCell();\n\n          this._editorFactory.loseFocus();\n        }\n      }\n\n      eventArgs.originalEvent.preventDefault();\n    }\n  },\n  _ctrlFKeyHandler: function (eventArgs) {\n    if (this.option(\"searchPanel.visible\")) {\n      var searchTextEditor = this._headerPanel.getSearchTextEditor();\n\n      if (searchTextEditor) {\n        searchTextEditor.focus();\n        eventArgs.originalEvent.preventDefault();\n      }\n    }\n  },\n  _f2KeyHandler: function () {\n    var isEditing = this._editingController.isEditing();\n\n    var rowIndex = this.getVisibleRowIndex();\n\n    var $row = this._focusedView && this._focusedView.getRow(rowIndex);\n\n    if (!isEditing && isDataRow($row)) {\n      this._startEditing();\n    }\n  },\n  _navigateNextCell: function ($event, keyCode) {\n    var $cell = this._getNextCell(keyCode);\n\n    var directionCode = this._getDirectionCodeByKey(keyCode);\n\n    var isCellValid = $cell && this._isCellValid($cell);\n\n    var result = isCellValid ? this._arrowKeysHandlerFocusCell($event, $cell, directionCode) : false;\n    return result;\n  },\n  _arrowKeysHandlerFocusCell: function ($event, $nextCell, direction) {\n    var isVerticalDirection = \"prevRow\" === direction || \"nextRow\" === direction;\n\n    var args = this._fireFocusChangingEvents($event, $nextCell, isVerticalDirection, true);\n\n    $nextCell = args.$newCellElement;\n\n    if (!args.cancel && this._isCellValid($nextCell)) {\n      this._focus($nextCell, !args.isHighlighted);\n\n      return true;\n    }\n\n    return false;\n  },\n  _beginFastEditing: function (originalEvent, isDeleting) {\n    if (!this._isFastEditingAllowed() || originalEvent.altKey || originalEvent.ctrlKey || this._editingController.isEditing()) {\n      return false;\n    }\n\n    if (isDeleting) {\n      this._startEditing(originalEvent, FAST_EDITING_DELETE_KEY);\n    } else {\n      var key = originalEvent.key;\n      var keyCode = originalEvent.keyCode || originalEvent.which;\n      var fastEditingKey = key || keyCode && String.fromCharCode(keyCode);\n\n      if (fastEditingKey && (1 === fastEditingKey.length || fastEditingKey === FAST_EDITING_DELETE_KEY)) {\n        this._startEditing(originalEvent, fastEditingKey);\n      }\n    }\n\n    return true;\n  },\n  _pointerEventHandler: function (e) {\n    var event = e.event || e;\n    var $target = $(event.currentTarget);\n    var rowsView = this.getView(\"rowsView\");\n    var focusedViewElement = rowsView && rowsView.element();\n    var $parent = $target.parent();\n    var isInteractiveElement = $(event.target).is(INTERACTIVE_ELEMENTS_SELECTOR);\n    var isRevertButton = !!$(event.target).closest(\".\".concat(REVERT_BUTTON_CLASS)).length;\n    var isExpandCommandCell = $target.hasClass(COMMAND_EXPAND_CLASS);\n\n    if (!this._isEventInCurrentGrid(event)) {\n      return;\n    }\n\n    if (!isRevertButton && (this._isCellValid($target, !isInteractiveElement) || isExpandCommandCell)) {\n      $target = this._isInsideEditForm($target) ? $(event.target) : $target;\n\n      this._focusView();\n\n      $(focusedViewElement).removeClass(FOCUS_STATE_CLASS);\n\n      if ($parent.hasClass(FREESPACE_ROW_CLASS)) {\n        this._updateFocusedCellPosition($target);\n\n        this._applyTabIndexToElement(this._focusedView.element());\n\n        this._focusedView.focus(true);\n      } else if (!this._isMasterDetailCell($target)) {\n        this._clickTargetCellHandler(event, $target);\n      } else {\n        this._updateFocusedCellPosition($target);\n      }\n    } else if ($target.is(\"td\")) {\n      this._resetFocusedCell();\n    }\n  },\n  _clickTargetCellHandler: function (event, $cell) {\n    var columnIndex = this.getView(\"rowsView\").getCellIndex($cell);\n\n    var column = this._columnsController.getVisibleColumns()[columnIndex];\n\n    var isCellEditMode = this._isCellEditMode();\n\n    this.setCellFocusType();\n\n    var args = this._fireFocusChangingEvents(event, $cell, true);\n\n    $cell = args.$newCellElement;\n\n    if (!args.cancel) {\n      if (args.resetFocusedRow) {\n        this.getController(\"focus\")._resetFocusedRow();\n\n        return;\n      }\n\n      if (args.rowIndexChanged) {\n        $cell = this._getFocusedCell();\n      }\n\n      if (!args.isHighlighted && !isCellEditMode) {\n        this.setRowFocusType();\n      }\n\n      this._updateFocusedCellPosition($cell);\n\n      if (this._allowRowUpdating() && isCellEditMode && column && column.allowEditing) {\n        this._isNeedFocus = false;\n        this._isHiddenFocus = false;\n      } else {\n        $cell = this._getFocusedCell();\n        var $target = event && $(event.target).closest(NON_FOCUSABLE_ELEMENTS_SELECTOR + \", td\");\n        var skipFocusEvent = $target && $target.not($cell).is(NON_FOCUSABLE_ELEMENTS_SELECTOR);\n        var isEditor = !!column && !column.command && $cell.hasClass(EDITOR_CELL_CLASS);\n        var isDisabled = !isEditor && (!args.isHighlighted || skipFocusEvent);\n\n        this._focus($cell, isDisabled, skipFocusEvent);\n      }\n    } else {\n      this.setRowFocusType();\n      this.setFocusedRowIndex(args.prevRowIndex);\n\n      if (this._editingController.isEditing() && isCellEditMode) {\n        this._closeEditCell();\n      }\n    }\n  },\n  _allowRowUpdating: function () {\n    var rowIndex = this.getVisibleRowIndex();\n\n    var row = this._dataController.items()[rowIndex];\n\n    return this._editingController.allowUpdating({\n      row: row\n    }, \"click\");\n  },\n  focus: function (element) {\n    var activeElementSelector;\n    var focusedRowEnabled = this.option(\"focusedRowEnabled\");\n\n    var isHighlighted = this._isCellElement($(element));\n\n    if (!element) {\n      activeElementSelector = \".dx-datagrid-rowsview .dx-row[tabindex]\";\n\n      if (!focusedRowEnabled) {\n        activeElementSelector += \", .dx-datagrid-rowsview .dx-row > td[tabindex]\";\n      }\n\n      element = this.component.$element().find(activeElementSelector).first();\n    }\n\n    element && this._focusElement($(element), isHighlighted);\n  },\n  getFocusedView: function () {\n    return this._focusedView;\n  },\n  setupFocusedView: function () {\n    if (this.isKeyboardEnabled() && !isDefined(this._focusedView)) {\n      this._focusView();\n    }\n  },\n  _focusElement: function ($element, isHighlighted) {\n    var rowsViewElement = $(this._getRowsViewElement());\n    var $focusedView = $element.closest(rowsViewElement);\n    var isRowFocusType = this.isRowFocusType();\n    var args = {};\n\n    if (!$focusedView.length || this._isCellElement($element) && !this._isCellValid($element)) {\n      return;\n    }\n\n    this._focusView();\n\n    this._isNeedFocus = true;\n    this._isNeedScroll = true;\n\n    if (this._isCellElement($element) || isGroupRow($element)) {\n      this.setCellFocusType();\n      args = this._fireFocusChangingEvents(null, $element, false, isHighlighted);\n      $element = args.$newCellElement;\n\n      if (isRowFocusType && !args.isHighlighted) {\n        this.setRowFocusType();\n      }\n    }\n\n    if (!args.cancel) {\n      this._focus($element, !args.isHighlighted);\n\n      this._focusInteractiveElement($element);\n    }\n  },\n  _getFocusedViewByElement: function ($element) {\n    var view = this.getFocusedView();\n    var $view = view && $(view.element());\n    return $element && 0 !== $element.closest($view).length;\n  },\n  _focusView: function () {\n    this._focusedView = this.getView(\"rowsView\");\n  },\n  _resetFocusedView: function () {\n    this.setRowFocusType();\n    this._focusedView = null;\n  },\n  _focusInteractiveElement: function ($cell, isLast) {\n    if (!$cell) {\n      return;\n    }\n\n    var $focusedElement = this._getInteractiveElement($cell, isLast);\n\n    gridCoreUtils.focusAndSelectElement(this, $focusedElement);\n  },\n  _focus: function ($cell, disableFocus, skipFocusEvent) {\n    var $row = $cell && !$cell.hasClass(ROW_CLASS) ? $cell.closest(\".\".concat(ROW_CLASS)) : $cell;\n\n    if ($row && isNotFocusedRow($row)) {\n      return;\n    }\n\n    var focusedView = this._focusedView;\n    var $focusViewElement = focusedView && focusedView.element();\n    var $focusElement;\n    this._isHiddenFocus = disableFocus;\n    var isRowFocus = isGroupRow($row) || this.isRowFocusType();\n\n    if (isRowFocus) {\n      $focusElement = $row;\n\n      if (focusedView) {\n        this.setFocusedRowIndex(this._getRowIndex($row));\n      }\n    } else if (this._isCellElement($cell)) {\n      $focusElement = $cell;\n\n      this._updateFocusedCellPosition($cell);\n    }\n\n    if ($focusElement) {\n      if ($focusViewElement) {\n        $focusViewElement.find(\".dx-row[tabindex], .dx-row > td[tabindex]\").not($focusElement).removeClass(CELL_FOCUS_DISABLED_CLASS).removeAttr(\"tabindex\");\n      }\n\n      eventsEngine.one($focusElement, \"blur\", e => {\n        if (e.relatedTarget) {\n          $focusElement.removeClass(CELL_FOCUS_DISABLED_CLASS);\n        }\n      });\n\n      if (!skipFocusEvent) {\n        this._applyTabIndexToElement($focusElement);\n\n        eventsEngine.trigger($focusElement, \"focus\");\n      }\n\n      if (disableFocus) {\n        $focusElement.addClass(CELL_FOCUS_DISABLED_CLASS);\n\n        if (isRowFocus) {\n          $cell.addClass(CELL_FOCUS_DISABLED_CLASS);\n        }\n      } else {\n        this._editorFactory.focus($focusElement);\n      }\n    }\n  },\n  _updateFocus: function (isRenderView) {\n    this._updateFocusTimeout = setTimeout(() => {\n      var editingController = this._editingController;\n      var isCellEditMode = editingController.getEditMode() === EDIT_MODE_CELL;\n      var isBatchEditMode = editingController.getEditMode() === EDIT_MODE_BATCH;\n\n      if (isCellEditMode && editingController.hasChanges() || isBatchEditMode && editingController.isNewRowInEditMode()) {\n        editingController._focusEditingCell();\n\n        return;\n      }\n\n      var $cell = this._getFocusedCell();\n\n      var isEditing = editingController.isEditing();\n\n      if ($cell && !(this._isMasterDetailCell($cell) && !this._isRowEditMode())) {\n        if (this._hasSkipRow($cell.parent())) {\n          var direction = this._focusedCellPosition && this._focusedCellPosition.rowIndex > 0 ? \"upArrow\" : \"downArrow\";\n          $cell = this._getNextCell(direction);\n        }\n\n        if (isElementDefined($cell)) {\n          if ($cell.is(\"td\") || $cell.hasClass(this.addWidgetPrefix(EDIT_FORM_ITEM_CLASS))) {\n            var isCommandCell = $cell.is(COMMAND_CELL_SELECTOR);\n            var $focusedElementInsideCell = $cell.find(\":focus\");\n            var isFocusedElementDefined = isElementDefined($focusedElementInsideCell);\n\n            if ((isRenderView || !isCommandCell) && this._editorFactory.focus()) {\n              if (isCommandCell && isFocusedElementDefined) {\n                gridCoreUtils.focusAndSelectElement(this, $focusedElementInsideCell);\n                return;\n              }\n\n              !isFocusedElementDefined && this._focus($cell);\n            } else if (!isFocusedElementDefined && (this._isNeedFocus || this._isHiddenFocus)) {\n              this._focus($cell, this._isHiddenFocus);\n            }\n\n            if (isEditing) {\n              this._focusInteractiveElement.bind(this)($cell);\n            }\n          } else {\n            eventsEngine.trigger($cell, \"focus\");\n          }\n        }\n      }\n    });\n  },\n  _getFocusedCell: function () {\n    return $(this._getCell(this._focusedCellPosition));\n  },\n  _updateFocusedCellPositionByTarget: function (target) {\n    var _this$_focusedCellPos;\n\n    var elementType = this._getElementType(target);\n\n    if (\"row\" === elementType && isDefined(null === (_this$_focusedCellPos = this._focusedCellPosition) || void 0 === _this$_focusedCellPos ? void 0 : _this$_focusedCellPos.columnIndex)) {\n      var $row = $(target);\n      this._focusedView && isGroupRow($row) && this.setFocusedRowIndex(this._getRowIndex($row));\n    } else {\n      this._updateFocusedCellPosition(this._getCellElementFromTarget(target));\n    }\n  },\n  _updateFocusedCellPosition: function ($cell, direction) {\n    var position = this._getCellPosition($cell, direction);\n\n    if (position) {\n      if (!$cell.length || position.rowIndex >= 0 && position.columnIndex >= 0) {\n        this.setFocusedCellPosition(position.rowIndex, position.columnIndex);\n      }\n    }\n\n    return position;\n  },\n  _getFocusedColumnIndexOffset: function (columnIndex) {\n    var offset = 0;\n\n    var column = this._columnsController.getVisibleColumns()[columnIndex];\n\n    if (column && column.fixed) {\n      offset = this._getFixedColumnIndexOffset(column);\n    } else if (columnIndex >= 0) {\n      offset = this._columnsController.getColumnIndexOffset();\n    }\n\n    return offset;\n  },\n  _getFixedColumnIndexOffset: function (column) {\n    var offset = isFixedColumnIndexOffsetRequired(this, column) ? this._getVisibleColumnCount() - this._columnsController.getVisibleColumns().length : 0;\n    return offset;\n  },\n  _getCellPosition: function ($cell, direction) {\n    var columnIndex;\n    var $row = isElementDefined($cell) && $cell.closest(\"tr\");\n    var rowsView = this.getView(\"rowsView\");\n\n    if (isElementDefined($row)) {\n      var rowIndex = this._getRowIndex($row);\n\n      columnIndex = rowsView.getCellIndex($cell, rowIndex);\n      columnIndex += this._getFocusedColumnIndexOffset(columnIndex);\n\n      if (direction) {\n        columnIndex = \"previous\" === direction ? columnIndex - 1 : columnIndex + 1;\n        columnIndex = this._applyColumnIndexBoundaries(columnIndex);\n      }\n\n      return {\n        rowIndex: rowIndex,\n        columnIndex: columnIndex\n      };\n    }\n  },\n  _focusCell: function ($cell, isDisabled) {\n    if (this._isCellValid($cell)) {\n      this._focus($cell, isDisabled);\n\n      return true;\n    }\n  },\n  _focusEditFormCell: function ($cell) {\n    if ($cell.hasClass(MASTER_DETAIL_CELL_CLASS)) {\n      this._editorFactory.focus($cell, true);\n    }\n  },\n  _resetFocusedCell: function (preventScroll) {\n    var _this$_focusedView;\n\n    var $cell = this._getFocusedCell();\n\n    isElementDefined($cell) && $cell.removeAttr(\"tabindex\");\n    this._isNeedFocus = false;\n    this._isNeedScroll = false;\n    this._focusedCellPosition = {};\n    clearTimeout(this._updateFocusTimeout);\n    null === (_this$_focusedView = this._focusedView) || void 0 === _this$_focusedView ? void 0 : _this$_focusedView.renderFocusState({\n      preventScroll: preventScroll\n    });\n  },\n  restoreFocusableElement: function (rowIndex, $event) {\n    var args;\n    var $rowElement;\n    var isUpArrow = isDefined(rowIndex);\n    var rowsView = this.getView(\"rowsView\");\n    var $rowsViewElement = rowsView.element();\n    var columnIndex = this._focusedCellPosition.columnIndex;\n\n    var rowIndexOffset = this._dataController.getRowIndexOffset();\n\n    rowIndex = isUpArrow ? rowIndex : rowsView.getTopVisibleItemIndex() + rowIndexOffset;\n\n    if (!isUpArrow) {\n      this._editorFactory.loseFocus();\n\n      this._applyTabIndexToElement($rowsViewElement);\n\n      eventsEngine.trigger($rowsViewElement, \"focus\");\n    } else {\n      $rowElement = rowsView.getRow(rowIndex - rowIndexOffset);\n      args = this._fireFocusedRowChanging($event, $rowElement);\n\n      if (!args.cancel && args.rowIndexChanged) {\n        rowIndex = args.newRowIndex;\n      }\n    }\n\n    if (!isUpArrow || !args.cancel) {\n      this.setFocusedCellPosition(rowIndex, columnIndex);\n    }\n\n    isUpArrow && this._updateFocus();\n  },\n  _getNewPositionByCode: function (cellPosition, elementType, code) {\n    var columnIndex = cellPosition.columnIndex;\n    var rowIndex = cellPosition.rowIndex;\n    var visibleColumnsCount;\n\n    if (void 0 === cellPosition.rowIndex && \"next\" === code) {\n      return {\n        columnIndex: 0,\n        rowIndex: 0\n      };\n    }\n\n    switch (code) {\n      case \"nextInRow\":\n      case \"next\":\n        visibleColumnsCount = this._getVisibleColumnCount();\n\n        if (columnIndex < visibleColumnsCount - 1 && \"row\" !== elementType && this._hasValidCellAfterPosition({\n          columnIndex: columnIndex,\n          rowIndex: rowIndex\n        })) {\n          columnIndex++;\n        } else if (!this._isLastRow(rowIndex) && \"next\" === code) {\n          columnIndex = 0;\n          rowIndex++;\n        }\n\n        break;\n\n      case \"previousInRow\":\n      case \"previous\":\n        if (columnIndex > 0 && \"row\" !== elementType && this._hasValidCellBeforePosition({\n          columnIndex: columnIndex,\n          rowIndex: rowIndex\n        })) {\n          columnIndex--;\n        } else if (rowIndex > 0 && \"previous\" === code) {\n          rowIndex--;\n          visibleColumnsCount = this._getVisibleColumnCount();\n          columnIndex = visibleColumnsCount - 1;\n        }\n\n        break;\n\n      case \"upArrow\":\n        rowIndex = rowIndex > 0 ? rowIndex - 1 : rowIndex;\n        break;\n\n      case \"downArrow\":\n        rowIndex = !this._isLastRow(rowIndex) ? rowIndex + 1 : rowIndex;\n    }\n\n    return {\n      columnIndex: columnIndex,\n      rowIndex: rowIndex\n    };\n  },\n  setFocusedCellPosition: function (rowIndex, columnIndex) {\n    this.setFocusedRowIndex(rowIndex);\n    this.setFocusedColumnIndex(columnIndex);\n  },\n  setFocusedRowIndex: function (rowIndex) {\n    if (!this._focusedCellPosition) {\n      this._focusedCellPosition = {};\n    }\n\n    this._focusedCellPosition.rowIndex = rowIndex;\n  },\n  setFocusedColumnIndex: function (columnIndex) {\n    if (!this._focusedCellPosition) {\n      this._focusedCellPosition = {};\n    }\n\n    this._focusedCellPosition.columnIndex = columnIndex;\n  },\n  getRowIndex: function () {\n    return this._focusedCellPosition ? this._focusedCellPosition.rowIndex : -1;\n  },\n  getColumnIndex: function () {\n    return this._focusedCellPosition ? this._focusedCellPosition.columnIndex : -1;\n  },\n  getVisibleRowIndex: function () {\n    var rowIndex = this._focusedCellPosition && this._focusedCellPosition.rowIndex;\n\n    if (!isDefined(rowIndex) || rowIndex < 0) {\n      return -1;\n    }\n\n    return rowIndex - this._dataController.getRowIndexOffset();\n  },\n  getVisibleColumnIndex: function () {\n    var columnIndex = this._focusedCellPosition && this._focusedCellPosition.columnIndex;\n\n    if (!isDefined(columnIndex)) {\n      return -1;\n    }\n\n    return columnIndex - this._columnsController.getColumnIndexOffset();\n  },\n  _applyColumnIndexBoundaries: function (columnIndex) {\n    var visibleColumnsCount = this._getVisibleColumnCount();\n\n    if (columnIndex < 0) {\n      columnIndex = 0;\n    } else if (columnIndex >= visibleColumnsCount) {\n      columnIndex = visibleColumnsCount - 1;\n    }\n\n    return columnIndex;\n  },\n  _isCellByPositionValid: function (cellPosition) {\n    var $cell = $(this._getCell(cellPosition));\n    return this._isCellValid($cell);\n  },\n  _isLastRow: function (rowIndex) {\n    var dataController = this._dataController;\n    var visibleItems = dataController.items().filter(item => false !== item.visible);\n\n    if (this._isVirtualRowRender()) {\n      return rowIndex >= dataController.getMaxRowIndex();\n    }\n\n    return rowIndex === visibleItems.length - 1;\n  },\n  _isFirstValidCell: function (cellPosition) {\n    var isFirstValidCell = false;\n\n    if (0 === cellPosition.rowIndex && cellPosition.columnIndex >= 0) {\n      isFirstValidCell = isFirstValidCell || !this._hasValidCellBeforePosition(cellPosition);\n    }\n\n    return isFirstValidCell;\n  },\n  _hasValidCellBeforePosition: function (cellPosition) {\n    var columnIndex = cellPosition.columnIndex;\n    var hasValidCells = false;\n\n    while (columnIndex > 0 && !hasValidCells) {\n      var checkingPosition = {\n        columnIndex: --columnIndex,\n        rowIndex: cellPosition.rowIndex\n      };\n      hasValidCells = this._isCellByPositionValid(checkingPosition);\n    }\n\n    return hasValidCells;\n  },\n  _hasValidCellAfterPosition: function (cellPosition) {\n    var columnIndex = cellPosition.columnIndex;\n    var hasValidCells = false;\n\n    var visibleColumnCount = this._getVisibleColumnCount();\n\n    while (columnIndex < visibleColumnCount - 1 && !hasValidCells) {\n      var checkingPosition = {\n        columnIndex: ++columnIndex,\n        rowIndex: cellPosition.rowIndex\n      };\n      hasValidCells = this._isCellByPositionValid(checkingPosition);\n    }\n\n    return hasValidCells;\n  },\n  _isLastValidCell: function (cellPosition) {\n    var nextColumnIndex = cellPosition.columnIndex >= 0 ? cellPosition.columnIndex + 1 : 0;\n    var rowIndex = cellPosition.rowIndex;\n    var checkingPosition = {\n      columnIndex: nextColumnIndex,\n      rowIndex: rowIndex\n    };\n\n    var visibleRows = this._dataController.getVisibleRows();\n\n    var row = visibleRows && visibleRows[rowIndex];\n\n    var isLastRow = this._isLastRow(rowIndex);\n\n    if (!isLastRow) {\n      return false;\n    }\n\n    if (row && \"group\" === row.rowType && cellPosition.columnIndex > 0) {\n      return true;\n    }\n\n    if (cellPosition.columnIndex === this._getVisibleColumnCount() - 1) {\n      return true;\n    }\n\n    if (this._isCellByPositionValid(checkingPosition)) {\n      return false;\n    }\n\n    return this._isLastValidCell(checkingPosition);\n  },\n  _isCellValid: function ($cell, isClick) {\n    if (isElementDefined($cell)) {\n      var rowsView = this.getView(\"rowsView\");\n      var $row = $cell.parent();\n      var columnsController = this._columnsController;\n      var columnIndex = rowsView.getCellIndex($cell) + columnsController.getColumnIndexOffset();\n      var column = columnsController.getVisibleColumns(null, true)[columnIndex];\n\n      var visibleColumnCount = this._getVisibleColumnCount();\n\n      var editingController = this._editingController;\n      var isMasterDetailRow = isDetailRow($row);\n      var isShowWhenGrouped = column && column.showWhenGrouped;\n      var isDataCell = column && !$cell.hasClass(COMMAND_EXPAND_CLASS) && isDataRow($row);\n\n      if (this._isMasterDetailCell($cell)) {\n        return true;\n      }\n\n      if (visibleColumnCount > columnIndex && (!isMasterDetailRow && column && (!isDefined(column.groupIndex) || isShowWhenGrouped && isDataCell) || parseInt($cell.attr(\"colspan\")) > 1)) {\n        var rowItems = this._dataController.items();\n\n        var visibleRowIndex = rowsView.getRowIndex($row);\n        var row = rowItems[visibleRowIndex];\n        var isCellEditing = editingController && this._isCellEditMode() && editingController.isEditing();\n        var isRowEditingInCurrentRow = editingController && editingController.isEditRow(visibleRowIndex);\n        var isEditing = isRowEditingInCurrentRow || isCellEditing;\n\n        if (column.command) {\n          if (this._isLegacyNavigation()) {\n            return !isEditing && \"expand\" === column.command;\n          }\n\n          if (isCellEditing) {\n            return false;\n          }\n\n          if (isRowEditingInCurrentRow) {\n            return \"select\" !== column.command;\n          }\n\n          return !isEditing;\n        }\n\n        if (isCellEditing && row && \"data\" !== row.rowType) {\n          return false;\n        }\n\n        return !isEditing || column.allowEditing || isClick;\n      }\n    }\n  },\n  getFirstValidCellInRow: function ($row, columnIndex) {\n    var $cells = $row.find(\"> td\");\n    var $cell;\n    var $result;\n    columnIndex = columnIndex || 0;\n\n    for (var i = columnIndex; i < $cells.length; ++i) {\n      $cell = $cells.eq(i);\n\n      if (this._isCellValid($cell)) {\n        $result = $cell;\n        break;\n      }\n    }\n\n    return $result;\n  },\n  _getNextCell: function (keyCode, elementType, cellPosition) {\n    var focusedCellPosition = cellPosition || this._focusedCellPosition;\n    var isRowFocusType = this.isRowFocusType();\n    var includeCommandCells = isRowFocusType || [\"next\", \"previous\"].includes(keyCode);\n    var $cell;\n    var $row;\n\n    if (this._focusedView && focusedCellPosition) {\n      var newFocusedCellPosition = this._getNewPositionByCode(focusedCellPosition, elementType, keyCode);\n\n      $cell = $(this._getCell(newFocusedCellPosition));\n      var isLastCellOnDirection = \"previous\" === keyCode ? this._isFirstValidCell(newFocusedCellPosition) : this._isLastValidCell(newFocusedCellPosition);\n\n      if (isElementDefined($cell) && !this._isCellValid($cell) && this._isCellInRow(newFocusedCellPosition, includeCommandCells) && !isLastCellOnDirection) {\n        if (isRowFocusType) {\n          $cell = this.getFirstValidCellInRow($cell.parent(), newFocusedCellPosition.columnIndex);\n        } else {\n          $cell = this._getNextCell(keyCode, \"cell\", newFocusedCellPosition);\n        }\n      }\n\n      $row = isElementDefined($cell) && $cell.parent();\n\n      if (this._hasSkipRow($row)) {\n        var rowIndex = this._getRowIndex($row);\n\n        if (!this._isLastRow(rowIndex)) {\n          $cell = this._getNextCell(keyCode, \"row\", {\n            columnIndex: focusedCellPosition.columnIndex,\n            rowIndex: rowIndex\n          });\n        } else {\n          return null;\n        }\n      }\n\n      return isElementDefined($cell) ? $cell : null;\n    }\n\n    return null;\n  },\n  _startEditing: function (eventArgs, fastEditingKey) {\n    var focusedCellPosition = this._focusedCellPosition;\n    var visibleRowIndex = this.getVisibleRowIndex();\n    var visibleColumnIndex = this.getVisibleColumnIndex();\n\n    var row = this._dataController.items()[visibleRowIndex];\n\n    var column = this._columnsController.getVisibleColumns()[visibleColumnIndex];\n\n    if (this._isAllowEditing(row, column)) {\n      if (this._isRowEditMode()) {\n        this._editingController.editRow(visibleRowIndex);\n      } else if (focusedCellPosition) {\n        this._startEditCell(eventArgs, fastEditingKey);\n      }\n    }\n  },\n  _isAllowEditing: function (row, column) {\n    return this._editingController.allowUpdating({\n      row: row\n    }) && column && column.allowEditing;\n  },\n  _editFocusedCell: function () {\n    var rowIndex = this.getVisibleRowIndex();\n    var colIndex = this.getVisibleColumnIndex();\n    return this._editingController.editCell(rowIndex, colIndex);\n  },\n  _startEditCell: function (eventArgs, fastEditingKey) {\n    this._fastEditingStarted = isDefined(fastEditingKey);\n\n    var editResult = this._editFocusedCell();\n\n    if (this._isFastEditingStarted()) {\n      if (true === editResult) {\n        this._editingCellHandler(eventArgs, fastEditingKey);\n      } else if (editResult && editResult.done) {\n        var editorValue = fastEditingKey !== FAST_EDITING_DELETE_KEY ? fastEditingKey : \"\";\n        editResult.done(() => this._editingCellHandler(eventArgs, editorValue));\n      }\n    }\n  },\n  _editingCellHandler: function (eventArgs, editorValue) {\n    var _$input$get$select, _$input$get;\n\n    var $input = this._getFocusedCell().find(INTERACTIVE_ELEMENTS_SELECTOR).eq(0);\n\n    var keyDownEvent = createEvent(eventArgs, {\n      type: \"keydown\",\n      target: $input.get(0)\n    });\n    var keyPressEvent = createEvent(eventArgs, {\n      type: \"keypress\",\n      target: $input.get(0)\n    });\n    var inputEvent = createEvent(eventArgs, {\n      type: \"input\",\n      target: $input.get(0)\n    });\n\n    if (inputEvent.originalEvent) {\n      inputEvent.originalEvent = createEvent(inputEvent.originalEvent, {\n        data: editorValue\n      });\n    }\n\n    null === (_$input$get$select = (_$input$get = $input.get(0)).select) || void 0 === _$input$get$select ? void 0 : _$input$get$select.call(_$input$get);\n    eventsEngine.trigger($input, keyDownEvent);\n\n    if (!keyDownEvent.isDefaultPrevented()) {\n      eventsEngine.trigger($input, keyPressEvent);\n\n      if (!keyPressEvent.isDefaultPrevented()) {\n        var timeout = browser.mozilla ? 25 : 0;\n        setTimeout(() => {\n          $input.val(editorValue);\n          var $widgetContainer = $input.closest(\".\".concat(WIDGET_CLASS));\n          eventsEngine.off($widgetContainer, \"focusout\");\n          eventsEngine.one($widgetContainer, \"focusout\", function () {\n            eventsEngine.trigger($input, \"change\");\n          });\n          eventsEngine.trigger($input, inputEvent);\n        }, timeout);\n      }\n    }\n  },\n  _fireFocusChangingEvents: function ($event, $cell, fireRowEvent, isHighlighted) {\n    var args = {};\n    var cellPosition = this._getCellPosition($cell) || {};\n\n    if (this.isCellFocusType()) {\n      args = this._fireFocusedCellChanging($event, $cell, isHighlighted);\n\n      if (!args.cancel) {\n        cellPosition.columnIndex = args.newColumnIndex;\n        cellPosition.rowIndex = args.newRowIndex;\n        isHighlighted = args.isHighlighted;\n        $cell = $(this._getCell(cellPosition));\n      }\n    }\n\n    if (!args.cancel && fireRowEvent && $cell) {\n      args = this._fireFocusedRowChanging($event, $cell.parent());\n\n      if (!args.cancel) {\n        cellPosition.rowIndex = args.newRowIndex;\n        args.isHighlighted = isHighlighted;\n      }\n    }\n\n    args.$newCellElement = $(this._getCell(cellPosition));\n\n    if (!args.$newCellElement.length) {\n      args.$newCellElement = $cell;\n    }\n\n    return args;\n  },\n  _fireFocusedCellChanging: function ($event, $cellElement, isHighlighted) {\n    var prevCellIndex = this.option(\"focusedColumnIndex\");\n    var prevRowIndex = this.option(\"focusedRowIndex\");\n\n    var cellPosition = this._getCellPosition($cellElement);\n\n    var columnIndex = cellPosition ? cellPosition.columnIndex : -1;\n    var rowIndex = cellPosition ? cellPosition.rowIndex : -1;\n    var args = {\n      cellElement: $cellElement,\n      prevColumnIndex: prevCellIndex,\n      prevRowIndex: prevRowIndex,\n      newColumnIndex: columnIndex,\n      newRowIndex: rowIndex,\n      rows: this._dataController.getVisibleRows(),\n      columns: this._columnsController.getVisibleColumns(),\n      event: $event,\n      isHighlighted: isHighlighted || false,\n      cancel: false\n    };\n    this._canceledCellPosition = null;\n    this.executeAction(\"onFocusedCellChanging\", args);\n\n    if (args.newColumnIndex !== columnIndex || args.newRowIndex !== rowIndex) {\n      args.$newCellElement = $(this._getCell({\n        columnIndex: args.newColumnIndex,\n        rowIndex: args.newRowIndex\n      }));\n    }\n\n    if (args.cancel) {\n      this._canceledCellPosition = {\n        rowIndex: rowIndex,\n        columnIndex: columnIndex\n      };\n    }\n\n    return args;\n  },\n  _fireFocusedCellChanged: function ($cellElement, prevCellIndex, prevRowIndex) {\n    var dataController = this._dataController;\n    var columnIndex = this.getView(\"rowsView\").getCellIndex($cellElement);\n\n    var rowIndex = this._getRowIndex($cellElement && $cellElement.parent());\n\n    var localRowIndex = Math.min(rowIndex - dataController.getRowIndexOffset(), dataController.items().length - 1);\n\n    var isEditingCell = this._editingController.isEditCell(localRowIndex, columnIndex);\n\n    var row = dataController.items()[localRowIndex];\n\n    if (!isEditingCell && (prevCellIndex !== columnIndex || prevRowIndex !== rowIndex)) {\n      this.executeAction(\"onFocusedCellChanged\", {\n        cellElement: $cellElement,\n        columnIndex: columnIndex,\n        rowIndex: rowIndex,\n        row: row,\n        column: this._columnsController.getVisibleColumns()[columnIndex]\n      });\n    }\n  },\n  _fireFocusedRowChanging: function (eventArgs, $newFocusedRow) {\n    var newRowIndex = this._getRowIndex($newFocusedRow);\n\n    var dataController = this._dataController;\n    var prevFocusedRowIndex = this.option(\"focusedRowIndex\");\n    var loadingOperationTypes = dataController.loadingOperationTypes();\n    var args = {\n      rowElement: $newFocusedRow,\n      prevRowIndex: prevFocusedRowIndex,\n      newRowIndex: newRowIndex,\n      event: eventArgs,\n      rows: dataController.getVisibleRows(),\n      cancel: false\n    };\n\n    if (!dataController || dataController.isLoading() && (loadingOperationTypes.reload || loadingOperationTypes.paging)) {\n      args.cancel = true;\n      return args;\n    }\n\n    if (this.option(\"focusedRowEnabled\")) {\n      this.executeAction(\"onFocusedRowChanging\", args);\n\n      if (!args.cancel && args.newRowIndex !== newRowIndex) {\n        args.resetFocusedRow = args.newRowIndex < 0;\n\n        if (!args.resetFocusedRow) {\n          this.setFocusedRowIndex(args.newRowIndex);\n        }\n\n        args.rowIndexChanged = true;\n      }\n    }\n\n    return args;\n  },\n  _fireFocusedRowChanged: function ($rowElement) {\n    var row;\n    var focusedRowKey = this.option(\"focusedRowKey\");\n    var focusController = this.getController(\"focus\");\n    var focusedRowIndex = null === focusController || void 0 === focusController ? void 0 : focusController.getFocusedRowIndexByKey(focusedRowKey);\n\n    if (this.option(\"focusedRowEnabled\")) {\n      if (focusedRowIndex >= 0) {\n        var dataController = this._dataController;\n        row = focusedRowIndex >= 0 && dataController.getVisibleRows()[focusedRowIndex - dataController.getRowIndexOffset()];\n      }\n\n      this.executeAction(\"onFocusedRowChanged\", {\n        rowElement: $rowElement,\n        rowIndex: focusedRowIndex,\n        row: row\n      });\n    }\n  },\n  _isEventInCurrentGrid: function (event) {\n    return gridCoreUtils.isElementInCurrentGrid(this, $(event.target));\n  },\n  _isRowEditMode: function () {\n    var editMode = this._editingController.getEditMode();\n\n    return editMode === EDIT_MODE_ROW || editMode === EDIT_MODE_FORM;\n  },\n  _isCellEditMode: function () {\n    var editMode = this._editingController.getEditMode();\n\n    return editMode === EDIT_MODE_CELL || editMode === EDIT_MODE_BATCH;\n  },\n  _isFastEditingAllowed: function () {\n    return this._isCellEditMode() && this.option(\"keyboardNavigation.editOnKeyPress\");\n  },\n  _getInteractiveElement: function ($cell, isLast) {\n    var $focusedElement = $cell.find(INTERACTIVE_ELEMENTS_SELECTOR).filter(\":visible\");\n    return isLast ? $focusedElement.last() : $focusedElement.first();\n  },\n  _applyTabIndexToElement: function ($element) {\n    var tabIndex = this.option(\"tabIndex\") || 0;\n    $element.attr(\"tabindex\", isDefined(tabIndex) ? tabIndex : 0);\n  },\n  _getCell: function (cellPosition) {\n    if (this._focusedView && cellPosition) {\n      var rowIndexOffset = this._dataController.getRowIndexOffset();\n\n      var column = this._columnsController.getVisibleColumns(null, true)[cellPosition.columnIndex];\n\n      var columnIndexOffset = column && column.fixed ? this._getFixedColumnIndexOffset(column) : this._columnsController.getColumnIndexOffset();\n      var rowIndex = cellPosition.rowIndex >= 0 ? cellPosition.rowIndex - rowIndexOffset : -1;\n      var columnIndex = cellPosition.columnIndex >= 0 ? cellPosition.columnIndex - columnIndexOffset : -1;\n      return this._focusedView.getCell({\n        rowIndex: rowIndex,\n        columnIndex: columnIndex\n      });\n    }\n  },\n  _getRowIndex: function ($row) {\n    var rowsView = this.getView(\"rowsView\");\n    var rowIndex = rowsView.getRowIndex($row);\n\n    if (rowIndex >= 0) {\n      rowIndex += this._dataController.getRowIndexOffset();\n    }\n\n    return rowIndex;\n  },\n  _hasSkipRow: function ($row) {\n    var row = $row && $row.get(0);\n    return row && (\"none\" === row.style.display || $row.hasClass(this.addWidgetPrefix(GROUP_FOOTER_CLASS)) || isDetailRow($row) && !$row.hasClass(this.addWidgetPrefix(EDIT_FORM_CLASS)));\n  },\n  _allowEditingOnEnterKey: function () {\n    return \"startEdit\" === this.option(\"keyboardNavigation.enterKeyAction\");\n  },\n  _isLegacyNavigation: function () {\n    return this.option(\"useLegacyKeyboardNavigation\");\n  },\n  _getDirectionCodeByKey: function (key) {\n    var directionCode;\n\n    switch (key) {\n      case \"upArrow\":\n        directionCode = \"prevRow\";\n        break;\n\n      case \"downArrow\":\n        directionCode = \"nextRow\";\n        break;\n\n      case \"leftArrow\":\n        directionCode = this.option(\"rtlEnabled\") ? \"nextInRow\" : \"previousInRow\";\n        break;\n\n      case \"rightArrow\":\n        directionCode = this.option(\"rtlEnabled\") ? \"previousInRow\" : \"nextInRow\";\n    }\n\n    return directionCode;\n  },\n  _isVirtualScrolling: function () {\n    var scrollingMode = this.option(\"scrolling.mode\");\n    return \"virtual\" === scrollingMode || \"infinite\" === scrollingMode;\n  },\n  _isVirtualRowRender: function () {\n    return this._isVirtualScrolling() || gridCoreUtils.isVirtualRowRendering(this);\n  },\n  _isVirtualColumnRender: function () {\n    return \"virtual\" === this.option(\"scrolling.columnRenderingMode\");\n  },\n  _scrollBy: function (left, top, rowIndex, $event) {\n    var that = this;\n    var scrollable = this.getView(\"rowsView\").getScrollable();\n\n    if (that._focusedCellPosition) {\n      scrollable.on(\"scroll\", function scrollHandler() {\n        scrollable.off(\"scroll\", scrollHandler);\n        setTimeout(that.restoreFocusableElement.bind(that, rowIndex, $event));\n      });\n    }\n\n    return scrollable.scrollBy({\n      left: left,\n      top: top\n    });\n  },\n  _isInsideEditForm: function (element) {\n    var $editForm = $(element).closest(\".\" + this.addWidgetPrefix(EDIT_FORM_CLASS));\n    return $editForm.length && this.elementIsInsideGrid($editForm);\n  },\n  _isMasterDetailCell: function (element) {\n    var $masterDetailCell = $(element).closest(\".\" + MASTER_DETAIL_CELL_CLASS);\n    return $masterDetailCell.length && this.elementIsInsideGrid($masterDetailCell);\n  },\n  _processNextCellInMasterDetail: function ($nextCell) {\n    if (!this._isInsideEditForm($nextCell) && $nextCell) {\n      this._applyTabIndexToElement($nextCell);\n    }\n  },\n  _handleTabKeyOnMasterDetailCell: function (target, direction) {\n    if (this._isMasterDetailCell(target)) {\n      this._updateFocusedCellPosition($(target), direction);\n\n      var $nextCell = this._getNextCell(direction, \"row\");\n\n      this._processNextCellInMasterDetail($nextCell, $(target));\n\n      return true;\n    }\n\n    return false;\n  },\n  _getElementType: function (target) {\n    return $(target).is(\"tr\") ? \"row\" : \"cell\";\n  },\n  _isFastEditingStarted: function () {\n    return this._isFastEditingAllowed() && this._fastEditingStarted;\n  },\n  _getVisibleColumnCount: function () {\n    return this._columnsController.getVisibleColumns(null, true).length;\n  },\n  _isCellInRow: function (cellPosition, includeCommandCells) {\n    var columnIndex = cellPosition.columnIndex;\n\n    var visibleColumnsCount = this._getVisibleColumnCount();\n\n    return includeCommandCells ? columnIndex >= 0 && columnIndex <= visibleColumnsCount - 1 : columnIndex > 0 && columnIndex < visibleColumnsCount - 1;\n  },\n  _isCellElement: function ($element) {\n    return $element.length && \"TD\" === $element[0].tagName;\n  },\n  _getCellElementFromTarget: function (target) {\n    var elementType = this._getElementType(target);\n\n    var $targetElement = $(target);\n    var $cell;\n\n    if (\"cell\" === elementType) {\n      $cell = $targetElement.closest(\".\".concat(ROW_CLASS, \" > td\"));\n    } else {\n      $cell = $targetElement.children().not(\".\" + COMMAND_EXPAND_CLASS).first();\n    }\n\n    return $cell;\n  },\n  _getRowsViewElement: function () {\n    var rowsView = this.getView(\"rowsView\");\n    return rowsView && rowsView.element();\n  },\n  isKeyboardEnabled: function () {\n    return this.option(\"keyboardNavigation.enabled\");\n  },\n  _processCanceledEditCellPosition: function (rowIndex, columnIndex) {\n    if (this._canceledCellPosition) {\n      var isCanceled = this._canceledCellPosition.rowIndex === rowIndex && this._canceledCellPosition.columnIndex === columnIndex;\n      this._canceledCellPosition = null;\n      return isCanceled;\n    }\n  },\n  updateFocusedRowIndex: function () {\n    var dataController = this._dataController;\n    var visibleRowIndex = this.getVisibleRowIndex();\n    var visibleItems = dataController.items();\n    var lastVisibleIndex = visibleItems.length ? visibleItems.length - 1 : -1;\n    var rowIndexOffset = dataController.getRowIndexOffset();\n    lastVisibleIndex >= 0 && visibleRowIndex > lastVisibleIndex && this.setFocusedRowIndex(lastVisibleIndex + rowIndexOffset);\n  }\n};\nvar KeyboardNavigationController = core.ViewController.inherit(keyboardNavigationMembers);\nexport var keyboardNavigationModule = {\n  defaultOptions: function () {\n    return {\n      useLegacyKeyboardNavigation: false,\n      keyboardNavigation: {\n        enabled: true,\n        enterKeyAction: \"startEdit\",\n        enterKeyDirection: \"none\",\n        editOnKeyPress: false\n      }\n    };\n  },\n  controllers: {\n    keyboardNavigation: KeyboardNavigationController\n  },\n  extenders: {\n    views: {\n      rowsView: {\n        _rowClick: function (e) {\n          var editRowIndex = this.getController(\"editing\").getEditRowIndex();\n          var keyboardController = this.getController(\"keyboardNavigation\");\n          var isKeyboardEnabled = keyboardController.isKeyboardEnabled();\n\n          if (editRowIndex === e.rowIndex) {\n            keyboardController.setCellFocusType();\n          }\n\n          var needTriggerPointerEventHandler = (isMobile() || !isKeyboardEnabled) && this.option(\"focusedRowEnabled\");\n\n          if (needTriggerPointerEventHandler) {\n            this._triggerPointerDownEventHandler(e, !isKeyboardEnabled);\n          }\n\n          this.callBase.apply(this, arguments);\n        },\n        _triggerPointerDownEventHandler: function (e, force) {\n          var originalEvent = e.event.originalEvent;\n\n          if (originalEvent) {\n            var keyboardController = this.getController(\"keyboardNavigation\");\n            var $cell = $(originalEvent.target);\n            var columnIndex = this.getCellIndex($cell);\n            var column = this.getController(\"columns\").getVisibleColumns()[columnIndex];\n            var row = this.getController(\"data\").items()[e.rowIndex];\n\n            if (keyboardController._isAllowEditing(row, column) || force) {\n              var eventArgs = createEvent(originalEvent, {\n                currentTarget: originalEvent.target\n              });\n\n              keyboardController._pointerEventHandler(eventArgs);\n            }\n          }\n        },\n        renderFocusState: function (params) {\n          var {\n            preventScroll: preventScroll,\n            pageSizeChanged: pageSizeChanged\n          } = null !== params && void 0 !== params ? params : {};\n          var keyboardController = this.getController(\"keyboardNavigation\");\n          var $rowsViewElement = this.element();\n\n          if ($rowsViewElement && !focused($rowsViewElement)) {\n            $rowsViewElement.attr(\"tabindex\", null);\n          }\n\n          pageSizeChanged && keyboardController.updateFocusedRowIndex();\n          var rowIndex = keyboardController.getVisibleRowIndex();\n\n          if (!isDefined(rowIndex) || rowIndex < 0) {\n            rowIndex = 0;\n          }\n\n          var cellElements = this.getCellElements(rowIndex);\n\n          if (keyboardController.isKeyboardEnabled() && cellElements.length) {\n            this.updateFocusElementTabIndex(cellElements, preventScroll);\n          }\n        },\n        updateFocusElementTabIndex: function (cellElements) {\n          var keyboardController = this.getController(\"keyboardNavigation\");\n          var $row = cellElements.eq(0).parent();\n\n          if (isGroupRow($row)) {\n            keyboardController._applyTabIndexToElement($row);\n          } else {\n            var columnIndex = keyboardController.getColumnIndex();\n\n            if (!isDefined(columnIndex) || columnIndex < 0) {\n              columnIndex = 0;\n            }\n\n            this._updateFocusedCellTabIndex(cellElements, columnIndex);\n          }\n        },\n        _updateFocusedCellTabIndex: function (cellElements, columnIndex) {\n          var keyboardController = this.getController(\"keyboardNavigation\");\n          var cellElementsLength = cellElements ? cellElements.length : -1;\n\n          var updateCellTabIndex = function ($cell) {\n            var isMasterDetailCell = keyboardController._isMasterDetailCell($cell);\n\n            var isValidCell = keyboardController._isCellValid($cell);\n\n            if (!isMasterDetailCell && isValidCell && keyboardController._isCellElement($cell)) {\n              keyboardController._applyTabIndexToElement($cell);\n\n              keyboardController.setCellFocusType();\n              return true;\n            }\n          };\n\n          var $cell = cellElements.filter(\"[aria-colindex='\".concat(columnIndex + 1, \"']\"));\n\n          if ($cell.length) {\n            updateCellTabIndex($cell);\n          } else {\n            if (cellElementsLength <= columnIndex) {\n              columnIndex = cellElementsLength - 1;\n            }\n\n            for (var i = columnIndex; i < cellElementsLength; ++i) {\n              if (updateCellTabIndex($(cellElements[i]))) {\n                break;\n              }\n            }\n          }\n        },\n        renderDelayedTemplates: function (change) {\n          this.callBase.apply(this, arguments);\n\n          this._renderFocusByChange(change);\n        },\n\n        _renderFocusByChange(change) {\n          var {\n            operationTypes: operationTypes,\n            repaintChangesOnly: repaintChangesOnly\n          } = null !== change && void 0 !== change ? change : {};\n          var {\n            fullReload: fullReload,\n            pageSize: pageSize\n          } = null !== operationTypes && void 0 !== operationTypes ? operationTypes : {};\n\n          if (!change || !repaintChangesOnly || fullReload || pageSize) {\n            var preventScroll = shouldPreventScroll(this);\n            this.renderFocusState({\n              preventScroll: preventScroll,\n              pageSizeChanged: pageSize\n            });\n          }\n        },\n\n        _renderCore: function (change) {\n          var deferred = this.callBase.apply(this, arguments);\n\n          this._renderFocusByChange(change);\n\n          return deferred;\n        },\n        _editCellPrepared: function ($cell) {\n          var editorInstance = this._getEditorInstance($cell);\n\n          var keyboardController = this.getController(\"keyboardNavigation\");\n\n          var isEditingNavigationMode = keyboardController && keyboardController._isFastEditingStarted();\n\n          if (editorInstance && isEditingNavigationMode) {\n            this._handleEditingNavigationMode(editorInstance);\n          }\n\n          this.callBase.apply(this, arguments);\n        },\n        _handleEditingNavigationMode: function (editorInstance) {\n          [\"downArrow\", \"upArrow\"].forEach(function (keyName) {\n            var originalKeyHandler = editorInstance._supportedKeys()[keyName];\n\n            editorInstance.registerKeyHandler(keyName, e => {\n              var isDropDownOpened = \"true\" === editorInstance._input().attr(\"aria-expanded\");\n\n              if (isDropDownOpened) {\n                return originalKeyHandler && originalKeyHandler.call(editorInstance, e);\n              }\n            });\n          });\n          editorInstance.registerKeyHandler(\"leftArrow\", noop);\n          editorInstance.registerKeyHandler(\"rightArrow\", noop);\n          var isDateBoxWithMask = editorInstance.NAME === DATEBOX_WIDGET_NAME && editorInstance.option(\"useMaskBehavior\");\n\n          if (isDateBoxWithMask) {\n            editorInstance.registerKeyHandler(\"enter\", noop);\n          }\n        },\n        _getEditorInstance: function ($cell) {\n          var $editor = $cell.find(\".dx-texteditor\").eq(0);\n          return gridCoreUtils.getWidgetInstance($editor);\n        }\n      }\n    },\n    controllers: {\n      editing: {\n        editCell: function (rowIndex, columnIndex) {\n          var keyboardController = this.getController(\"keyboardNavigation\");\n\n          if (keyboardController._processCanceledEditCellPosition(rowIndex, columnIndex)) {\n            return false;\n          }\n\n          var isCellEditing = this.callBase(rowIndex, columnIndex);\n\n          if (isCellEditing) {\n            keyboardController.setupFocusedView();\n          }\n\n          return isCellEditing;\n        },\n        editRow: function (rowIndex) {\n          var keyboardController = this.getController(\"keyboardNavigation\");\n          var visibleColumnIndex = keyboardController.getVisibleColumnIndex();\n\n          var column = this._columnsController.getVisibleColumns()[visibleColumnIndex];\n\n          if (column && column.type || this.option(\"editing.mode\") === EDIT_MODE_FORM) {\n            keyboardController._resetFocusedCell();\n          }\n\n          this.callBase(rowIndex);\n        },\n        addRow: function (parentKey) {\n          var keyboardController = this.getController(\"keyboardNavigation\");\n          keyboardController.setupFocusedView();\n          keyboardController.setCellFocusType();\n          return this.callBase.apply(this, arguments);\n        },\n        getFocusedCellInRow: function (rowIndex) {\n          var keyboardNavigationController = this.getController(\"keyboardNavigation\");\n          var $cell = this.callBase(rowIndex);\n\n          if (keyboardNavigationController.isKeyboardEnabled() && keyboardNavigationController._focusedCellPosition.rowIndex === rowIndex) {\n            var $focusedCell = keyboardNavigationController._getFocusedCell();\n\n            if (isElementDefined($focusedCell) && !$focusedCell.hasClass(COMMAND_EDIT_CLASS)) {\n              $cell = $focusedCell;\n            }\n          }\n\n          return $cell;\n        },\n        _processCanceledEditingCell: function () {\n          this.closeEditCell().done(() => {\n            var keyboardNavigation = this.getController(\"keyboardNavigation\");\n\n            keyboardNavigation._updateFocus();\n          });\n        },\n        init: function () {\n          this.callBase();\n          this._keyboardNavigationController = this.getController(\"keyboardNavigation\");\n        },\n        closeEditCell: function () {\n          var keyboardNavigation = this._keyboardNavigationController;\n          keyboardNavigation._fastEditingStarted = false;\n          var result = this.callBase.apply(this, arguments);\n\n          keyboardNavigation._updateFocus();\n\n          return result;\n        },\n        _delayedInputFocus: function () {\n          this._keyboardNavigationController._isNeedScroll = true;\n          this.callBase.apply(this, arguments);\n        },\n        _isEditingStart: function () {\n          var keyboardNavigation = this.getController(\"keyboardNavigation\");\n          var cancel = this.callBase.apply(this, arguments);\n\n          if (cancel && !keyboardNavigation._isNeedFocus) {\n            var $cell = keyboardNavigation._getFocusedCell();\n\n            keyboardNavigation._focus($cell, true);\n          }\n\n          return cancel;\n        }\n      },\n      data: {\n        _correctRowIndices: function (getRowIndexCorrection) {\n          var that = this;\n          var keyboardNavigationController = that.getController(\"keyboardNavigation\");\n          var editorFactory = that.getController(\"editorFactory\");\n          var focusedCellPosition = keyboardNavigationController._focusedCellPosition;\n          that.callBase.apply(that, arguments);\n\n          if (focusedCellPosition && focusedCellPosition.rowIndex >= 0) {\n            var focusedRowIndexCorrection = getRowIndexCorrection(focusedCellPosition.rowIndex);\n\n            if (focusedRowIndexCorrection) {\n              focusedCellPosition.rowIndex += focusedRowIndexCorrection;\n              editorFactory.refocus();\n            }\n          }\n        },\n        getMaxRowIndex: function () {\n          var result = this.items().length - 1;\n          var virtualItemsCount = this.virtualItemsCount();\n\n          if (virtualItemsCount) {\n            var rowIndexOffset = this.getRowIndexOffset();\n            result += rowIndexOffset + virtualItemsCount.end;\n          }\n\n          return result;\n        }\n      },\n      adaptiveColumns: {\n        _showHiddenCellsInView: function (_ref) {\n          var {\n            viewName: viewName,\n            $cells: $cells,\n            isCommandColumn: isCommandColumn\n          } = _ref;\n          this.callBase.apply(this, arguments);\n          viewName === COLUMN_HEADERS_VIEW && !isCommandColumn && $cells.each((_, cellElement) => {\n            var $cell = $(cellElement);\n            isCellInHeaderRow($cell) && $cell.attr(\"tabindex\", 0);\n          });\n        },\n        _hideVisibleCellInView: function (_ref2) {\n          var {\n            viewName: viewName,\n            $cell: $cell,\n            isCommandColumn: isCommandColumn\n          } = _ref2;\n          this.callBase.apply(this, arguments);\n\n          if (viewName === COLUMN_HEADERS_VIEW && !isCommandColumn && isCellInHeaderRow($cell)) {\n            $cell.removeAttr(\"tabindex\");\n          }\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["getOuterHeight","getHeight","getWidth","getOuterWidth","$","domAdapter","eventsEngine","core","gridCoreUtils","isDefined","isEmptyObject","focused","addNamespace","createEvent","isCommandKeyPressed","pointerEvents","name","clickEventName","noop","accessibility","browser","keyboard","devices","ROWS_VIEW_CLASS","EDIT_FORM_CLASS","GROUP_FOOTER_CLASS","ROW_CLASS","DATA_ROW_CLASS","GROUP_ROW_CLASS","HEADER_ROW_CLASS","EDIT_FORM_ITEM_CLASS","MASTER_DETAIL_ROW_CLASS","FREESPACE_ROW_CLASS","VIRTUAL_ROW_CLASS","MASTER_DETAIL_CELL_CLASS","EDITOR_CELL_CLASS","DROPDOWN_EDITOR_OVERLAY_CLASS","COMMAND_EXPAND_CLASS","COMMAND_SELECT_CLASS","COMMAND_EDIT_CLASS","COMMAND_CELL_SELECTOR","CELL_FOCUS_DISABLED_CLASS","DATEBOX_WIDGET_NAME","FOCUS_STATE_CLASS","WIDGET_CLASS","REVERT_BUTTON_CLASS","FAST_EDITING_DELETE_KEY","INTERACTIVE_ELEMENTS_SELECTOR","NON_FOCUSABLE_ELEMENTS_SELECTOR","concat","EDIT_MODE_ROW","EDIT_MODE_FORM","EDIT_MODE_BATCH","EDIT_MODE_CELL","FOCUS_TYPE_ROW","FOCUS_TYPE_CELL","COLUMN_HEADERS_VIEW","FUNCTIONAL_KEYS","isGroupRow","$row","hasClass","isDetailRow","isDataRow","isNotFocusedRow","isEditorCell","that","$cell","_isRowEditMode","isElementDefined","$element","length","isMobile","current","deviceType","isCellInHeaderRow","parent","isFixedColumnIndexOffsetRequired","column","rtlEnabled","option","result","fixedPosition","command","shouldPreventScroll","keyboardController","getController","_isVirtualScrolling","getRowIndex","keyboardNavigationMembers","init","_dataController","_selectionController","_editingController","_headerPanel","getView","_columnsController","_editorFactory","isKeyboardEnabled","subscribeVisibilityChange","_updateFocusTimeout","_fastEditingStarted","_focusedCellPosition","_canceledCellPosition","add","setupFocusedView","_isNeedScroll","is","_focusedView","getScrollable","_scrollToElement","_initViewHandlers","_initDocumentHandlers","createAction","rowsView","rowsViewFocusHandler","event","target","isRelatedTargetInRowsView","relatedTarget","closest","element","isLink","_isEventInCurrentGrid","$focusedCell","_getFocusedCell","getCellElements","filter","eq","preventDefault","trigger","renderCompleted","e","$rowsView","isFullUpdate","changeType","isFocusedViewCorrect","needUpdateFocus","isAppend","root","getRootNode","get","$focusedElement","find","isFocusedElementCorrect","off","on","_initPointerEventHandler","_initKeyDownHandler","_setRowsViewAttributes","_isNeedFocus","_isHiddenFocus","virtualColumnsScrolling","_updateFocus","document","getDocument","_documentClickHandler","$target","isCurrentRowsViewClick","addWidgetPrefix","isEditorOverlay","columnsResizerController","isColumnResizing","isResizing","targetInsideFocusedView","parents","_resetFocusedCell","_resetFocusedView","down","_getRowsViewElement","isGridEmpty","getVisibleRows","_applyTabIndexToElement","pointerEventName","clickSelector","_pointerEventAction","_pointerEventHandler","_keyDownListener","_keyDownHandler","dispose","callBase","clearTimeout","unsubscribeVisibilityChange","optionChanged","args","handled","isRowFocusType","focusType","isCellFocusType","setRowFocusType","setCellFocusType","_this$_editingControl","needStopPropagation","isHandled","_processOnKeyDown","isEditing","originalEvent","isDefaultPrevented","indexOf","keyName","_updateFocusedCellPositionByTarget","_leftRightKeysHandler","ctrl","selectView","_upDownKeysHandler","_pageUpDownKeyHandler","_spaceKeyHandler","_ctrlAKeyHandler","_beginFastEditing","_tabKeyHandler","_enterKeyHandler","_escapeKeyHandler","_ctrlFKeyHandler","_f2KeyHandler","_isFastEditingAllowed","_isFastEditingStarted","stopPropagation","eventArgs","executeAction","ctrlKey","alt","altKey","shift","shiftKey","_closeEditCell","setTimeout","closeEditCell","rowIndex","getVisibleRowIndex","$event","getRow","directionCode","_getDirectionCodeByKey","isEditingNavigationMode","allowNavigate","_isVirtualColumnRender","_processVirtualHorizontalPosition","_getNextCell","_arrowKeysHandlerFocusCell","_this$_editingControl2","_this$_editingControl3","visibleRowIndex","isUpArrow","dataSource","isRowEditingInCurrentRow","isEditRowByIndex","call","_navigateNextCell","_isVirtualRowRender","isLoading","rowHeight","_scrollBy","pageIndex","pageCount","pagingEnabled","isPageUp","pageStep","scrollable","container","$content","mode","isFocusedRowElement","_getElementType","isFocusedSelectionCell","startSelectionWithCheckboxes","changeItemSelection","control","selectAll","editingOptions","direction","isCellPositionDefined","isOriginalHandlerRequired","_isLastValidCell","_isFirstValidCell","eventTarget","focusedViewElement","_handleTabKeyOnMasterDetailCell","addClass","_editingCellTabHandler","_targetCellTabHandler","loseFocus","_getMaxHorizontalOffset","component","offset","scrollWidth","_isColumnRendered","columnIndex","allVisibleColumns","getVisibleColumns","renderedVisibleColumns","_isFixedColumn","fixed","_isColumnVirtual","localColumnIndex","getColumnIndexOffset","visibleColumns","getColumnIndex","nextColumnIndex","horizontalScrollPosition","needToScroll","columnsCount","_getVisibleColumnCount","columnIndexOffset","leftEdgePosition","scrollTo","left","_getHorizontalScrollPositionOffset","scrollBy","top","positionOffset","$currentCell","_getCell","currentCellWidth","rtlMultiplier","_getCellElementFromTarget","isEditingAllowed","elementType","_updateFocusedCellPosition","nextCellInfo","_getNextCellByTabKey","columnsController","cellIndex","getCellIndex","_getRowIndex","row","items","editingController","allowEditing","_isDataRow","rowType","allowUpdating","isNewRow","_focusCell","isHighlighted","_editFocusedCell","_focusInteractiveElement","$lastInteractiveElement","_getInteractiveElement","getFirstValidCellInRow","_checkNewLineTransition","_fireFocusedCellChanging","cancel","$newCellElement","cellPosition","_getCellPosition","_fireFocusedRowChanging","rowIndexChanged","setFocusedColumnIndex","key","getKeyByRowIndex","item","data","isContinuation","changeRowExpand","_processEnterKeyForDataCell","_getEnterKeyDirection","allowEditingOnEnterKey","_allowEditingOnEnterKey","_handleEnterKeyEditingCell","_startEditing","enterKeyDirection","isShift","isRowEditMode","_focusEditFormCell","saveEditData","bind","getEditMode","cancelEditData","searchTextEditor","getSearchTextEditor","focus","keyCode","isCellValid","_isCellValid","$nextCell","isVerticalDirection","_fireFocusChangingEvents","_focus","isDeleting","which","fastEditingKey","String","fromCharCode","currentTarget","$parent","isInteractiveElement","isRevertButton","isExpandCommandCell","_isInsideEditForm","_focusView","removeClass","_isMasterDetailCell","_clickTargetCellHandler","isCellEditMode","_isCellEditMode","resetFocusedRow","_resetFocusedRow","_allowRowUpdating","skipFocusEvent","not","isEditor","isDisabled","setFocusedRowIndex","prevRowIndex","activeElementSelector","focusedRowEnabled","_isCellElement","first","_focusElement","getFocusedView","rowsViewElement","$focusedView","_getFocusedViewByElement","view","$view","isLast","focusAndSelectElement","disableFocus","focusedView","$focusViewElement","$focusElement","isRowFocus","removeAttr","one","isRenderView","isBatchEditMode","hasChanges","isNewRowInEditMode","_focusEditingCell","_hasSkipRow","isCommandCell","$focusedElementInsideCell","isFocusedElementDefined","_this$_focusedCellPos","position","setFocusedCellPosition","_getFocusedColumnIndexOffset","_getFixedColumnIndexOffset","_applyColumnIndexBoundaries","preventScroll","_this$_focusedView","renderFocusState","restoreFocusableElement","$rowElement","$rowsViewElement","rowIndexOffset","getRowIndexOffset","getTopVisibleItemIndex","newRowIndex","_getNewPositionByCode","code","visibleColumnsCount","_hasValidCellAfterPosition","_isLastRow","_hasValidCellBeforePosition","getVisibleColumnIndex","_isCellByPositionValid","dataController","visibleItems","visible","getMaxRowIndex","isFirstValidCell","hasValidCells","checkingPosition","visibleColumnCount","visibleRows","isLastRow","isClick","isMasterDetailRow","isShowWhenGrouped","showWhenGrouped","isDataCell","groupIndex","parseInt","attr","rowItems","isCellEditing","isEditRow","_isLegacyNavigation","$cells","$result","i","focusedCellPosition","includeCommandCells","includes","newFocusedCellPosition","isLastCellOnDirection","_isCellInRow","visibleColumnIndex","_isAllowEditing","editRow","_startEditCell","colIndex","editCell","editResult","_editingCellHandler","done","editorValue","_$input$get$select","_$input$get","$input","keyDownEvent","type","keyPressEvent","inputEvent","select","timeout","mozilla","val","$widgetContainer","fireRowEvent","newColumnIndex","$cellElement","prevCellIndex","cellElement","prevColumnIndex","rows","columns","_fireFocusedCellChanged","localRowIndex","Math","min","isEditingCell","isEditCell","$newFocusedRow","prevFocusedRowIndex","loadingOperationTypes","rowElement","reload","paging","_fireFocusedRowChanged","focusedRowKey","focusController","focusedRowIndex","getFocusedRowIndexByKey","isElementInCurrentGrid","editMode","last","tabIndex","getCell","style","display","scrollingMode","isVirtualRowRendering","scrollHandler","$editForm","elementIsInsideGrid","$masterDetailCell","_processNextCellInMasterDetail","tagName","$targetElement","children","_processCanceledEditCellPosition","isCanceled","updateFocusedRowIndex","lastVisibleIndex","KeyboardNavigationController","ViewController","inherit","keyboardNavigationModule","defaultOptions","useLegacyKeyboardNavigation","keyboardNavigation","enabled","enterKeyAction","editOnKeyPress","controllers","extenders","views","_rowClick","editRowIndex","getEditRowIndex","needTriggerPointerEventHandler","_triggerPointerDownEventHandler","apply","arguments","force","params","pageSizeChanged","cellElements","updateFocusElementTabIndex","_updateFocusedCellTabIndex","cellElementsLength","updateCellTabIndex","isMasterDetailCell","isValidCell","renderDelayedTemplates","change","_renderFocusByChange","operationTypes","repaintChangesOnly","fullReload","pageSize","_renderCore","deferred","_editCellPrepared","editorInstance","_getEditorInstance","_handleEditingNavigationMode","forEach","originalKeyHandler","_supportedKeys","registerKeyHandler","isDropDownOpened","_input","isDateBoxWithMask","NAME","$editor","getWidgetInstance","editing","addRow","parentKey","getFocusedCellInRow","keyboardNavigationController","_processCanceledEditingCell","_keyboardNavigationController","_delayedInputFocus","_isEditingStart","_correctRowIndices","getRowIndexCorrection","editorFactory","focusedRowIndexCorrection","refocus","virtualItemsCount","end","adaptiveColumns","_showHiddenCellsInView","_ref","viewName","isCommandColumn","each","_","_hideVisibleCellInView","_ref2"],"sources":["D:/APPLICATION/UI/UPL/NEW/node_modules/devextreme/esm/ui/grid_core/ui.grid_core.keyboard_navigation.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/grid_core/ui.grid_core.keyboard_navigation.js)\r\n * Version: 22.2.4\r\n * Build date: Thu Jan 19 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    getOuterHeight,\r\n    getHeight,\r\n    getWidth,\r\n    getOuterWidth\r\n} from \"../../core/utils/size\";\r\nimport $ from \"../../core/renderer\";\r\nimport domAdapter from \"../../core/dom_adapter\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport core from \"./ui.grid_core.modules\";\r\nimport gridCoreUtils from \"./ui.grid_core.utils\";\r\nimport {\r\n    isDefined,\r\n    isEmptyObject\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    focused\r\n} from \"../widget/selectors\";\r\nimport {\r\n    addNamespace,\r\n    createEvent,\r\n    isCommandKeyPressed\r\n} from \"../../events/utils/index\";\r\nimport pointerEvents from \"../../events/pointer\";\r\nimport {\r\n    name as clickEventName\r\n} from \"../../events/click\";\r\nimport {\r\n    noop\r\n} from \"../../core/utils/common\";\r\nimport * as accessibility from \"../shared/accessibility\";\r\nimport browser from \"../../core/utils/browser\";\r\nimport {\r\n    keyboard\r\n} from \"../../events/short\";\r\nimport devices from \"../../core/devices\";\r\nvar ROWS_VIEW_CLASS = \"rowsview\";\r\nvar EDIT_FORM_CLASS = \"edit-form\";\r\nvar GROUP_FOOTER_CLASS = \"group-footer\";\r\nvar ROW_CLASS = \"dx-row\";\r\nvar DATA_ROW_CLASS = \"dx-data-row\";\r\nvar GROUP_ROW_CLASS = \"dx-group-row\";\r\nvar HEADER_ROW_CLASS = \"dx-header-row\";\r\nvar EDIT_FORM_ITEM_CLASS = \"edit-form-item\";\r\nvar MASTER_DETAIL_ROW_CLASS = \"dx-master-detail-row\";\r\nvar FREESPACE_ROW_CLASS = \"dx-freespace-row\";\r\nvar VIRTUAL_ROW_CLASS = \"dx-virtual-row\";\r\nvar MASTER_DETAIL_CELL_CLASS = \"dx-master-detail-cell\";\r\nvar EDITOR_CELL_CLASS = \"dx-editor-cell\";\r\nvar DROPDOWN_EDITOR_OVERLAY_CLASS = \"dx-dropdowneditor-overlay\";\r\nvar COMMAND_EXPAND_CLASS = \"dx-command-expand\";\r\nvar COMMAND_SELECT_CLASS = \"dx-command-select\";\r\nvar COMMAND_EDIT_CLASS = \"dx-command-edit\";\r\nvar COMMAND_CELL_SELECTOR = \"[class^=dx-command]\";\r\nvar CELL_FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\r\nvar DATEBOX_WIDGET_NAME = \"dxDateBox\";\r\nvar FOCUS_STATE_CLASS = \"dx-state-focused\";\r\nvar WIDGET_CLASS = \"dx-widget\";\r\nvar REVERT_BUTTON_CLASS = \"dx-revert-button\";\r\nvar FAST_EDITING_DELETE_KEY = \"delete\";\r\nvar INTERACTIVE_ELEMENTS_SELECTOR = \"input:not([type='hidden']), textarea, a, select, button, [tabindex], .dx-checkbox\";\r\nvar NON_FOCUSABLE_ELEMENTS_SELECTOR = \"\".concat(INTERACTIVE_ELEMENTS_SELECTOR, \", .dx-dropdowneditor-icon\");\r\nvar EDIT_MODE_ROW = \"row\";\r\nvar EDIT_MODE_FORM = \"form\";\r\nvar EDIT_MODE_BATCH = \"batch\";\r\nvar EDIT_MODE_CELL = \"cell\";\r\nvar FOCUS_TYPE_ROW = \"row\";\r\nvar FOCUS_TYPE_CELL = \"cell\";\r\nvar COLUMN_HEADERS_VIEW = \"columnHeadersView\";\r\nvar FUNCTIONAL_KEYS = [\"shift\", \"control\", \"alt\"];\r\n\r\nfunction isGroupRow($row) {\r\n    return $row && $row.hasClass(GROUP_ROW_CLASS)\r\n}\r\n\r\nfunction isDetailRow($row) {\r\n    return $row && $row.hasClass(MASTER_DETAIL_ROW_CLASS)\r\n}\r\n\r\nfunction isDataRow($row) {\r\n    return $row && !isGroupRow($row) && !isDetailRow($row)\r\n}\r\n\r\nfunction isNotFocusedRow($row) {\r\n    return !$row || $row.hasClass(FREESPACE_ROW_CLASS) || $row.hasClass(VIRTUAL_ROW_CLASS)\r\n}\r\n\r\nfunction isEditorCell(that, $cell) {\r\n    return !that._isRowEditMode() && $cell && !$cell.hasClass(COMMAND_SELECT_CLASS) && $cell.hasClass(EDITOR_CELL_CLASS)\r\n}\r\n\r\nfunction isElementDefined($element) {\r\n    return isDefined($element) && $element.length > 0\r\n}\r\n\r\nfunction isMobile() {\r\n    return \"desktop\" !== devices.current().deviceType\r\n}\r\n\r\nfunction isCellInHeaderRow($cell) {\r\n    return !!$cell.parent(\".\".concat(HEADER_ROW_CLASS)).length\r\n}\r\n\r\nfunction isFixedColumnIndexOffsetRequired(that, column) {\r\n    var rtlEnabled = that.option(\"rtlEnabled\");\r\n    var result = false;\r\n    if (rtlEnabled) {\r\n        result = !(\"right\" === column.fixedPosition || isDefined(column.command) && !isDefined(column.fixedPosition))\r\n    } else {\r\n        result = !(!isDefined(column.fixedPosition) || \"left\" === column.fixedPosition)\r\n    }\r\n    return result\r\n}\r\n\r\nfunction shouldPreventScroll(that) {\r\n    var keyboardController = that.getController(\"keyboardNavigation\");\r\n    return keyboardController._isVirtualScrolling() ? that.option(\"focusedRowIndex\") === keyboardController.getRowIndex() : false\r\n}\r\nvar keyboardNavigationMembers = {\r\n    init: function() {\r\n        this._dataController = this.getController(\"data\");\r\n        this._selectionController = this.getController(\"selection\");\r\n        this._editingController = this.getController(\"editing\");\r\n        this._headerPanel = this.getView(\"headerPanel\");\r\n        this._columnsController = this.getController(\"columns\");\r\n        this._editorFactory = this.getController(\"editorFactory\");\r\n        if (this.isKeyboardEnabled()) {\r\n            accessibility.subscribeVisibilityChange();\r\n            this._updateFocusTimeout = null;\r\n            this._fastEditingStarted = false;\r\n            this._focusedCellPosition = {};\r\n            this._canceledCellPosition = null;\r\n            this._editorFactory.focused.add($element => {\r\n                this.setupFocusedView();\r\n                if (this._isNeedScroll) {\r\n                    if ($element.is(\":visible\") && this._focusedView && this._focusedView.getScrollable) {\r\n                        this._focusedView._scrollToElement($element);\r\n                        this._isNeedScroll = false\r\n                    }\r\n                }\r\n            });\r\n            this._initViewHandlers();\r\n            this._initDocumentHandlers();\r\n            this.createAction(\"onKeyDown\")\r\n        }\r\n    },\r\n    _initViewHandlers: function() {\r\n        var rowsView = this.getView(\"rowsView\");\r\n        var rowsViewFocusHandler = event => {\r\n            var $element = $(event.target);\r\n            var isRelatedTargetInRowsView = $(event.relatedTarget).closest(rowsView.element()).length;\r\n            var isLink = $element.is(\"a\");\r\n            if (event.relatedTarget && isLink && !isRelatedTargetInRowsView && this._isEventInCurrentGrid(event)) {\r\n                var $focusedCell = this._getFocusedCell();\r\n                $focusedCell = !isElementDefined($focusedCell) ? rowsView.getCellElements(0).filter(\"[tabindex]\").eq(0) : $focusedCell;\r\n                if (!$element.closest($focusedCell).length) {\r\n                    event.preventDefault();\r\n                    eventsEngine.trigger($focusedCell, \"focus\")\r\n                }\r\n            }\r\n        };\r\n        rowsView.renderCompleted.add(e => {\r\n            var $rowsView = rowsView.element();\r\n            var isFullUpdate = !e || \"refresh\" === e.changeType;\r\n            var isFocusedViewCorrect = this._focusedView && this._focusedView.name === rowsView.name;\r\n            var needUpdateFocus = false;\r\n            var isAppend = e && (\"append\" === e.changeType || \"prepend\" === e.changeType);\r\n            var root = $(domAdapter.getRootNode($rowsView.get && $rowsView.get(0)));\r\n            var $focusedElement = root.find(\":focus\");\r\n            var isFocusedElementCorrect = !$focusedElement.length || $focusedElement.closest($rowsView).length;\r\n            eventsEngine.off($rowsView, \"focusin\", rowsViewFocusHandler);\r\n            eventsEngine.on($rowsView, \"focusin\", rowsViewFocusHandler);\r\n            this._initPointerEventHandler();\r\n            this._initKeyDownHandler();\r\n            this._setRowsViewAttributes();\r\n            if (isFocusedViewCorrect && isFocusedElementCorrect) {\r\n                needUpdateFocus = this._isNeedFocus ? !isAppend : this._isHiddenFocus && isFullUpdate && !(null !== e && void 0 !== e && e.virtualColumnsScrolling);\r\n                needUpdateFocus && this._updateFocus(true)\r\n            }\r\n        })\r\n    },\r\n    _initDocumentHandlers: function() {\r\n        var document = domAdapter.getDocument();\r\n        this._documentClickHandler = this.createAction(e => {\r\n            var $target = $(e.event.target);\r\n            var isCurrentRowsViewClick = this._isEventInCurrentGrid(e.event) && $target.closest(\".\".concat(this.addWidgetPrefix(ROWS_VIEW_CLASS))).length;\r\n            var isEditorOverlay = $target.closest(\".\".concat(DROPDOWN_EDITOR_OVERLAY_CLASS)).length;\r\n            var columnsResizerController = this.getController(\"columnsResizer\");\r\n            var isColumnResizing = !!columnsResizerController && columnsResizerController.isResizing();\r\n            if (!isCurrentRowsViewClick && !isEditorOverlay && !isColumnResizing) {\r\n                var targetInsideFocusedView = this._focusedView ? $target.parents().filter(this._focusedView.element()).length > 0 : false;\r\n                !targetInsideFocusedView && this._resetFocusedCell(true);\r\n                this._resetFocusedView()\r\n            }\r\n        });\r\n        eventsEngine.on(document, addNamespace(pointerEvents.down, \"dxDataGridKeyboardNavigation\"), this._documentClickHandler)\r\n    },\r\n    _setRowsViewAttributes: function() {\r\n        var $rowsView = this._getRowsViewElement();\r\n        var isGridEmpty = !this._dataController.getVisibleRows().length;\r\n        if (isGridEmpty) {\r\n            this._applyTabIndexToElement($rowsView)\r\n        }\r\n    },\r\n    _initPointerEventHandler: function() {\r\n        var pointerEventName = !isMobile() ? pointerEvents.down : clickEventName;\r\n        var clickSelector = \".\".concat(ROW_CLASS, \" > td, .\").concat(ROW_CLASS);\r\n        var $rowsView = this._getRowsViewElement();\r\n        if (!isDefined(this._pointerEventAction)) {\r\n            this._pointerEventAction = this.createAction(this._pointerEventHandler)\r\n        }\r\n        eventsEngine.off($rowsView, addNamespace(pointerEventName, \"dxDataGridKeyboardNavigation\"), this._pointerEventAction);\r\n        eventsEngine.on($rowsView, addNamespace(pointerEventName, \"dxDataGridKeyboardNavigation\"), clickSelector, this._pointerEventAction)\r\n    },\r\n    _initKeyDownHandler: function() {\r\n        var $rowsView = this._getRowsViewElement();\r\n        keyboard.off(this._keyDownListener);\r\n        this._keyDownListener = keyboard.on($rowsView, null, e => this._keyDownHandler(e))\r\n    },\r\n    dispose: function() {\r\n        this.callBase();\r\n        this._resetFocusedView();\r\n        keyboard.off(this._keyDownListener);\r\n        eventsEngine.off(domAdapter.getDocument(), addNamespace(pointerEvents.down, \"dxDataGridKeyboardNavigation\"), this._documentClickHandler);\r\n        clearTimeout(this._updateFocusTimeout);\r\n        accessibility.unsubscribeVisibilityChange()\r\n    },\r\n    optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"keyboardNavigation\":\r\n            case \"useLegacyKeyboardNavigation\":\r\n                args.handled = true;\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    isRowFocusType: function() {\r\n        return this.focusType === FOCUS_TYPE_ROW\r\n    },\r\n    isCellFocusType: function() {\r\n        return this.focusType === FOCUS_TYPE_CELL\r\n    },\r\n    setRowFocusType: function() {\r\n        if (this.option(\"focusedRowEnabled\")) {\r\n            this.focusType = FOCUS_TYPE_ROW\r\n        }\r\n    },\r\n    setCellFocusType: function() {\r\n        this.focusType = FOCUS_TYPE_CELL\r\n    },\r\n    _keyDownHandler: function(e) {\r\n        var _this$_editingControl;\r\n        var needStopPropagation = true;\r\n        this._isNeedFocus = true;\r\n        this._isNeedScroll = true;\r\n        var isHandled = this._processOnKeyDown(e);\r\n        var isEditing = null === (_this$_editingControl = this._editingController) || void 0 === _this$_editingControl ? void 0 : _this$_editingControl.isEditing();\r\n        var originalEvent = e.originalEvent;\r\n        if (originalEvent.isDefaultPrevented()) {\r\n            this._isNeedFocus = false;\r\n            this._isNeedScroll = false;\r\n            return\r\n        }\r\n        FUNCTIONAL_KEYS.indexOf(e.keyName) < 0 && this._updateFocusedCellPositionByTarget(originalEvent.target);\r\n        if (!isHandled) {\r\n            switch (e.keyName) {\r\n                case \"leftArrow\":\r\n                case \"rightArrow\":\r\n                    this._leftRightKeysHandler(e, isEditing);\r\n                    isHandled = true;\r\n                    break;\r\n                case \"upArrow\":\r\n                case \"downArrow\":\r\n                    if (e.ctrl) {\r\n                        accessibility.selectView(\"rowsView\", this, originalEvent)\r\n                    } else {\r\n                        this._upDownKeysHandler(e, isEditing)\r\n                    }\r\n                    isHandled = true;\r\n                    break;\r\n                case \"pageUp\":\r\n                case \"pageDown\":\r\n                    this._pageUpDownKeyHandler(e);\r\n                    isHandled = true;\r\n                    break;\r\n                case \"space\":\r\n                    isHandled = this._spaceKeyHandler(e, isEditing);\r\n                    break;\r\n                case \"A\":\r\n                    if (isCommandKeyPressed(e.originalEvent)) {\r\n                        this._ctrlAKeyHandler(e, isEditing);\r\n                        isHandled = true\r\n                    } else {\r\n                        isHandled = this._beginFastEditing(e.originalEvent)\r\n                    }\r\n                    break;\r\n                case \"tab\":\r\n                    this._tabKeyHandler(e, isEditing);\r\n                    isHandled = true;\r\n                    break;\r\n                case \"enter\":\r\n                    this._enterKeyHandler(e, isEditing);\r\n                    isHandled = true;\r\n                    break;\r\n                case \"escape\":\r\n                    this._escapeKeyHandler(e, isEditing);\r\n                    isHandled = true;\r\n                    break;\r\n                case \"F\":\r\n                    if (isCommandKeyPressed(e.originalEvent)) {\r\n                        this._ctrlFKeyHandler(e);\r\n                        isHandled = true\r\n                    } else {\r\n                        isHandled = this._beginFastEditing(e.originalEvent)\r\n                    }\r\n                    break;\r\n                case \"F2\":\r\n                    this._f2KeyHandler();\r\n                    isHandled = true;\r\n                    break;\r\n                case \"del\":\r\n                case \"backspace\":\r\n                    if (this._isFastEditingAllowed() && !this._isFastEditingStarted()) {\r\n                        isHandled = this._beginFastEditing(originalEvent, true)\r\n                    }\r\n            }\r\n            if (!isHandled && !this._beginFastEditing(originalEvent)) {\r\n                this._isNeedFocus = false;\r\n                this._isNeedScroll = false;\r\n                needStopPropagation = false\r\n            }\r\n            if (needStopPropagation) {\r\n                originalEvent.stopPropagation()\r\n            }\r\n        }\r\n    },\r\n    _processOnKeyDown: function(eventArgs) {\r\n        var originalEvent = eventArgs.originalEvent;\r\n        var args = {\r\n            handled: false,\r\n            event: originalEvent\r\n        };\r\n        this.executeAction(\"onKeyDown\", args);\r\n        eventArgs.ctrl = originalEvent.ctrlKey;\r\n        eventArgs.alt = originalEvent.altKey;\r\n        eventArgs.shift = originalEvent.shiftKey;\r\n        return !!args.handled\r\n    },\r\n    _closeEditCell: function() {\r\n        setTimeout(() => {\r\n            this._editingController.closeEditCell()\r\n        })\r\n    },\r\n    _leftRightKeysHandler: function(eventArgs, isEditing) {\r\n        var rowIndex = this.getVisibleRowIndex();\r\n        var $event = eventArgs.originalEvent;\r\n        var $row = this._focusedView && this._focusedView.getRow(rowIndex);\r\n        var directionCode = this._getDirectionCodeByKey(eventArgs.keyName);\r\n        var isEditingNavigationMode = this._isFastEditingStarted();\r\n        var allowNavigate = (!isEditing || isEditingNavigationMode) && isDataRow($row);\r\n        if (allowNavigate) {\r\n            this.setCellFocusType();\r\n            isEditingNavigationMode && this._closeEditCell();\r\n            if (this._isVirtualColumnRender()) {\r\n                this._processVirtualHorizontalPosition(directionCode)\r\n            }\r\n            var $cell = this._getNextCell(directionCode);\r\n            if (isElementDefined($cell)) {\r\n                this._arrowKeysHandlerFocusCell($event, $cell, directionCode)\r\n            }\r\n            $event && $event.preventDefault()\r\n        }\r\n    },\r\n    _upDownKeysHandler: function(eventArgs, isEditing) {\r\n        var _this$_editingControl2, _this$_editingControl3;\r\n        var visibleRowIndex = this.getVisibleRowIndex();\r\n        var $row = this._focusedView && this._focusedView.getRow(visibleRowIndex);\r\n        var $event = eventArgs.originalEvent;\r\n        var isUpArrow = \"upArrow\" === eventArgs.keyName;\r\n        var dataSource = this._dataController.dataSource();\r\n        var isRowEditingInCurrentRow = null === (_this$_editingControl2 = this._editingController) || void 0 === _this$_editingControl2 ? void 0 : null === (_this$_editingControl3 = _this$_editingControl2.isEditRowByIndex) || void 0 === _this$_editingControl3 ? void 0 : _this$_editingControl3.call(_this$_editingControl2, visibleRowIndex);\r\n        var isEditingNavigationMode = this._isFastEditingStarted();\r\n        var allowNavigate = (!isRowEditingInCurrentRow || !isEditing || isEditingNavigationMode) && $row && !isDetailRow($row);\r\n        if (allowNavigate) {\r\n            isEditingNavigationMode && this._closeEditCell();\r\n            if (!this._navigateNextCell($event, eventArgs.keyName)) {\r\n                if (this._isVirtualRowRender() && isUpArrow && dataSource && !dataSource.isLoading()) {\r\n                    var rowHeight = getOuterHeight($row);\r\n                    var rowIndex = this._focusedCellPosition.rowIndex - 1;\r\n                    this._scrollBy(0, -rowHeight, rowIndex, $event)\r\n                }\r\n            }\r\n            $event && $event.preventDefault()\r\n        }\r\n    },\r\n    _pageUpDownKeyHandler: function(eventArgs) {\r\n        var pageIndex = this._dataController.pageIndex();\r\n        var pageCount = this._dataController.pageCount();\r\n        var pagingEnabled = this.option(\"paging.enabled\");\r\n        var isPageUp = \"pageUp\" === eventArgs.keyName;\r\n        var pageStep = isPageUp ? -1 : 1;\r\n        var scrollable = this.getView(\"rowsView\").getScrollable();\r\n        if (pagingEnabled && !this._isVirtualScrolling()) {\r\n            if ((isPageUp ? pageIndex > 0 : pageIndex < pageCount - 1) && !this._isVirtualScrolling()) {\r\n                this._dataController.pageIndex(pageIndex + pageStep);\r\n                eventArgs.originalEvent.preventDefault()\r\n            }\r\n        } else if (scrollable && getHeight(scrollable.container()) < getHeight(scrollable.$content())) {\r\n            this._scrollBy(0, getHeight(scrollable.container()) * pageStep);\r\n            eventArgs.originalEvent.preventDefault()\r\n        }\r\n    },\r\n    _spaceKeyHandler: function(eventArgs, isEditing) {\r\n        var rowIndex = this.getVisibleRowIndex();\r\n        var $target = $(eventArgs.originalEvent && eventArgs.originalEvent.target);\r\n        if (this.option(\"selection\") && \"none\" !== this.option(\"selection\").mode && !isEditing) {\r\n            var isFocusedRowElement = \"row\" === this._getElementType($target) && this.isRowFocusType() && isDataRow($target);\r\n            var isFocusedSelectionCell = $target.hasClass(COMMAND_SELECT_CLASS);\r\n            if (isFocusedSelectionCell && \"onClick\" === this.option(\"selection.showCheckBoxesMode\")) {\r\n                this._selectionController.startSelectionWithCheckboxes()\r\n            }\r\n            if (isFocusedRowElement || $target.parent().hasClass(DATA_ROW_CLASS) || $target.hasClass(this.addWidgetPrefix(ROWS_VIEW_CLASS))) {\r\n                this._selectionController.changeItemSelection(rowIndex, {\r\n                    shift: eventArgs.shift,\r\n                    control: eventArgs.ctrl\r\n                });\r\n                eventArgs.originalEvent.preventDefault();\r\n                return true\r\n            }\r\n            return false\r\n        } else {\r\n            return this._beginFastEditing(eventArgs.originalEvent)\r\n        }\r\n    },\r\n    _ctrlAKeyHandler: function(eventArgs, isEditing) {\r\n        if (!isEditing && !eventArgs.alt && \"multiple\" === this.option(\"selection.mode\") && this.option(\"selection.allowSelectAll\")) {\r\n            this._selectionController.selectAll();\r\n            eventArgs.originalEvent.preventDefault()\r\n        }\r\n    },\r\n    _tabKeyHandler: function(eventArgs, isEditing) {\r\n        var editingOptions = this.option(\"editing\");\r\n        var direction = eventArgs.shift ? \"previous\" : \"next\";\r\n        var isCellPositionDefined = isDefined(this._focusedCellPosition) && !isEmptyObject(this._focusedCellPosition);\r\n        var isOriginalHandlerRequired = !isCellPositionDefined || !eventArgs.shift && this._isLastValidCell(this._focusedCellPosition) || eventArgs.shift && this._isFirstValidCell(this._focusedCellPosition);\r\n        var eventTarget = eventArgs.originalEvent.target;\r\n        var focusedViewElement = this._focusedView && this._focusedView.element();\r\n        if (this._handleTabKeyOnMasterDetailCell(eventTarget, direction)) {\r\n            return\r\n        }\r\n        $(focusedViewElement).addClass(FOCUS_STATE_CLASS);\r\n        if (editingOptions && eventTarget && !isOriginalHandlerRequired) {\r\n            if ($(eventTarget).hasClass(this.addWidgetPrefix(ROWS_VIEW_CLASS))) {\r\n                this._resetFocusedCell()\r\n            }\r\n            if (this._isVirtualColumnRender()) {\r\n                this._processVirtualHorizontalPosition(direction)\r\n            }\r\n            if (isEditing) {\r\n                if (!this._editingCellTabHandler(eventArgs, direction)) {\r\n                    return\r\n                }\r\n            } else if (this._targetCellTabHandler(eventArgs, direction)) {\r\n                isOriginalHandlerRequired = true\r\n            }\r\n        }\r\n        if (isOriginalHandlerRequired) {\r\n            this._editorFactory.loseFocus();\r\n            if (this._editingController.isEditing() && !this._isRowEditMode()) {\r\n                this._resetFocusedCell(true);\r\n                this._resetFocusedView();\r\n                this._closeEditCell()\r\n            }\r\n        } else {\r\n            eventArgs.originalEvent.preventDefault()\r\n        }\r\n    },\r\n    _getMaxHorizontalOffset: function() {\r\n        var scrollable = this.component.getScrollable();\r\n        var rowsView = this.getView(\"rowsView\");\r\n        var offset = scrollable ? scrollable.scrollWidth() - getWidth(rowsView.element()) : 0;\r\n        return offset\r\n    },\r\n    _isColumnRendered: function(columnIndex) {\r\n        var allVisibleColumns = this._columnsController.getVisibleColumns(null, true);\r\n        var renderedVisibleColumns = this._columnsController.getVisibleColumns();\r\n        var column = allVisibleColumns[columnIndex];\r\n        var result = false;\r\n        if (column) {\r\n            result = renderedVisibleColumns.indexOf(column) >= 0\r\n        }\r\n        return result\r\n    },\r\n    _isFixedColumn: function(columnIndex) {\r\n        var allVisibleColumns = this._columnsController.getVisibleColumns(null, true);\r\n        var column = allVisibleColumns[columnIndex];\r\n        return !!column && !!column.fixed\r\n    },\r\n    _isColumnVirtual: function(columnIndex) {\r\n        var localColumnIndex = columnIndex - this._columnsController.getColumnIndexOffset();\r\n        var visibleColumns = this._columnsController.getVisibleColumns();\r\n        var column = visibleColumns[localColumnIndex];\r\n        return !!column && \"virtual\" === column.command\r\n    },\r\n    _processVirtualHorizontalPosition: function(direction) {\r\n        var scrollable = this.component.getScrollable();\r\n        var columnIndex = this.getColumnIndex();\r\n        var nextColumnIndex;\r\n        var horizontalScrollPosition = 0;\r\n        var needToScroll = false;\r\n        switch (direction) {\r\n            case \"next\":\r\n            case \"nextInRow\":\r\n                var columnsCount = this._getVisibleColumnCount();\r\n                nextColumnIndex = columnIndex + 1;\r\n                horizontalScrollPosition = this.option(\"rtlEnabled\") ? this._getMaxHorizontalOffset() : 0;\r\n                if (\"next\" === direction) {\r\n                    needToScroll = columnsCount === nextColumnIndex || this._isFixedColumn(columnIndex) && !this._isColumnRendered(nextColumnIndex)\r\n                } else {\r\n                    needToScroll = columnsCount > nextColumnIndex && this._isFixedColumn(columnIndex) && !this._isColumnRendered(nextColumnIndex)\r\n                }\r\n                break;\r\n            case \"previous\":\r\n            case \"previousInRow\":\r\n                nextColumnIndex = columnIndex - 1;\r\n                horizontalScrollPosition = this.option(\"rtlEnabled\") ? 0 : this._getMaxHorizontalOffset();\r\n                if (\"previous\" === direction) {\r\n                    var columnIndexOffset = this._columnsController.getColumnIndexOffset();\r\n                    var leftEdgePosition = nextColumnIndex < 0 && 0 === columnIndexOffset;\r\n                    needToScroll = leftEdgePosition || this._isFixedColumn(columnIndex) && !this._isColumnRendered(nextColumnIndex)\r\n                } else {\r\n                    needToScroll = nextColumnIndex >= 0 && this._isFixedColumn(columnIndex) && !this._isColumnRendered(nextColumnIndex)\r\n                }\r\n        }\r\n        if (needToScroll) {\r\n            scrollable.scrollTo({\r\n                left: horizontalScrollPosition\r\n            })\r\n        } else if (isDefined(nextColumnIndex) && isDefined(direction) && this._isColumnVirtual(nextColumnIndex)) {\r\n            horizontalScrollPosition = this._getHorizontalScrollPositionOffset(direction);\r\n            0 !== horizontalScrollPosition && scrollable.scrollBy({\r\n                left: horizontalScrollPosition,\r\n                top: 0\r\n            })\r\n        }\r\n    },\r\n    _getHorizontalScrollPositionOffset: function(direction) {\r\n        var positionOffset = 0;\r\n        var $currentCell = this._getCell(this._focusedCellPosition);\r\n        var currentCellWidth = $currentCell && getOuterWidth($currentCell);\r\n        if (currentCellWidth > 0) {\r\n            var rtlMultiplier = this.option(\"rtlEnabled\") ? -1 : 1;\r\n            positionOffset = \"nextInRow\" === direction || \"next\" === direction ? currentCellWidth * rtlMultiplier : currentCellWidth * rtlMultiplier * -1\r\n        }\r\n        return positionOffset\r\n    },\r\n    _editingCellTabHandler: function(eventArgs, direction) {\r\n        var eventTarget = eventArgs.originalEvent.target;\r\n        var $cell = this._getCellElementFromTarget(eventTarget);\r\n        var isEditingAllowed;\r\n        var $event = eventArgs.originalEvent;\r\n        var elementType = this._getElementType(eventTarget);\r\n        if ($cell.is(COMMAND_CELL_SELECTOR)) {\r\n            return !this._targetCellTabHandler(eventArgs, direction)\r\n        }\r\n        this._updateFocusedCellPosition($cell);\r\n        var nextCellInfo = this._getNextCellByTabKey($event, direction, elementType);\r\n        $cell = nextCellInfo.$cell;\r\n        if (!$cell || this._handleTabKeyOnMasterDetailCell($cell, direction)) {\r\n            return false\r\n        }\r\n        var columnsController = this._columnsController;\r\n        var cellIndex = this.getView(\"rowsView\").getCellIndex($cell);\r\n        var columnIndex = cellIndex + columnsController.getColumnIndexOffset();\r\n        var column = columnsController.getVisibleColumns(null, true)[columnIndex];\r\n        var $row = $cell.parent();\r\n        var rowIndex = this._getRowIndex($row);\r\n        var row = this._dataController.items()[rowIndex];\r\n        var editingController = this._editingController;\r\n        if (column && column.allowEditing) {\r\n            var _isDataRow = !row || \"data\" === row.rowType;\r\n            isEditingAllowed = editingController.allowUpdating({\r\n                row: row\r\n            }) ? _isDataRow : row && row.isNewRow\r\n        }\r\n        if (!isEditingAllowed) {\r\n            this._closeEditCell()\r\n        }\r\n        if (this._focusCell($cell, !nextCellInfo.isHighlighted)) {\r\n            if (!this._isRowEditMode() && isEditingAllowed) {\r\n                this._editFocusedCell()\r\n            } else {\r\n                this._focusInteractiveElement($cell, eventArgs.shift)\r\n            }\r\n        }\r\n        return true\r\n    },\r\n    _targetCellTabHandler: function(eventArgs, direction) {\r\n        var $event = eventArgs.originalEvent;\r\n        var eventTarget = $event.target;\r\n        var $cell = this._getCellElementFromTarget(eventTarget);\r\n        var $lastInteractiveElement = this._getInteractiveElement($cell, !eventArgs.shift);\r\n        var isOriginalHandlerRequired = false;\r\n        var elementType;\r\n        if (!isEditorCell(this, $cell) && $lastInteractiveElement.length && eventTarget !== $lastInteractiveElement.get(0)) {\r\n            isOriginalHandlerRequired = true\r\n        } else {\r\n            if (void 0 === this._focusedCellPosition.rowIndex && $(eventTarget).hasClass(ROW_CLASS)) {\r\n                this._updateFocusedCellPosition($cell)\r\n            }\r\n            elementType = this._getElementType(eventTarget);\r\n            if (this.isRowFocusType()) {\r\n                this.setCellFocusType();\r\n                if (\"row\" === elementType && isDataRow($(eventTarget))) {\r\n                    eventTarget = this.getFirstValidCellInRow($(eventTarget));\r\n                    elementType = this._getElementType(eventTarget)\r\n                }\r\n            }\r\n            var nextCellInfo = this._getNextCellByTabKey($event, direction, elementType);\r\n            $cell = nextCellInfo.$cell;\r\n            if (!$cell) {\r\n                return false\r\n            }\r\n            $cell = this._checkNewLineTransition($event, $cell);\r\n            if (!$cell) {\r\n                return false\r\n            }\r\n            this._focusCell($cell, !nextCellInfo.isHighlighted);\r\n            if (!isEditorCell(this, $cell)) {\r\n                this._focusInteractiveElement($cell, eventArgs.shift)\r\n            }\r\n        }\r\n        return isOriginalHandlerRequired\r\n    },\r\n    _getNextCellByTabKey: function($event, direction, elementType) {\r\n        var $cell = this._getNextCell(direction, elementType);\r\n        var args = $cell && this._fireFocusedCellChanging($event, $cell, true);\r\n        if (!args || args.cancel) {\r\n            return {}\r\n        }\r\n        if (args.$newCellElement) {\r\n            $cell = args.$newCellElement\r\n        }\r\n        return {\r\n            $cell: $cell,\r\n            isHighlighted: args.isHighlighted\r\n        }\r\n    },\r\n    _checkNewLineTransition: function($event, $cell) {\r\n        var rowIndex = this.getVisibleRowIndex();\r\n        var $row = $cell.parent();\r\n        if (rowIndex !== this._getRowIndex($row)) {\r\n            var cellPosition = this._getCellPosition($cell);\r\n            var args = this._fireFocusedRowChanging($event, $row);\r\n            if (args.cancel) {\r\n                return\r\n            }\r\n            if (args.rowIndexChanged) {\r\n                this.setFocusedColumnIndex(cellPosition.columnIndex);\r\n                $cell = this._getFocusedCell()\r\n            }\r\n        }\r\n        return $cell\r\n    },\r\n    _enterKeyHandler: function(eventArgs, isEditing) {\r\n        var $cell = this._getFocusedCell();\r\n        var rowIndex = this.getVisibleRowIndex();\r\n        var $row = this._focusedView && this._focusedView.getRow(rowIndex);\r\n        if (this.option(\"grouping.allowCollapsing\") && isGroupRow($row) || this.option(\"masterDetail.enabled\") && $cell && $cell.hasClass(COMMAND_EXPAND_CLASS)) {\r\n            var key = this._dataController.getKeyByRowIndex(rowIndex);\r\n            var item = this._dataController.items()[rowIndex];\r\n            if (void 0 !== key && item && item.data && !item.data.isContinuation) {\r\n                this._dataController.changeRowExpand(key)\r\n            }\r\n        } else {\r\n            this._processEnterKeyForDataCell(eventArgs, isEditing)\r\n        }\r\n    },\r\n    _processEnterKeyForDataCell: function(eventArgs, isEditing) {\r\n        var direction = this._getEnterKeyDirection(eventArgs);\r\n        var allowEditingOnEnterKey = this._allowEditingOnEnterKey();\r\n        if (isEditing || !allowEditingOnEnterKey && direction) {\r\n            this._handleEnterKeyEditingCell(eventArgs.originalEvent);\r\n            if (\"next\" === direction || \"previous\" === direction) {\r\n                this._targetCellTabHandler(eventArgs, direction)\r\n            } else if (\"upArrow\" === direction || \"downArrow\" === direction) {\r\n                this._navigateNextCell(eventArgs.originalEvent, direction)\r\n            }\r\n        } else if (allowEditingOnEnterKey) {\r\n            this._startEditing(eventArgs)\r\n        }\r\n    },\r\n    _getEnterKeyDirection: function(eventArgs) {\r\n        var enterKeyDirection = this.option(\"keyboardNavigation.enterKeyDirection\");\r\n        var isShift = eventArgs.shift;\r\n        if (\"column\" === enterKeyDirection) {\r\n            return isShift ? \"upArrow\" : \"downArrow\"\r\n        }\r\n        if (\"row\" === enterKeyDirection) {\r\n            return isShift ? \"previous\" : \"next\"\r\n        }\r\n    },\r\n    _handleEnterKeyEditingCell: function(event) {\r\n        var target = event.target;\r\n        var $cell = this._getCellElementFromTarget(target);\r\n        var isRowEditMode = this._isRowEditMode();\r\n        this._updateFocusedCellPosition($cell);\r\n        if (isRowEditMode) {\r\n            this._focusEditFormCell($cell);\r\n            setTimeout(this._editingController.saveEditData.bind(this._editingController))\r\n        } else {\r\n            eventsEngine.trigger($(target), \"change\");\r\n            this._closeEditCell();\r\n            event.preventDefault()\r\n        }\r\n    },\r\n    _escapeKeyHandler: function(eventArgs, isEditing) {\r\n        var $cell = this._getCellElementFromTarget(eventArgs.originalEvent.target);\r\n        if (isEditing) {\r\n            this._updateFocusedCellPosition($cell);\r\n            if (!this._isRowEditMode()) {\r\n                if (\"cell\" === this._editingController.getEditMode()) {\r\n                    this._editingController.cancelEditData()\r\n                } else {\r\n                    this._closeEditCell()\r\n                }\r\n            } else {\r\n                this._focusEditFormCell($cell);\r\n                this._editingController.cancelEditData();\r\n                if (0 === this._dataController.items().length) {\r\n                    this._resetFocusedCell();\r\n                    this._editorFactory.loseFocus()\r\n                }\r\n            }\r\n            eventArgs.originalEvent.preventDefault()\r\n        }\r\n    },\r\n    _ctrlFKeyHandler: function(eventArgs) {\r\n        if (this.option(\"searchPanel.visible\")) {\r\n            var searchTextEditor = this._headerPanel.getSearchTextEditor();\r\n            if (searchTextEditor) {\r\n                searchTextEditor.focus();\r\n                eventArgs.originalEvent.preventDefault()\r\n            }\r\n        }\r\n    },\r\n    _f2KeyHandler: function() {\r\n        var isEditing = this._editingController.isEditing();\r\n        var rowIndex = this.getVisibleRowIndex();\r\n        var $row = this._focusedView && this._focusedView.getRow(rowIndex);\r\n        if (!isEditing && isDataRow($row)) {\r\n            this._startEditing()\r\n        }\r\n    },\r\n    _navigateNextCell: function($event, keyCode) {\r\n        var $cell = this._getNextCell(keyCode);\r\n        var directionCode = this._getDirectionCodeByKey(keyCode);\r\n        var isCellValid = $cell && this._isCellValid($cell);\r\n        var result = isCellValid ? this._arrowKeysHandlerFocusCell($event, $cell, directionCode) : false;\r\n        return result\r\n    },\r\n    _arrowKeysHandlerFocusCell: function($event, $nextCell, direction) {\r\n        var isVerticalDirection = \"prevRow\" === direction || \"nextRow\" === direction;\r\n        var args = this._fireFocusChangingEvents($event, $nextCell, isVerticalDirection, true);\r\n        $nextCell = args.$newCellElement;\r\n        if (!args.cancel && this._isCellValid($nextCell)) {\r\n            this._focus($nextCell, !args.isHighlighted);\r\n            return true\r\n        }\r\n        return false\r\n    },\r\n    _beginFastEditing: function(originalEvent, isDeleting) {\r\n        if (!this._isFastEditingAllowed() || originalEvent.altKey || originalEvent.ctrlKey || this._editingController.isEditing()) {\r\n            return false\r\n        }\r\n        if (isDeleting) {\r\n            this._startEditing(originalEvent, FAST_EDITING_DELETE_KEY)\r\n        } else {\r\n            var key = originalEvent.key;\r\n            var keyCode = originalEvent.keyCode || originalEvent.which;\r\n            var fastEditingKey = key || keyCode && String.fromCharCode(keyCode);\r\n            if (fastEditingKey && (1 === fastEditingKey.length || fastEditingKey === FAST_EDITING_DELETE_KEY)) {\r\n                this._startEditing(originalEvent, fastEditingKey)\r\n            }\r\n        }\r\n        return true\r\n    },\r\n    _pointerEventHandler: function(e) {\r\n        var event = e.event || e;\r\n        var $target = $(event.currentTarget);\r\n        var rowsView = this.getView(\"rowsView\");\r\n        var focusedViewElement = rowsView && rowsView.element();\r\n        var $parent = $target.parent();\r\n        var isInteractiveElement = $(event.target).is(INTERACTIVE_ELEMENTS_SELECTOR);\r\n        var isRevertButton = !!$(event.target).closest(\".\".concat(REVERT_BUTTON_CLASS)).length;\r\n        var isExpandCommandCell = $target.hasClass(COMMAND_EXPAND_CLASS);\r\n        if (!this._isEventInCurrentGrid(event)) {\r\n            return\r\n        }\r\n        if (!isRevertButton && (this._isCellValid($target, !isInteractiveElement) || isExpandCommandCell)) {\r\n            $target = this._isInsideEditForm($target) ? $(event.target) : $target;\r\n            this._focusView();\r\n            $(focusedViewElement).removeClass(FOCUS_STATE_CLASS);\r\n            if ($parent.hasClass(FREESPACE_ROW_CLASS)) {\r\n                this._updateFocusedCellPosition($target);\r\n                this._applyTabIndexToElement(this._focusedView.element());\r\n                this._focusedView.focus(true)\r\n            } else if (!this._isMasterDetailCell($target)) {\r\n                this._clickTargetCellHandler(event, $target)\r\n            } else {\r\n                this._updateFocusedCellPosition($target)\r\n            }\r\n        } else if ($target.is(\"td\")) {\r\n            this._resetFocusedCell()\r\n        }\r\n    },\r\n    _clickTargetCellHandler: function(event, $cell) {\r\n        var columnIndex = this.getView(\"rowsView\").getCellIndex($cell);\r\n        var column = this._columnsController.getVisibleColumns()[columnIndex];\r\n        var isCellEditMode = this._isCellEditMode();\r\n        this.setCellFocusType();\r\n        var args = this._fireFocusChangingEvents(event, $cell, true);\r\n        $cell = args.$newCellElement;\r\n        if (!args.cancel) {\r\n            if (args.resetFocusedRow) {\r\n                this.getController(\"focus\")._resetFocusedRow();\r\n                return\r\n            }\r\n            if (args.rowIndexChanged) {\r\n                $cell = this._getFocusedCell()\r\n            }\r\n            if (!args.isHighlighted && !isCellEditMode) {\r\n                this.setRowFocusType()\r\n            }\r\n            this._updateFocusedCellPosition($cell);\r\n            if (this._allowRowUpdating() && isCellEditMode && column && column.allowEditing) {\r\n                this._isNeedFocus = false;\r\n                this._isHiddenFocus = false\r\n            } else {\r\n                $cell = this._getFocusedCell();\r\n                var $target = event && $(event.target).closest(NON_FOCUSABLE_ELEMENTS_SELECTOR + \", td\");\r\n                var skipFocusEvent = $target && $target.not($cell).is(NON_FOCUSABLE_ELEMENTS_SELECTOR);\r\n                var isEditor = !!column && !column.command && $cell.hasClass(EDITOR_CELL_CLASS);\r\n                var isDisabled = !isEditor && (!args.isHighlighted || skipFocusEvent);\r\n                this._focus($cell, isDisabled, skipFocusEvent)\r\n            }\r\n        } else {\r\n            this.setRowFocusType();\r\n            this.setFocusedRowIndex(args.prevRowIndex);\r\n            if (this._editingController.isEditing() && isCellEditMode) {\r\n                this._closeEditCell()\r\n            }\r\n        }\r\n    },\r\n    _allowRowUpdating: function() {\r\n        var rowIndex = this.getVisibleRowIndex();\r\n        var row = this._dataController.items()[rowIndex];\r\n        return this._editingController.allowUpdating({\r\n            row: row\r\n        }, \"click\")\r\n    },\r\n    focus: function(element) {\r\n        var activeElementSelector;\r\n        var focusedRowEnabled = this.option(\"focusedRowEnabled\");\r\n        var isHighlighted = this._isCellElement($(element));\r\n        if (!element) {\r\n            activeElementSelector = \".dx-datagrid-rowsview .dx-row[tabindex]\";\r\n            if (!focusedRowEnabled) {\r\n                activeElementSelector += \", .dx-datagrid-rowsview .dx-row > td[tabindex]\"\r\n            }\r\n            element = this.component.$element().find(activeElementSelector).first()\r\n        }\r\n        element && this._focusElement($(element), isHighlighted)\r\n    },\r\n    getFocusedView: function() {\r\n        return this._focusedView\r\n    },\r\n    setupFocusedView: function() {\r\n        if (this.isKeyboardEnabled() && !isDefined(this._focusedView)) {\r\n            this._focusView()\r\n        }\r\n    },\r\n    _focusElement: function($element, isHighlighted) {\r\n        var rowsViewElement = $(this._getRowsViewElement());\r\n        var $focusedView = $element.closest(rowsViewElement);\r\n        var isRowFocusType = this.isRowFocusType();\r\n        var args = {};\r\n        if (!$focusedView.length || this._isCellElement($element) && !this._isCellValid($element)) {\r\n            return\r\n        }\r\n        this._focusView();\r\n        this._isNeedFocus = true;\r\n        this._isNeedScroll = true;\r\n        if (this._isCellElement($element) || isGroupRow($element)) {\r\n            this.setCellFocusType();\r\n            args = this._fireFocusChangingEvents(null, $element, false, isHighlighted);\r\n            $element = args.$newCellElement;\r\n            if (isRowFocusType && !args.isHighlighted) {\r\n                this.setRowFocusType()\r\n            }\r\n        }\r\n        if (!args.cancel) {\r\n            this._focus($element, !args.isHighlighted);\r\n            this._focusInteractiveElement($element)\r\n        }\r\n    },\r\n    _getFocusedViewByElement: function($element) {\r\n        var view = this.getFocusedView();\r\n        var $view = view && $(view.element());\r\n        return $element && 0 !== $element.closest($view).length\r\n    },\r\n    _focusView: function() {\r\n        this._focusedView = this.getView(\"rowsView\")\r\n    },\r\n    _resetFocusedView: function() {\r\n        this.setRowFocusType();\r\n        this._focusedView = null\r\n    },\r\n    _focusInteractiveElement: function($cell, isLast) {\r\n        if (!$cell) {\r\n            return\r\n        }\r\n        var $focusedElement = this._getInteractiveElement($cell, isLast);\r\n        gridCoreUtils.focusAndSelectElement(this, $focusedElement)\r\n    },\r\n    _focus: function($cell, disableFocus, skipFocusEvent) {\r\n        var $row = $cell && !$cell.hasClass(ROW_CLASS) ? $cell.closest(\".\".concat(ROW_CLASS)) : $cell;\r\n        if ($row && isNotFocusedRow($row)) {\r\n            return\r\n        }\r\n        var focusedView = this._focusedView;\r\n        var $focusViewElement = focusedView && focusedView.element();\r\n        var $focusElement;\r\n        this._isHiddenFocus = disableFocus;\r\n        var isRowFocus = isGroupRow($row) || this.isRowFocusType();\r\n        if (isRowFocus) {\r\n            $focusElement = $row;\r\n            if (focusedView) {\r\n                this.setFocusedRowIndex(this._getRowIndex($row))\r\n            }\r\n        } else if (this._isCellElement($cell)) {\r\n            $focusElement = $cell;\r\n            this._updateFocusedCellPosition($cell)\r\n        }\r\n        if ($focusElement) {\r\n            if ($focusViewElement) {\r\n                $focusViewElement.find(\".dx-row[tabindex], .dx-row > td[tabindex]\").not($focusElement).removeClass(CELL_FOCUS_DISABLED_CLASS).removeAttr(\"tabindex\")\r\n            }\r\n            eventsEngine.one($focusElement, \"blur\", e => {\r\n                if (e.relatedTarget) {\r\n                    $focusElement.removeClass(CELL_FOCUS_DISABLED_CLASS)\r\n                }\r\n            });\r\n            if (!skipFocusEvent) {\r\n                this._applyTabIndexToElement($focusElement);\r\n                eventsEngine.trigger($focusElement, \"focus\")\r\n            }\r\n            if (disableFocus) {\r\n                $focusElement.addClass(CELL_FOCUS_DISABLED_CLASS);\r\n                if (isRowFocus) {\r\n                    $cell.addClass(CELL_FOCUS_DISABLED_CLASS)\r\n                }\r\n            } else {\r\n                this._editorFactory.focus($focusElement)\r\n            }\r\n        }\r\n    },\r\n    _updateFocus: function(isRenderView) {\r\n        this._updateFocusTimeout = setTimeout(() => {\r\n            var editingController = this._editingController;\r\n            var isCellEditMode = editingController.getEditMode() === EDIT_MODE_CELL;\r\n            var isBatchEditMode = editingController.getEditMode() === EDIT_MODE_BATCH;\r\n            if (isCellEditMode && editingController.hasChanges() || isBatchEditMode && editingController.isNewRowInEditMode()) {\r\n                editingController._focusEditingCell();\r\n                return\r\n            }\r\n            var $cell = this._getFocusedCell();\r\n            var isEditing = editingController.isEditing();\r\n            if ($cell && !(this._isMasterDetailCell($cell) && !this._isRowEditMode())) {\r\n                if (this._hasSkipRow($cell.parent())) {\r\n                    var direction = this._focusedCellPosition && this._focusedCellPosition.rowIndex > 0 ? \"upArrow\" : \"downArrow\";\r\n                    $cell = this._getNextCell(direction)\r\n                }\r\n                if (isElementDefined($cell)) {\r\n                    if ($cell.is(\"td\") || $cell.hasClass(this.addWidgetPrefix(EDIT_FORM_ITEM_CLASS))) {\r\n                        var isCommandCell = $cell.is(COMMAND_CELL_SELECTOR);\r\n                        var $focusedElementInsideCell = $cell.find(\":focus\");\r\n                        var isFocusedElementDefined = isElementDefined($focusedElementInsideCell);\r\n                        if ((isRenderView || !isCommandCell) && this._editorFactory.focus()) {\r\n                            if (isCommandCell && isFocusedElementDefined) {\r\n                                gridCoreUtils.focusAndSelectElement(this, $focusedElementInsideCell);\r\n                                return\r\n                            }!isFocusedElementDefined && this._focus($cell)\r\n                        } else if (!isFocusedElementDefined && (this._isNeedFocus || this._isHiddenFocus)) {\r\n                            this._focus($cell, this._isHiddenFocus)\r\n                        }\r\n                        if (isEditing) {\r\n                            this._focusInteractiveElement.bind(this)($cell)\r\n                        }\r\n                    } else {\r\n                        eventsEngine.trigger($cell, \"focus\")\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    },\r\n    _getFocusedCell: function() {\r\n        return $(this._getCell(this._focusedCellPosition))\r\n    },\r\n    _updateFocusedCellPositionByTarget: function(target) {\r\n        var _this$_focusedCellPos;\r\n        var elementType = this._getElementType(target);\r\n        if (\"row\" === elementType && isDefined(null === (_this$_focusedCellPos = this._focusedCellPosition) || void 0 === _this$_focusedCellPos ? void 0 : _this$_focusedCellPos.columnIndex)) {\r\n            var $row = $(target);\r\n            this._focusedView && isGroupRow($row) && this.setFocusedRowIndex(this._getRowIndex($row))\r\n        } else {\r\n            this._updateFocusedCellPosition(this._getCellElementFromTarget(target))\r\n        }\r\n    },\r\n    _updateFocusedCellPosition: function($cell, direction) {\r\n        var position = this._getCellPosition($cell, direction);\r\n        if (position) {\r\n            if (!$cell.length || position.rowIndex >= 0 && position.columnIndex >= 0) {\r\n                this.setFocusedCellPosition(position.rowIndex, position.columnIndex)\r\n            }\r\n        }\r\n        return position\r\n    },\r\n    _getFocusedColumnIndexOffset: function(columnIndex) {\r\n        var offset = 0;\r\n        var column = this._columnsController.getVisibleColumns()[columnIndex];\r\n        if (column && column.fixed) {\r\n            offset = this._getFixedColumnIndexOffset(column)\r\n        } else if (columnIndex >= 0) {\r\n            offset = this._columnsController.getColumnIndexOffset()\r\n        }\r\n        return offset\r\n    },\r\n    _getFixedColumnIndexOffset: function(column) {\r\n        var offset = isFixedColumnIndexOffsetRequired(this, column) ? this._getVisibleColumnCount() - this._columnsController.getVisibleColumns().length : 0;\r\n        return offset\r\n    },\r\n    _getCellPosition: function($cell, direction) {\r\n        var columnIndex;\r\n        var $row = isElementDefined($cell) && $cell.closest(\"tr\");\r\n        var rowsView = this.getView(\"rowsView\");\r\n        if (isElementDefined($row)) {\r\n            var rowIndex = this._getRowIndex($row);\r\n            columnIndex = rowsView.getCellIndex($cell, rowIndex);\r\n            columnIndex += this._getFocusedColumnIndexOffset(columnIndex);\r\n            if (direction) {\r\n                columnIndex = \"previous\" === direction ? columnIndex - 1 : columnIndex + 1;\r\n                columnIndex = this._applyColumnIndexBoundaries(columnIndex)\r\n            }\r\n            return {\r\n                rowIndex: rowIndex,\r\n                columnIndex: columnIndex\r\n            }\r\n        }\r\n    },\r\n    _focusCell: function($cell, isDisabled) {\r\n        if (this._isCellValid($cell)) {\r\n            this._focus($cell, isDisabled);\r\n            return true\r\n        }\r\n    },\r\n    _focusEditFormCell: function($cell) {\r\n        if ($cell.hasClass(MASTER_DETAIL_CELL_CLASS)) {\r\n            this._editorFactory.focus($cell, true)\r\n        }\r\n    },\r\n    _resetFocusedCell: function(preventScroll) {\r\n        var _this$_focusedView;\r\n        var $cell = this._getFocusedCell();\r\n        isElementDefined($cell) && $cell.removeAttr(\"tabindex\");\r\n        this._isNeedFocus = false;\r\n        this._isNeedScroll = false;\r\n        this._focusedCellPosition = {};\r\n        clearTimeout(this._updateFocusTimeout);\r\n        null === (_this$_focusedView = this._focusedView) || void 0 === _this$_focusedView ? void 0 : _this$_focusedView.renderFocusState({\r\n            preventScroll: preventScroll\r\n        })\r\n    },\r\n    restoreFocusableElement: function(rowIndex, $event) {\r\n        var args;\r\n        var $rowElement;\r\n        var isUpArrow = isDefined(rowIndex);\r\n        var rowsView = this.getView(\"rowsView\");\r\n        var $rowsViewElement = rowsView.element();\r\n        var columnIndex = this._focusedCellPosition.columnIndex;\r\n        var rowIndexOffset = this._dataController.getRowIndexOffset();\r\n        rowIndex = isUpArrow ? rowIndex : rowsView.getTopVisibleItemIndex() + rowIndexOffset;\r\n        if (!isUpArrow) {\r\n            this._editorFactory.loseFocus();\r\n            this._applyTabIndexToElement($rowsViewElement);\r\n            eventsEngine.trigger($rowsViewElement, \"focus\")\r\n        } else {\r\n            $rowElement = rowsView.getRow(rowIndex - rowIndexOffset);\r\n            args = this._fireFocusedRowChanging($event, $rowElement);\r\n            if (!args.cancel && args.rowIndexChanged) {\r\n                rowIndex = args.newRowIndex\r\n            }\r\n        }\r\n        if (!isUpArrow || !args.cancel) {\r\n            this.setFocusedCellPosition(rowIndex, columnIndex)\r\n        }\r\n        isUpArrow && this._updateFocus()\r\n    },\r\n    _getNewPositionByCode: function(cellPosition, elementType, code) {\r\n        var columnIndex = cellPosition.columnIndex;\r\n        var rowIndex = cellPosition.rowIndex;\r\n        var visibleColumnsCount;\r\n        if (void 0 === cellPosition.rowIndex && \"next\" === code) {\r\n            return {\r\n                columnIndex: 0,\r\n                rowIndex: 0\r\n            }\r\n        }\r\n        switch (code) {\r\n            case \"nextInRow\":\r\n            case \"next\":\r\n                visibleColumnsCount = this._getVisibleColumnCount();\r\n                if (columnIndex < visibleColumnsCount - 1 && \"row\" !== elementType && this._hasValidCellAfterPosition({\r\n                        columnIndex: columnIndex,\r\n                        rowIndex: rowIndex\r\n                    })) {\r\n                    columnIndex++\r\n                } else if (!this._isLastRow(rowIndex) && \"next\" === code) {\r\n                    columnIndex = 0;\r\n                    rowIndex++\r\n                }\r\n                break;\r\n            case \"previousInRow\":\r\n            case \"previous\":\r\n                if (columnIndex > 0 && \"row\" !== elementType && this._hasValidCellBeforePosition({\r\n                        columnIndex: columnIndex,\r\n                        rowIndex: rowIndex\r\n                    })) {\r\n                    columnIndex--\r\n                } else if (rowIndex > 0 && \"previous\" === code) {\r\n                    rowIndex--;\r\n                    visibleColumnsCount = this._getVisibleColumnCount();\r\n                    columnIndex = visibleColumnsCount - 1\r\n                }\r\n                break;\r\n            case \"upArrow\":\r\n                rowIndex = rowIndex > 0 ? rowIndex - 1 : rowIndex;\r\n                break;\r\n            case \"downArrow\":\r\n                rowIndex = !this._isLastRow(rowIndex) ? rowIndex + 1 : rowIndex\r\n        }\r\n        return {\r\n            columnIndex: columnIndex,\r\n            rowIndex: rowIndex\r\n        }\r\n    },\r\n    setFocusedCellPosition: function(rowIndex, columnIndex) {\r\n        this.setFocusedRowIndex(rowIndex);\r\n        this.setFocusedColumnIndex(columnIndex)\r\n    },\r\n    setFocusedRowIndex: function(rowIndex) {\r\n        if (!this._focusedCellPosition) {\r\n            this._focusedCellPosition = {}\r\n        }\r\n        this._focusedCellPosition.rowIndex = rowIndex\r\n    },\r\n    setFocusedColumnIndex: function(columnIndex) {\r\n        if (!this._focusedCellPosition) {\r\n            this._focusedCellPosition = {}\r\n        }\r\n        this._focusedCellPosition.columnIndex = columnIndex\r\n    },\r\n    getRowIndex: function() {\r\n        return this._focusedCellPosition ? this._focusedCellPosition.rowIndex : -1\r\n    },\r\n    getColumnIndex: function() {\r\n        return this._focusedCellPosition ? this._focusedCellPosition.columnIndex : -1\r\n    },\r\n    getVisibleRowIndex: function() {\r\n        var rowIndex = this._focusedCellPosition && this._focusedCellPosition.rowIndex;\r\n        if (!isDefined(rowIndex) || rowIndex < 0) {\r\n            return -1\r\n        }\r\n        return rowIndex - this._dataController.getRowIndexOffset()\r\n    },\r\n    getVisibleColumnIndex: function() {\r\n        var columnIndex = this._focusedCellPosition && this._focusedCellPosition.columnIndex;\r\n        if (!isDefined(columnIndex)) {\r\n            return -1\r\n        }\r\n        return columnIndex - this._columnsController.getColumnIndexOffset()\r\n    },\r\n    _applyColumnIndexBoundaries: function(columnIndex) {\r\n        var visibleColumnsCount = this._getVisibleColumnCount();\r\n        if (columnIndex < 0) {\r\n            columnIndex = 0\r\n        } else if (columnIndex >= visibleColumnsCount) {\r\n            columnIndex = visibleColumnsCount - 1\r\n        }\r\n        return columnIndex\r\n    },\r\n    _isCellByPositionValid: function(cellPosition) {\r\n        var $cell = $(this._getCell(cellPosition));\r\n        return this._isCellValid($cell)\r\n    },\r\n    _isLastRow: function(rowIndex) {\r\n        var dataController = this._dataController;\r\n        var visibleItems = dataController.items().filter(item => false !== item.visible);\r\n        if (this._isVirtualRowRender()) {\r\n            return rowIndex >= dataController.getMaxRowIndex()\r\n        }\r\n        return rowIndex === visibleItems.length - 1\r\n    },\r\n    _isFirstValidCell: function(cellPosition) {\r\n        var isFirstValidCell = false;\r\n        if (0 === cellPosition.rowIndex && cellPosition.columnIndex >= 0) {\r\n            isFirstValidCell = isFirstValidCell || !this._hasValidCellBeforePosition(cellPosition)\r\n        }\r\n        return isFirstValidCell\r\n    },\r\n    _hasValidCellBeforePosition: function(cellPosition) {\r\n        var columnIndex = cellPosition.columnIndex;\r\n        var hasValidCells = false;\r\n        while (columnIndex > 0 && !hasValidCells) {\r\n            var checkingPosition = {\r\n                columnIndex: --columnIndex,\r\n                rowIndex: cellPosition.rowIndex\r\n            };\r\n            hasValidCells = this._isCellByPositionValid(checkingPosition)\r\n        }\r\n        return hasValidCells\r\n    },\r\n    _hasValidCellAfterPosition: function(cellPosition) {\r\n        var columnIndex = cellPosition.columnIndex;\r\n        var hasValidCells = false;\r\n        var visibleColumnCount = this._getVisibleColumnCount();\r\n        while (columnIndex < visibleColumnCount - 1 && !hasValidCells) {\r\n            var checkingPosition = {\r\n                columnIndex: ++columnIndex,\r\n                rowIndex: cellPosition.rowIndex\r\n            };\r\n            hasValidCells = this._isCellByPositionValid(checkingPosition)\r\n        }\r\n        return hasValidCells\r\n    },\r\n    _isLastValidCell: function(cellPosition) {\r\n        var nextColumnIndex = cellPosition.columnIndex >= 0 ? cellPosition.columnIndex + 1 : 0;\r\n        var rowIndex = cellPosition.rowIndex;\r\n        var checkingPosition = {\r\n            columnIndex: nextColumnIndex,\r\n            rowIndex: rowIndex\r\n        };\r\n        var visibleRows = this._dataController.getVisibleRows();\r\n        var row = visibleRows && visibleRows[rowIndex];\r\n        var isLastRow = this._isLastRow(rowIndex);\r\n        if (!isLastRow) {\r\n            return false\r\n        }\r\n        if (row && \"group\" === row.rowType && cellPosition.columnIndex > 0) {\r\n            return true\r\n        }\r\n        if (cellPosition.columnIndex === this._getVisibleColumnCount() - 1) {\r\n            return true\r\n        }\r\n        if (this._isCellByPositionValid(checkingPosition)) {\r\n            return false\r\n        }\r\n        return this._isLastValidCell(checkingPosition)\r\n    },\r\n    _isCellValid: function($cell, isClick) {\r\n        if (isElementDefined($cell)) {\r\n            var rowsView = this.getView(\"rowsView\");\r\n            var $row = $cell.parent();\r\n            var columnsController = this._columnsController;\r\n            var columnIndex = rowsView.getCellIndex($cell) + columnsController.getColumnIndexOffset();\r\n            var column = columnsController.getVisibleColumns(null, true)[columnIndex];\r\n            var visibleColumnCount = this._getVisibleColumnCount();\r\n            var editingController = this._editingController;\r\n            var isMasterDetailRow = isDetailRow($row);\r\n            var isShowWhenGrouped = column && column.showWhenGrouped;\r\n            var isDataCell = column && !$cell.hasClass(COMMAND_EXPAND_CLASS) && isDataRow($row);\r\n            if (this._isMasterDetailCell($cell)) {\r\n                return true\r\n            }\r\n            if (visibleColumnCount > columnIndex && (!isMasterDetailRow && column && (!isDefined(column.groupIndex) || isShowWhenGrouped && isDataCell) || parseInt($cell.attr(\"colspan\")) > 1)) {\r\n                var rowItems = this._dataController.items();\r\n                var visibleRowIndex = rowsView.getRowIndex($row);\r\n                var row = rowItems[visibleRowIndex];\r\n                var isCellEditing = editingController && this._isCellEditMode() && editingController.isEditing();\r\n                var isRowEditingInCurrentRow = editingController && editingController.isEditRow(visibleRowIndex);\r\n                var isEditing = isRowEditingInCurrentRow || isCellEditing;\r\n                if (column.command) {\r\n                    if (this._isLegacyNavigation()) {\r\n                        return !isEditing && \"expand\" === column.command\r\n                    }\r\n                    if (isCellEditing) {\r\n                        return false\r\n                    }\r\n                    if (isRowEditingInCurrentRow) {\r\n                        return \"select\" !== column.command\r\n                    }\r\n                    return !isEditing\r\n                }\r\n                if (isCellEditing && row && \"data\" !== row.rowType) {\r\n                    return false\r\n                }\r\n                return !isEditing || column.allowEditing || isClick\r\n            }\r\n        }\r\n    },\r\n    getFirstValidCellInRow: function($row, columnIndex) {\r\n        var $cells = $row.find(\"> td\");\r\n        var $cell;\r\n        var $result;\r\n        columnIndex = columnIndex || 0;\r\n        for (var i = columnIndex; i < $cells.length; ++i) {\r\n            $cell = $cells.eq(i);\r\n            if (this._isCellValid($cell)) {\r\n                $result = $cell;\r\n                break\r\n            }\r\n        }\r\n        return $result\r\n    },\r\n    _getNextCell: function(keyCode, elementType, cellPosition) {\r\n        var focusedCellPosition = cellPosition || this._focusedCellPosition;\r\n        var isRowFocusType = this.isRowFocusType();\r\n        var includeCommandCells = isRowFocusType || [\"next\", \"previous\"].includes(keyCode);\r\n        var $cell;\r\n        var $row;\r\n        if (this._focusedView && focusedCellPosition) {\r\n            var newFocusedCellPosition = this._getNewPositionByCode(focusedCellPosition, elementType, keyCode);\r\n            $cell = $(this._getCell(newFocusedCellPosition));\r\n            var isLastCellOnDirection = \"previous\" === keyCode ? this._isFirstValidCell(newFocusedCellPosition) : this._isLastValidCell(newFocusedCellPosition);\r\n            if (isElementDefined($cell) && !this._isCellValid($cell) && this._isCellInRow(newFocusedCellPosition, includeCommandCells) && !isLastCellOnDirection) {\r\n                if (isRowFocusType) {\r\n                    $cell = this.getFirstValidCellInRow($cell.parent(), newFocusedCellPosition.columnIndex)\r\n                } else {\r\n                    $cell = this._getNextCell(keyCode, \"cell\", newFocusedCellPosition)\r\n                }\r\n            }\r\n            $row = isElementDefined($cell) && $cell.parent();\r\n            if (this._hasSkipRow($row)) {\r\n                var rowIndex = this._getRowIndex($row);\r\n                if (!this._isLastRow(rowIndex)) {\r\n                    $cell = this._getNextCell(keyCode, \"row\", {\r\n                        columnIndex: focusedCellPosition.columnIndex,\r\n                        rowIndex: rowIndex\r\n                    })\r\n                } else {\r\n                    return null\r\n                }\r\n            }\r\n            return isElementDefined($cell) ? $cell : null\r\n        }\r\n        return null\r\n    },\r\n    _startEditing: function(eventArgs, fastEditingKey) {\r\n        var focusedCellPosition = this._focusedCellPosition;\r\n        var visibleRowIndex = this.getVisibleRowIndex();\r\n        var visibleColumnIndex = this.getVisibleColumnIndex();\r\n        var row = this._dataController.items()[visibleRowIndex];\r\n        var column = this._columnsController.getVisibleColumns()[visibleColumnIndex];\r\n        if (this._isAllowEditing(row, column)) {\r\n            if (this._isRowEditMode()) {\r\n                this._editingController.editRow(visibleRowIndex)\r\n            } else if (focusedCellPosition) {\r\n                this._startEditCell(eventArgs, fastEditingKey)\r\n            }\r\n        }\r\n    },\r\n    _isAllowEditing: function(row, column) {\r\n        return this._editingController.allowUpdating({\r\n            row: row\r\n        }) && column && column.allowEditing\r\n    },\r\n    _editFocusedCell: function() {\r\n        var rowIndex = this.getVisibleRowIndex();\r\n        var colIndex = this.getVisibleColumnIndex();\r\n        return this._editingController.editCell(rowIndex, colIndex)\r\n    },\r\n    _startEditCell: function(eventArgs, fastEditingKey) {\r\n        this._fastEditingStarted = isDefined(fastEditingKey);\r\n        var editResult = this._editFocusedCell();\r\n        if (this._isFastEditingStarted()) {\r\n            if (true === editResult) {\r\n                this._editingCellHandler(eventArgs, fastEditingKey)\r\n            } else if (editResult && editResult.done) {\r\n                var editorValue = fastEditingKey !== FAST_EDITING_DELETE_KEY ? fastEditingKey : \"\";\r\n                editResult.done(() => this._editingCellHandler(eventArgs, editorValue))\r\n            }\r\n        }\r\n    },\r\n    _editingCellHandler: function(eventArgs, editorValue) {\r\n        var _$input$get$select, _$input$get;\r\n        var $input = this._getFocusedCell().find(INTERACTIVE_ELEMENTS_SELECTOR).eq(0);\r\n        var keyDownEvent = createEvent(eventArgs, {\r\n            type: \"keydown\",\r\n            target: $input.get(0)\r\n        });\r\n        var keyPressEvent = createEvent(eventArgs, {\r\n            type: \"keypress\",\r\n            target: $input.get(0)\r\n        });\r\n        var inputEvent = createEvent(eventArgs, {\r\n            type: \"input\",\r\n            target: $input.get(0)\r\n        });\r\n        if (inputEvent.originalEvent) {\r\n            inputEvent.originalEvent = createEvent(inputEvent.originalEvent, {\r\n                data: editorValue\r\n            })\r\n        }\r\n        null === (_$input$get$select = (_$input$get = $input.get(0)).select) || void 0 === _$input$get$select ? void 0 : _$input$get$select.call(_$input$get);\r\n        eventsEngine.trigger($input, keyDownEvent);\r\n        if (!keyDownEvent.isDefaultPrevented()) {\r\n            eventsEngine.trigger($input, keyPressEvent);\r\n            if (!keyPressEvent.isDefaultPrevented()) {\r\n                var timeout = browser.mozilla ? 25 : 0;\r\n                setTimeout(() => {\r\n                    $input.val(editorValue);\r\n                    var $widgetContainer = $input.closest(\".\".concat(WIDGET_CLASS));\r\n                    eventsEngine.off($widgetContainer, \"focusout\");\r\n                    eventsEngine.one($widgetContainer, \"focusout\", (function() {\r\n                        eventsEngine.trigger($input, \"change\")\r\n                    }));\r\n                    eventsEngine.trigger($input, inputEvent)\r\n                }, timeout)\r\n            }\r\n        }\r\n    },\r\n    _fireFocusChangingEvents: function($event, $cell, fireRowEvent, isHighlighted) {\r\n        var args = {};\r\n        var cellPosition = this._getCellPosition($cell) || {};\r\n        if (this.isCellFocusType()) {\r\n            args = this._fireFocusedCellChanging($event, $cell, isHighlighted);\r\n            if (!args.cancel) {\r\n                cellPosition.columnIndex = args.newColumnIndex;\r\n                cellPosition.rowIndex = args.newRowIndex;\r\n                isHighlighted = args.isHighlighted;\r\n                $cell = $(this._getCell(cellPosition))\r\n            }\r\n        }\r\n        if (!args.cancel && fireRowEvent && $cell) {\r\n            args = this._fireFocusedRowChanging($event, $cell.parent());\r\n            if (!args.cancel) {\r\n                cellPosition.rowIndex = args.newRowIndex;\r\n                args.isHighlighted = isHighlighted\r\n            }\r\n        }\r\n        args.$newCellElement = $(this._getCell(cellPosition));\r\n        if (!args.$newCellElement.length) {\r\n            args.$newCellElement = $cell\r\n        }\r\n        return args\r\n    },\r\n    _fireFocusedCellChanging: function($event, $cellElement, isHighlighted) {\r\n        var prevCellIndex = this.option(\"focusedColumnIndex\");\r\n        var prevRowIndex = this.option(\"focusedRowIndex\");\r\n        var cellPosition = this._getCellPosition($cellElement);\r\n        var columnIndex = cellPosition ? cellPosition.columnIndex : -1;\r\n        var rowIndex = cellPosition ? cellPosition.rowIndex : -1;\r\n        var args = {\r\n            cellElement: $cellElement,\r\n            prevColumnIndex: prevCellIndex,\r\n            prevRowIndex: prevRowIndex,\r\n            newColumnIndex: columnIndex,\r\n            newRowIndex: rowIndex,\r\n            rows: this._dataController.getVisibleRows(),\r\n            columns: this._columnsController.getVisibleColumns(),\r\n            event: $event,\r\n            isHighlighted: isHighlighted || false,\r\n            cancel: false\r\n        };\r\n        this._canceledCellPosition = null;\r\n        this.executeAction(\"onFocusedCellChanging\", args);\r\n        if (args.newColumnIndex !== columnIndex || args.newRowIndex !== rowIndex) {\r\n            args.$newCellElement = $(this._getCell({\r\n                columnIndex: args.newColumnIndex,\r\n                rowIndex: args.newRowIndex\r\n            }))\r\n        }\r\n        if (args.cancel) {\r\n            this._canceledCellPosition = {\r\n                rowIndex: rowIndex,\r\n                columnIndex: columnIndex\r\n            }\r\n        }\r\n        return args\r\n    },\r\n    _fireFocusedCellChanged: function($cellElement, prevCellIndex, prevRowIndex) {\r\n        var dataController = this._dataController;\r\n        var columnIndex = this.getView(\"rowsView\").getCellIndex($cellElement);\r\n        var rowIndex = this._getRowIndex($cellElement && $cellElement.parent());\r\n        var localRowIndex = Math.min(rowIndex - dataController.getRowIndexOffset(), dataController.items().length - 1);\r\n        var isEditingCell = this._editingController.isEditCell(localRowIndex, columnIndex);\r\n        var row = dataController.items()[localRowIndex];\r\n        if (!isEditingCell && (prevCellIndex !== columnIndex || prevRowIndex !== rowIndex)) {\r\n            this.executeAction(\"onFocusedCellChanged\", {\r\n                cellElement: $cellElement,\r\n                columnIndex: columnIndex,\r\n                rowIndex: rowIndex,\r\n                row: row,\r\n                column: this._columnsController.getVisibleColumns()[columnIndex]\r\n            })\r\n        }\r\n    },\r\n    _fireFocusedRowChanging: function(eventArgs, $newFocusedRow) {\r\n        var newRowIndex = this._getRowIndex($newFocusedRow);\r\n        var dataController = this._dataController;\r\n        var prevFocusedRowIndex = this.option(\"focusedRowIndex\");\r\n        var loadingOperationTypes = dataController.loadingOperationTypes();\r\n        var args = {\r\n            rowElement: $newFocusedRow,\r\n            prevRowIndex: prevFocusedRowIndex,\r\n            newRowIndex: newRowIndex,\r\n            event: eventArgs,\r\n            rows: dataController.getVisibleRows(),\r\n            cancel: false\r\n        };\r\n        if (!dataController || dataController.isLoading() && (loadingOperationTypes.reload || loadingOperationTypes.paging)) {\r\n            args.cancel = true;\r\n            return args\r\n        }\r\n        if (this.option(\"focusedRowEnabled\")) {\r\n            this.executeAction(\"onFocusedRowChanging\", args);\r\n            if (!args.cancel && args.newRowIndex !== newRowIndex) {\r\n                args.resetFocusedRow = args.newRowIndex < 0;\r\n                if (!args.resetFocusedRow) {\r\n                    this.setFocusedRowIndex(args.newRowIndex)\r\n                }\r\n                args.rowIndexChanged = true\r\n            }\r\n        }\r\n        return args\r\n    },\r\n    _fireFocusedRowChanged: function($rowElement) {\r\n        var row;\r\n        var focusedRowKey = this.option(\"focusedRowKey\");\r\n        var focusController = this.getController(\"focus\");\r\n        var focusedRowIndex = null === focusController || void 0 === focusController ? void 0 : focusController.getFocusedRowIndexByKey(focusedRowKey);\r\n        if (this.option(\"focusedRowEnabled\")) {\r\n            if (focusedRowIndex >= 0) {\r\n                var dataController = this._dataController;\r\n                row = focusedRowIndex >= 0 && dataController.getVisibleRows()[focusedRowIndex - dataController.getRowIndexOffset()]\r\n            }\r\n            this.executeAction(\"onFocusedRowChanged\", {\r\n                rowElement: $rowElement,\r\n                rowIndex: focusedRowIndex,\r\n                row: row\r\n            })\r\n        }\r\n    },\r\n    _isEventInCurrentGrid: function(event) {\r\n        return gridCoreUtils.isElementInCurrentGrid(this, $(event.target))\r\n    },\r\n    _isRowEditMode: function() {\r\n        var editMode = this._editingController.getEditMode();\r\n        return editMode === EDIT_MODE_ROW || editMode === EDIT_MODE_FORM\r\n    },\r\n    _isCellEditMode: function() {\r\n        var editMode = this._editingController.getEditMode();\r\n        return editMode === EDIT_MODE_CELL || editMode === EDIT_MODE_BATCH\r\n    },\r\n    _isFastEditingAllowed: function() {\r\n        return this._isCellEditMode() && this.option(\"keyboardNavigation.editOnKeyPress\")\r\n    },\r\n    _getInteractiveElement: function($cell, isLast) {\r\n        var $focusedElement = $cell.find(INTERACTIVE_ELEMENTS_SELECTOR).filter(\":visible\");\r\n        return isLast ? $focusedElement.last() : $focusedElement.first()\r\n    },\r\n    _applyTabIndexToElement: function($element) {\r\n        var tabIndex = this.option(\"tabIndex\") || 0;\r\n        $element.attr(\"tabindex\", isDefined(tabIndex) ? tabIndex : 0)\r\n    },\r\n    _getCell: function(cellPosition) {\r\n        if (this._focusedView && cellPosition) {\r\n            var rowIndexOffset = this._dataController.getRowIndexOffset();\r\n            var column = this._columnsController.getVisibleColumns(null, true)[cellPosition.columnIndex];\r\n            var columnIndexOffset = column && column.fixed ? this._getFixedColumnIndexOffset(column) : this._columnsController.getColumnIndexOffset();\r\n            var rowIndex = cellPosition.rowIndex >= 0 ? cellPosition.rowIndex - rowIndexOffset : -1;\r\n            var columnIndex = cellPosition.columnIndex >= 0 ? cellPosition.columnIndex - columnIndexOffset : -1;\r\n            return this._focusedView.getCell({\r\n                rowIndex: rowIndex,\r\n                columnIndex: columnIndex\r\n            })\r\n        }\r\n    },\r\n    _getRowIndex: function($row) {\r\n        var rowsView = this.getView(\"rowsView\");\r\n        var rowIndex = rowsView.getRowIndex($row);\r\n        if (rowIndex >= 0) {\r\n            rowIndex += this._dataController.getRowIndexOffset()\r\n        }\r\n        return rowIndex\r\n    },\r\n    _hasSkipRow: function($row) {\r\n        var row = $row && $row.get(0);\r\n        return row && (\"none\" === row.style.display || $row.hasClass(this.addWidgetPrefix(GROUP_FOOTER_CLASS)) || isDetailRow($row) && !$row.hasClass(this.addWidgetPrefix(EDIT_FORM_CLASS)))\r\n    },\r\n    _allowEditingOnEnterKey: function() {\r\n        return \"startEdit\" === this.option(\"keyboardNavigation.enterKeyAction\")\r\n    },\r\n    _isLegacyNavigation: function() {\r\n        return this.option(\"useLegacyKeyboardNavigation\")\r\n    },\r\n    _getDirectionCodeByKey: function(key) {\r\n        var directionCode;\r\n        switch (key) {\r\n            case \"upArrow\":\r\n                directionCode = \"prevRow\";\r\n                break;\r\n            case \"downArrow\":\r\n                directionCode = \"nextRow\";\r\n                break;\r\n            case \"leftArrow\":\r\n                directionCode = this.option(\"rtlEnabled\") ? \"nextInRow\" : \"previousInRow\";\r\n                break;\r\n            case \"rightArrow\":\r\n                directionCode = this.option(\"rtlEnabled\") ? \"previousInRow\" : \"nextInRow\"\r\n        }\r\n        return directionCode\r\n    },\r\n    _isVirtualScrolling: function() {\r\n        var scrollingMode = this.option(\"scrolling.mode\");\r\n        return \"virtual\" === scrollingMode || \"infinite\" === scrollingMode\r\n    },\r\n    _isVirtualRowRender: function() {\r\n        return this._isVirtualScrolling() || gridCoreUtils.isVirtualRowRendering(this)\r\n    },\r\n    _isVirtualColumnRender: function() {\r\n        return \"virtual\" === this.option(\"scrolling.columnRenderingMode\")\r\n    },\r\n    _scrollBy: function(left, top, rowIndex, $event) {\r\n        var that = this;\r\n        var scrollable = this.getView(\"rowsView\").getScrollable();\r\n        if (that._focusedCellPosition) {\r\n            scrollable.on(\"scroll\", (function scrollHandler() {\r\n                scrollable.off(\"scroll\", scrollHandler);\r\n                setTimeout(that.restoreFocusableElement.bind(that, rowIndex, $event))\r\n            }))\r\n        }\r\n        return scrollable.scrollBy({\r\n            left: left,\r\n            top: top\r\n        })\r\n    },\r\n    _isInsideEditForm: function(element) {\r\n        var $editForm = $(element).closest(\".\" + this.addWidgetPrefix(EDIT_FORM_CLASS));\r\n        return $editForm.length && this.elementIsInsideGrid($editForm)\r\n    },\r\n    _isMasterDetailCell: function(element) {\r\n        var $masterDetailCell = $(element).closest(\".\" + MASTER_DETAIL_CELL_CLASS);\r\n        return $masterDetailCell.length && this.elementIsInsideGrid($masterDetailCell)\r\n    },\r\n    _processNextCellInMasterDetail: function($nextCell) {\r\n        if (!this._isInsideEditForm($nextCell) && $nextCell) {\r\n            this._applyTabIndexToElement($nextCell)\r\n        }\r\n    },\r\n    _handleTabKeyOnMasterDetailCell: function(target, direction) {\r\n        if (this._isMasterDetailCell(target)) {\r\n            this._updateFocusedCellPosition($(target), direction);\r\n            var $nextCell = this._getNextCell(direction, \"row\");\r\n            this._processNextCellInMasterDetail($nextCell, $(target));\r\n            return true\r\n        }\r\n        return false\r\n    },\r\n    _getElementType: function(target) {\r\n        return $(target).is(\"tr\") ? \"row\" : \"cell\"\r\n    },\r\n    _isFastEditingStarted: function() {\r\n        return this._isFastEditingAllowed() && this._fastEditingStarted\r\n    },\r\n    _getVisibleColumnCount: function() {\r\n        return this._columnsController.getVisibleColumns(null, true).length\r\n    },\r\n    _isCellInRow: function(cellPosition, includeCommandCells) {\r\n        var columnIndex = cellPosition.columnIndex;\r\n        var visibleColumnsCount = this._getVisibleColumnCount();\r\n        return includeCommandCells ? columnIndex >= 0 && columnIndex <= visibleColumnsCount - 1 : columnIndex > 0 && columnIndex < visibleColumnsCount - 1\r\n    },\r\n    _isCellElement: function($element) {\r\n        return $element.length && \"TD\" === $element[0].tagName\r\n    },\r\n    _getCellElementFromTarget: function(target) {\r\n        var elementType = this._getElementType(target);\r\n        var $targetElement = $(target);\r\n        var $cell;\r\n        if (\"cell\" === elementType) {\r\n            $cell = $targetElement.closest(\".\".concat(ROW_CLASS, \" > td\"))\r\n        } else {\r\n            $cell = $targetElement.children().not(\".\" + COMMAND_EXPAND_CLASS).first()\r\n        }\r\n        return $cell\r\n    },\r\n    _getRowsViewElement: function() {\r\n        var rowsView = this.getView(\"rowsView\");\r\n        return rowsView && rowsView.element()\r\n    },\r\n    isKeyboardEnabled: function() {\r\n        return this.option(\"keyboardNavigation.enabled\")\r\n    },\r\n    _processCanceledEditCellPosition: function(rowIndex, columnIndex) {\r\n        if (this._canceledCellPosition) {\r\n            var isCanceled = this._canceledCellPosition.rowIndex === rowIndex && this._canceledCellPosition.columnIndex === columnIndex;\r\n            this._canceledCellPosition = null;\r\n            return isCanceled\r\n        }\r\n    },\r\n    updateFocusedRowIndex: function() {\r\n        var dataController = this._dataController;\r\n        var visibleRowIndex = this.getVisibleRowIndex();\r\n        var visibleItems = dataController.items();\r\n        var lastVisibleIndex = visibleItems.length ? visibleItems.length - 1 : -1;\r\n        var rowIndexOffset = dataController.getRowIndexOffset();\r\n        lastVisibleIndex >= 0 && visibleRowIndex > lastVisibleIndex && this.setFocusedRowIndex(lastVisibleIndex + rowIndexOffset)\r\n    }\r\n};\r\nvar KeyboardNavigationController = core.ViewController.inherit(keyboardNavigationMembers);\r\nexport var keyboardNavigationModule = {\r\n    defaultOptions: function() {\r\n        return {\r\n            useLegacyKeyboardNavigation: false,\r\n            keyboardNavigation: {\r\n                enabled: true,\r\n                enterKeyAction: \"startEdit\",\r\n                enterKeyDirection: \"none\",\r\n                editOnKeyPress: false\r\n            }\r\n        }\r\n    },\r\n    controllers: {\r\n        keyboardNavigation: KeyboardNavigationController\r\n    },\r\n    extenders: {\r\n        views: {\r\n            rowsView: {\r\n                _rowClick: function(e) {\r\n                    var editRowIndex = this.getController(\"editing\").getEditRowIndex();\r\n                    var keyboardController = this.getController(\"keyboardNavigation\");\r\n                    var isKeyboardEnabled = keyboardController.isKeyboardEnabled();\r\n                    if (editRowIndex === e.rowIndex) {\r\n                        keyboardController.setCellFocusType()\r\n                    }\r\n                    var needTriggerPointerEventHandler = (isMobile() || !isKeyboardEnabled) && this.option(\"focusedRowEnabled\");\r\n                    if (needTriggerPointerEventHandler) {\r\n                        this._triggerPointerDownEventHandler(e, !isKeyboardEnabled)\r\n                    }\r\n                    this.callBase.apply(this, arguments)\r\n                },\r\n                _triggerPointerDownEventHandler: function(e, force) {\r\n                    var originalEvent = e.event.originalEvent;\r\n                    if (originalEvent) {\r\n                        var keyboardController = this.getController(\"keyboardNavigation\");\r\n                        var $cell = $(originalEvent.target);\r\n                        var columnIndex = this.getCellIndex($cell);\r\n                        var column = this.getController(\"columns\").getVisibleColumns()[columnIndex];\r\n                        var row = this.getController(\"data\").items()[e.rowIndex];\r\n                        if (keyboardController._isAllowEditing(row, column) || force) {\r\n                            var eventArgs = createEvent(originalEvent, {\r\n                                currentTarget: originalEvent.target\r\n                            });\r\n                            keyboardController._pointerEventHandler(eventArgs)\r\n                        }\r\n                    }\r\n                },\r\n                renderFocusState: function(params) {\r\n                    var {\r\n                        preventScroll: preventScroll,\r\n                        pageSizeChanged: pageSizeChanged\r\n                    } = null !== params && void 0 !== params ? params : {};\r\n                    var keyboardController = this.getController(\"keyboardNavigation\");\r\n                    var $rowsViewElement = this.element();\r\n                    if ($rowsViewElement && !focused($rowsViewElement)) {\r\n                        $rowsViewElement.attr(\"tabindex\", null)\r\n                    }\r\n                    pageSizeChanged && keyboardController.updateFocusedRowIndex();\r\n                    var rowIndex = keyboardController.getVisibleRowIndex();\r\n                    if (!isDefined(rowIndex) || rowIndex < 0) {\r\n                        rowIndex = 0\r\n                    }\r\n                    var cellElements = this.getCellElements(rowIndex);\r\n                    if (keyboardController.isKeyboardEnabled() && cellElements.length) {\r\n                        this.updateFocusElementTabIndex(cellElements, preventScroll)\r\n                    }\r\n                },\r\n                updateFocusElementTabIndex: function(cellElements) {\r\n                    var keyboardController = this.getController(\"keyboardNavigation\");\r\n                    var $row = cellElements.eq(0).parent();\r\n                    if (isGroupRow($row)) {\r\n                        keyboardController._applyTabIndexToElement($row)\r\n                    } else {\r\n                        var columnIndex = keyboardController.getColumnIndex();\r\n                        if (!isDefined(columnIndex) || columnIndex < 0) {\r\n                            columnIndex = 0\r\n                        }\r\n                        this._updateFocusedCellTabIndex(cellElements, columnIndex)\r\n                    }\r\n                },\r\n                _updateFocusedCellTabIndex: function(cellElements, columnIndex) {\r\n                    var keyboardController = this.getController(\"keyboardNavigation\");\r\n                    var cellElementsLength = cellElements ? cellElements.length : -1;\r\n                    var updateCellTabIndex = function($cell) {\r\n                        var isMasterDetailCell = keyboardController._isMasterDetailCell($cell);\r\n                        var isValidCell = keyboardController._isCellValid($cell);\r\n                        if (!isMasterDetailCell && isValidCell && keyboardController._isCellElement($cell)) {\r\n                            keyboardController._applyTabIndexToElement($cell);\r\n                            keyboardController.setCellFocusType();\r\n                            return true\r\n                        }\r\n                    };\r\n                    var $cell = cellElements.filter(\"[aria-colindex='\".concat(columnIndex + 1, \"']\"));\r\n                    if ($cell.length) {\r\n                        updateCellTabIndex($cell)\r\n                    } else {\r\n                        if (cellElementsLength <= columnIndex) {\r\n                            columnIndex = cellElementsLength - 1\r\n                        }\r\n                        for (var i = columnIndex; i < cellElementsLength; ++i) {\r\n                            if (updateCellTabIndex($(cellElements[i]))) {\r\n                                break\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                renderDelayedTemplates: function(change) {\r\n                    this.callBase.apply(this, arguments);\r\n                    this._renderFocusByChange(change)\r\n                },\r\n                _renderFocusByChange(change) {\r\n                    var {\r\n                        operationTypes: operationTypes,\r\n                        repaintChangesOnly: repaintChangesOnly\r\n                    } = null !== change && void 0 !== change ? change : {};\r\n                    var {\r\n                        fullReload: fullReload,\r\n                        pageSize: pageSize\r\n                    } = null !== operationTypes && void 0 !== operationTypes ? operationTypes : {};\r\n                    if (!change || !repaintChangesOnly || fullReload || pageSize) {\r\n                        var preventScroll = shouldPreventScroll(this);\r\n                        this.renderFocusState({\r\n                            preventScroll: preventScroll,\r\n                            pageSizeChanged: pageSize\r\n                        })\r\n                    }\r\n                },\r\n                _renderCore: function(change) {\r\n                    var deferred = this.callBase.apply(this, arguments);\r\n                    this._renderFocusByChange(change);\r\n                    return deferred\r\n                },\r\n                _editCellPrepared: function($cell) {\r\n                    var editorInstance = this._getEditorInstance($cell);\r\n                    var keyboardController = this.getController(\"keyboardNavigation\");\r\n                    var isEditingNavigationMode = keyboardController && keyboardController._isFastEditingStarted();\r\n                    if (editorInstance && isEditingNavigationMode) {\r\n                        this._handleEditingNavigationMode(editorInstance)\r\n                    }\r\n                    this.callBase.apply(this, arguments)\r\n                },\r\n                _handleEditingNavigationMode: function(editorInstance) {\r\n                    [\"downArrow\", \"upArrow\"].forEach((function(keyName) {\r\n                        var originalKeyHandler = editorInstance._supportedKeys()[keyName];\r\n                        editorInstance.registerKeyHandler(keyName, e => {\r\n                            var isDropDownOpened = \"true\" === editorInstance._input().attr(\"aria-expanded\");\r\n                            if (isDropDownOpened) {\r\n                                return originalKeyHandler && originalKeyHandler.call(editorInstance, e)\r\n                            }\r\n                        })\r\n                    }));\r\n                    editorInstance.registerKeyHandler(\"leftArrow\", noop);\r\n                    editorInstance.registerKeyHandler(\"rightArrow\", noop);\r\n                    var isDateBoxWithMask = editorInstance.NAME === DATEBOX_WIDGET_NAME && editorInstance.option(\"useMaskBehavior\");\r\n                    if (isDateBoxWithMask) {\r\n                        editorInstance.registerKeyHandler(\"enter\", noop)\r\n                    }\r\n                },\r\n                _getEditorInstance: function($cell) {\r\n                    var $editor = $cell.find(\".dx-texteditor\").eq(0);\r\n                    return gridCoreUtils.getWidgetInstance($editor)\r\n                }\r\n            }\r\n        },\r\n        controllers: {\r\n            editing: {\r\n                editCell: function(rowIndex, columnIndex) {\r\n                    var keyboardController = this.getController(\"keyboardNavigation\");\r\n                    if (keyboardController._processCanceledEditCellPosition(rowIndex, columnIndex)) {\r\n                        return false\r\n                    }\r\n                    var isCellEditing = this.callBase(rowIndex, columnIndex);\r\n                    if (isCellEditing) {\r\n                        keyboardController.setupFocusedView()\r\n                    }\r\n                    return isCellEditing\r\n                },\r\n                editRow: function(rowIndex) {\r\n                    var keyboardController = this.getController(\"keyboardNavigation\");\r\n                    var visibleColumnIndex = keyboardController.getVisibleColumnIndex();\r\n                    var column = this._columnsController.getVisibleColumns()[visibleColumnIndex];\r\n                    if (column && column.type || this.option(\"editing.mode\") === EDIT_MODE_FORM) {\r\n                        keyboardController._resetFocusedCell()\r\n                    }\r\n                    this.callBase(rowIndex)\r\n                },\r\n                addRow: function(parentKey) {\r\n                    var keyboardController = this.getController(\"keyboardNavigation\");\r\n                    keyboardController.setupFocusedView();\r\n                    keyboardController.setCellFocusType();\r\n                    return this.callBase.apply(this, arguments)\r\n                },\r\n                getFocusedCellInRow: function(rowIndex) {\r\n                    var keyboardNavigationController = this.getController(\"keyboardNavigation\");\r\n                    var $cell = this.callBase(rowIndex);\r\n                    if (keyboardNavigationController.isKeyboardEnabled() && keyboardNavigationController._focusedCellPosition.rowIndex === rowIndex) {\r\n                        var $focusedCell = keyboardNavigationController._getFocusedCell();\r\n                        if (isElementDefined($focusedCell) && !$focusedCell.hasClass(COMMAND_EDIT_CLASS)) {\r\n                            $cell = $focusedCell\r\n                        }\r\n                    }\r\n                    return $cell\r\n                },\r\n                _processCanceledEditingCell: function() {\r\n                    this.closeEditCell().done(() => {\r\n                        var keyboardNavigation = this.getController(\"keyboardNavigation\");\r\n                        keyboardNavigation._updateFocus()\r\n                    })\r\n                },\r\n                init: function() {\r\n                    this.callBase();\r\n                    this._keyboardNavigationController = this.getController(\"keyboardNavigation\")\r\n                },\r\n                closeEditCell: function() {\r\n                    var keyboardNavigation = this._keyboardNavigationController;\r\n                    keyboardNavigation._fastEditingStarted = false;\r\n                    var result = this.callBase.apply(this, arguments);\r\n                    keyboardNavigation._updateFocus();\r\n                    return result\r\n                },\r\n                _delayedInputFocus: function() {\r\n                    this._keyboardNavigationController._isNeedScroll = true;\r\n                    this.callBase.apply(this, arguments)\r\n                },\r\n                _isEditingStart: function() {\r\n                    var keyboardNavigation = this.getController(\"keyboardNavigation\");\r\n                    var cancel = this.callBase.apply(this, arguments);\r\n                    if (cancel && !keyboardNavigation._isNeedFocus) {\r\n                        var $cell = keyboardNavigation._getFocusedCell();\r\n                        keyboardNavigation._focus($cell, true)\r\n                    }\r\n                    return cancel\r\n                }\r\n            },\r\n            data: {\r\n                _correctRowIndices: function(getRowIndexCorrection) {\r\n                    var that = this;\r\n                    var keyboardNavigationController = that.getController(\"keyboardNavigation\");\r\n                    var editorFactory = that.getController(\"editorFactory\");\r\n                    var focusedCellPosition = keyboardNavigationController._focusedCellPosition;\r\n                    that.callBase.apply(that, arguments);\r\n                    if (focusedCellPosition && focusedCellPosition.rowIndex >= 0) {\r\n                        var focusedRowIndexCorrection = getRowIndexCorrection(focusedCellPosition.rowIndex);\r\n                        if (focusedRowIndexCorrection) {\r\n                            focusedCellPosition.rowIndex += focusedRowIndexCorrection;\r\n                            editorFactory.refocus()\r\n                        }\r\n                    }\r\n                },\r\n                getMaxRowIndex: function() {\r\n                    var result = this.items().length - 1;\r\n                    var virtualItemsCount = this.virtualItemsCount();\r\n                    if (virtualItemsCount) {\r\n                        var rowIndexOffset = this.getRowIndexOffset();\r\n                        result += rowIndexOffset + virtualItemsCount.end\r\n                    }\r\n                    return result\r\n                }\r\n            },\r\n            adaptiveColumns: {\r\n                _showHiddenCellsInView: function(_ref) {\r\n                    var {\r\n                        viewName: viewName,\r\n                        $cells: $cells,\r\n                        isCommandColumn: isCommandColumn\r\n                    } = _ref;\r\n                    this.callBase.apply(this, arguments);\r\n                    viewName === COLUMN_HEADERS_VIEW && !isCommandColumn && $cells.each((_, cellElement) => {\r\n                        var $cell = $(cellElement);\r\n                        isCellInHeaderRow($cell) && $cell.attr(\"tabindex\", 0)\r\n                    })\r\n                },\r\n                _hideVisibleCellInView: function(_ref2) {\r\n                    var {\r\n                        viewName: viewName,\r\n                        $cell: $cell,\r\n                        isCommandColumn: isCommandColumn\r\n                    } = _ref2;\r\n                    this.callBase.apply(this, arguments);\r\n                    if (viewName === COLUMN_HEADERS_VIEW && !isCommandColumn && isCellInHeaderRow($cell)) {\r\n                        $cell.removeAttr(\"tabindex\")\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}